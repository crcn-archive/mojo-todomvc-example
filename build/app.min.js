(function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u=typeof require=="function"&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}var o=typeof require=="function"&&require;for(var s=0;s<r.length;s++)i(r[s]);return i})({1:[function(e,t,n){t.exports=function(e){}},{}],2:[function(e,t,n){var r=e("./index");var i=new r;i.initialize({element:document.body})},{"./index":3}],3:[function(e,t,n){var r=e("mojo-application");t.exports=r.extend({registerPlugins:function(){this.use(e("mojo-mediator"));this.use(e("mojo-bootstrap"));this.use(e("mojo-models"));this.use(e("mojo-views"));this.use(e("mojo-paperclip"));this.use(e("mojo-router"));this.use(e("./commands"));this.use(e("./models"));this.use(e("./views"));this.use(e("./templates"));this.use(e("./routes"))},didBootstrap:function(e){var t=this.models.create("todos",{});t.load();$(e.element).append(this.views.create("main",{todos:t}).render())}})},{"./commands":1,"./models":4,"./routes":9,"./templates":10,"./views":11,"mojo-application":22,"mojo-bootstrap":58,"mojo-mediator":67,"mojo-models":95,"mojo-paperclip":117,"mojo-router":200,"mojo-views":324}],4:[function(e,t,n){t.exports=function(t){t.models.register({todos:e("./todos")})}},{"./todos":8}],5:[function(e,t,n){t.exports={localStorage:e("./localStorage")}},{"./localStorage":6}],6:[function(e,t,n){var r=e("pouchdb");n.collection=function(e){return function(t){t.storage=new r(e);return{read:function(e){this.storage.allDocs({include_docs:true},function(t,n){if(t)return e(t);e(null,n.rows.map(function(e){return e.doc}))})}}}};n.model=function(){return function(e){var t=e.collection.storage;return{create:function(e){var n=this.serialize();n._id=Date.now()+"_"+Math.round(Math.random()*999999);t.put(n);e(null,n)},update:function(e){var n=this.serialize();t.get(n._id,function(r,i){if(r)return e(r);t.put(n,i._rev,e)})},read:function(e){storaget.get(this._id,e)},del:function(e){t.get(this._id,function(n,r){if(n)return e(n);t.remove(r,e)})}}}}},{pouchdb:397}],7:[function(e,t,n){var r=e("mojo-models"),i=e("./persist").localStorage;t.exports=r.Base.extend({persist:i.model(),toggleCompleted:function(){this.set("completed",!this.completed);this.save()},deserialize:function(e){return{_id:e._id,text:e.text,completed:!!e.completed}},serialize:function(){return{_id:this._id,text:this.text,completed:!!this.completed}}})},{"./persist":5,"mojo-models":95}],8:[function(e,t,n){var r=e("mojo-models"),i=e("./persist").localStorage;t.exports=r.Collection.extend({modelType:e("./todo"),bindings:{"@each.completed":{numCompleted:{map:function(e){return e.filter(function(e){return!!e}).length}}},"numCompleted, length":{allCompleted:{map:function(e,t){return e===t}}}},toggleCompleted:function(){var e=this;this.each(function(t){t.set("completed",!e.allCompleted);t.save()})},clearCompleted:function(){for(var e=this.length;e--;){var t=this.at(e);if(t.completed){t.remove()}}},persist:i.collection("todos")})},{"./persist":5,"./todo":7,"mojo-models":95}],9:[function(e,t,n){var r=e("sift");t.exports=function(e){e.router.add({"/":{name:"allTodos",enter:function(){e.models.set("todosFilter",function(){return true})},states:{page:"all"}},"/active":{name:"activeTodos",enter:function(){e.models.set("todosFilter",r({completed:false}).test)},states:{page:"active"}},"/completed":{name:"completedTodos",enter:function(){e.models.set("todosFilter",r({completed:true}).test)},states:{page:"completed"}}})}},{sift:435}],10:[function(e,t,n){t.exports=function(e){}},{}],11:[function(e,t,n){t.exports=function(t){t.views.register({main:e("./main")})}},{"./main":16}],12:[function(e,t,n){var r=e("mojo-views");t.exports=r.Base.extend({paper:e("./index.pc")})},{"./index.pc":13,"mojo-views":324}],13:[function(e,t,n){t.exports=function(e,t,n,r,i,o,s){return t({"if":{run:function(){return this.get(["todos","length"])},refs:[["todos","length"]]}},function(e,t,n,r,i,o,s){return n("footer",{id:"footer"},[n("span",{id:"todo-count"},[n("strong",{},[t({value:{run:function(){return this.get(["todos","length"])-this.get(["todos","numCompleted"])},refs:[["todos","numCompleted"],["todos","length"]]}},void 0)]),r(" todos left ")]),r(" "),n("ul",{id:"filters"},[n("li",{},[n("a",{"data-href":"allTodos","data-bind":[{css:{run:function(){return{selected:this.get(["models","states","page"])=="all"}},refs:[["models","states","page"]]}}]},[r("All")])]),r(" "),n("li",{},[n("a",{"data-href":"activeTodos","data-bind":[{css:{run:function(){return{selected:this.get(["models","states","page"])=="active"}},refs:[["models","states","page"]]}}]},[r("Active")])]),r(" "),n("li",{},[n("a",{"data-href":"completedTodos","data-bind":[{css:{run:function(){return{selected:this.get(["models","states","page"])=="completed"}},refs:[["models","states","page"]]}}]},[r("Completed")])])]),r(" "),t({"if":{run:function(){return this.get(["todos","numCompleted"])},refs:[["todos","numCompleted"]]}},function(e,t,n,r,i,o,s){return n("button",{id:"clear-completed","data-bind":[{onClick:{run:function(){return this.call(this.get(["todos"]),"clearCompleted",[])},refs:[["todos","clearCompleted"]]}}]},[r(" Clear completed ("),t({value:{run:function(){return this.get(["todos","numCompleted"])},refs:[["todos","numCompleted"]]}},void 0),r(") ")])})])})}},{}],14:[function(e,t,n){var r=e("mojo-views");t.exports=r.Base.extend({paper:e("./index.pc"),addNewTodo:function(){if(!this.newTodoText)return;this.get("todos").create({text:this.newTodoText}).save();this.set("newTodoText",void 0)}})},{"./index.pc":15,"mojo-views":324}],15:[function(e,t,n){t.exports=function(e,t,n,r,i,o,s){return n("header",{id:"header"},[n("h1",{},[r("todos")]),r(" "),n("input",{type:"text",id:"new-todo",placeholder:"What needs to be done?","data-bind":[{model:{run:function(){return this.bindTo(["newTodoText"])},refs:[["newTodoText"]]},onEnter:{run:function(){return this.call(this.__context,"addNewTodo",[])},refs:[["addNewTodo"]]}}]},[])])}},{}],16:[function(e,t,n){var r=e("mojo-views"),i=e("bindable");t.exports=r.Base.extend({paper:e("./index.pc"),sections:{header:e("./header"),todos:e("./todos"),footer:e("./footer")}})},{"./footer":12,"./header":14,"./index.pc":17,"./todos":18,bindable:447,"mojo-views":324}],17:[function(e,t,n){t.exports=function(e,t,n,r,i,o,s){return e([n("section",{id:"todoapp"},[t({html:{run:function(){return this.get(["sections","header"])},refs:[["sections","header"]]}},void 0),r(" "),t({html:{run:function(){return this.get(["sections","todos"])},refs:[["sections","todos"]]}},void 0),r(" "),t({html:{run:function(){return this.get(["sections","footer"])},refs:[["sections","footer"]]}},void 0)]),r(" "),n("footer",{id:"info"},[n("p",{},[r("Double-click to edit a todo")])])])}},{}],18:[function(e,t,n){var r=e("mojo-views"),i=e("bindable");t.exports=r.Base.extend({paper:e("./index.pc"),sections:{items:{type:"list",source:"todos",filter:"models.todosFilter",modelViewClass:e("./todo")}}})},{"./index.pc":19,"./todo":20,bindable:447,"mojo-views":324}],19:[function(e,t,n){t.exports=function(e,t,n,r,i,o,s){return n("section",{id:"main"},[n("ul",{id:"todo-list"},[t({html:{run:function(){return this.get(["sections","items"])},refs:[["sections","items"]]}},void 0)]),r(" "),n("input",{type:"checkbox",id:"toggle-all","data-bind":[{onClick:{run:function(){return this.call(this.get(["todos"]),"toggleCompleted",[])},refs:[["todos","toggleCompleted"]]}}]},[])])}},{}],20:[function(e,t,n){var r=e("mojo-views");t.exports=r.Base.extend({paper:e("./index.pc"),save:function(){this.set("edit",false);this.get("model").save()}})},{"./index.pc":21,"mojo-views":324}],21:[function(e,t,n){t.exports=function(e,t,n,r,i,o,s){return n("li",{"data-bind":[{css:{run:function(){return{completed:this.get(["model","completed"]),editing:this.get(["edit"])}},refs:[["edit"],["model","completed"]]}}]},[t({"if":{run:function(){return this.get(["edit"])},refs:[["edit"]]}},function(e,t,n,r,i,o,s){return n("input",{type:"text","class":"edit","data-bind":[{model:{run:function(){return this.bindTo(["model","text"])},refs:[["model","text"]]},onEnter:{run:function(){return this.call(this.__context,"save",[])},refs:[["save"]]},focus:{run:function(){return true},refs:[]}}]},[])},function(e,t,n,r,i,o,s){return t({"else":{run:function(){return true},refs:[]}},function(e,t,n,r,i,o,s){return e([n("input",{type:"checkbox","class":"toggle","data-bind":[{model:{run:function(){return this.get(["model","completed"])},refs:[["model","completed"]]},onMouseUp:{run:function(){return this.call(this.get(["model"]),"toggleCompleted",[])},refs:[["model","toggleCompleted"]]}}]},[]),r(" "),n("label",{"data-bind":[{onDblClick:{run:function(){return this.set(["edit"],true)},refs:[["edit"]]}}]},[t({value:{run:function(){return this.get(["model","text"])},refs:[]}},void 0)]),r(" "),n("button",{"class":"destroy","data-bind":[{onClick:{run:function(){return this.call(this.get(["model"]),"remove",[])},refs:[["model","remove"]]}}]},[])])})})])}},{}],22:[function(e,t,n){var r=e("bindable"),i=e("nofactor");function o(e){if(!e)e={};o.parent.call(this,this);this.nodeFactory=e.nodeFactory||i["default"];this.models=new r.Object;this.registerPlugins();var t=this}t.exports=r.Object.extend(o,{registerPlugins:function(){},willInitialize:function(){},didInitialize:function(){},use:function(e){for(var t=0,n=arguments.length;t<n;t++){arguments[t](this)}return this},initialize:function(){var e=Array.prototype.slice.call(arguments,0);this.willInitialize.apply(this,e);this.emit.apply(this,["initialize"].concat(e));this.didInitialize.apply(this,e)}});t.exports.main=new o},{bindable:25,nofactor:38}],23:[function(e,t,n){var r=e("../object"),i=e("../utils/computed"),o=e("sift");function s(e){r.call(this,this);this._source=e||[];this._updateInfo()}r.extend(s,{__isBindableCollection:true,reset:function(e){return this.source(e)},source:function(e){if(!arguments.length)return this._source;var t=this._source||[];this._source=e||[];this._updateInfo();this.emit("reset",this._source)},indexOf:function(e){return this._source.indexOf(e)},filter:function(e){return this._source.filter(e)},search:function(e){return o(e,this._source).shift()},searchIndex:function(e){return this.indexOf(this.search(e))},at:function(e){return this._source[e]},each:i(["length"],function(e){this._source.forEach(e)}),map:function(e){return this._source.map(e)},join:function(e){return this._source.join(e)},push:function(e){this._source.push(e);this._updateInfo();this.emit("insert",e,this._source.length-1)},unshift:function(e){this._source.push(e);this._updateInfo();this.emit("insert",e,0)},splice:function(e,t){var n=Array.prototype.slice.call(arguments,2),r=this._source.splice.apply(this._source,arguments);this._updateInfo();this.emit("replace",n,r,e)},remove:function(e){var t=this.indexOf(e);if(!~t)return false;this._source.splice(t,1);this._updateInfo();this.emit("remove",e,t);return e},pop:function(){if(!this._source.length)return;return this.remove(this._source[this._source.length-1])},shift:function(){if(!this._source.length)return;return this.remove(this._source[0])},toJSON:function(){return this._source.map(function(e){return e&&e.toJSON?e.toJSON():e})},_updateInfo:function(){this.set("first",this._source.length?this._source[0]:undefined);this.set("length",this._source.length);this.set("empty",!this._source.length);this.set("last",this._source.length?this._source[this._source.length-1]:undefined)}});t.exports=s},{"../object":26,"../utils/computed":29,sift:32}],24:[function(e,t,n){var r=e("protoclass");function i(){this._events={}}i.prototype.setMaxListeners=function(){};i.prototype.on=function(e,t){if(typeof t!=="function"){throw new Error("listener must be a function for event '"+e+"'")}var n;if(!(n=this._events[e])){this._events[e]=t}else if(typeof n==="function"){this._events[e]=[n,t]}else{n.push(t)}var r=this;return{dispose:function(){r.off(e,t)}}};i.prototype.off=function(e,t){var n;if(!(n=this._events[e])){return}if(typeof n==="function"){this._events[e]=undefined}else{var r=n.indexOf(t);if(~r)n.splice(r,1);if(!n.length){this._events[e]=undefined}}};i.prototype.once=function(e,t){function n(){r.dispose();t.apply(this,arguments)}var r=this.on(e,n);r.target=this;return r};i.prototype.emit=function(e){if(this._events[e]===undefined)return;var t=this._events[e];if(typeof t==="function"){if(arguments.length===1){t()}else{switch(arguments.length){case 2:t(arguments[1]);break;case 3:t(arguments[1],arguments[2]);break;case 4:t(arguments[1],arguments[2],arguments[3]);break;default:var n=arguments.length;var r=new Array(n-1);for(var i=1;i<n;i++)r[i-1]=arguments[i];t.apply(this,r)}}}else{var n=arguments.length;var r=new Array(n-1);for(var i=1;i<n;i++)r[i-1]=arguments[i];for(var o=t.length;o--;){if(t[o])t[o].apply(this,r)}}};i.prototype.removeAllListeners=function(e){if(arguments.length===1){this._events[e]=undefined}else{this._events={}}};t.exports=i},{protoclass:31}],25:[function(e,t,n){t.exports={Object:e("./object"),Collection:e("./collection"),EventEmitter:e("./core/eventEmitter"),computed:e("./utils/computed"),options:e("./utils/options")};if(typeof window!=="undefined"){window.bindable=t.exports}},{"./collection":23,"./core/eventEmitter":24,"./object":26,"./utils/computed":29,"./utils/options":30}],26:[function(e,t,n){var r=e("../core/eventEmitter"),i=e("protoclass"),o=e("./watchProperty");function s(e){if(e){this.context(e)}else{this.__context={}}s.parent.call(this)}o.BindableObject=s;i(r,s,{__isBindable:true,context:function(e){if(!arguments.length)return this.__context;if(e.__isBindable&&e!==this){throw new Error("context cannot be a bindable object")}this.__context=e},keys:function(){return Object.keys(this.toJSON())},has:function(e){return this.get(e)!=null},get:function(e){var t;if((t=typeof e==="string")&&!~e.indexOf(".")){return this.__context[e]}var n=t?e.split("."):e,r=this.__context,i=r,o;for(var s=0,a=n.length-1;s<a;s++){i=i[n[s]];if(!i)return;if(i.__isBindable&&i!==r){i=i.__context}}if(i)return i[n[s]]},call:function(e,t,n){if(typeof t==="function"){n=t;t=[]}if(!t)t=[];if(!n)n=function(e){if(e)throw e};if(Object.prototype.toString.call(t)!=="[object Array]"){return n(new Error("args must be an array"))}var r=this,i=e.split("."),o;function s(e){var i=o?e.get(o)||e[o]:e;try{n(null,i.apply(r,t))}catch(s){n(s)}}var a=this.get(e)||this[e];if(a){return s(a)}if(i.length>1){o=i.pop()}this.bind(i,{max:1,to:s}).now()},setProperties:function(e){for(var t in e){this.set(t,e[t])}return this},set:function(e,t){var n,r,i;if((n=typeof e==="string")&&!~e.indexOf(".")){r=(i=this.__context[e])!==t;if(r)this.__context[e]=t}else{var o=n?e.split("."):e,s=this.__context,a=s,u,c,f;for(var l=0,p=o.length-1;l<p;l++){c=o[l];u=a;a=a[c];if(!a){a=u[c]={}}if(a.__isBindable){f=o.slice(l+1);r=(i=a.get(f))!==t;a.set(f,t);a=i;break}}if(!f&&(r=a!==t)){c=o[l];i=a[c];a[c]=t}}if(!r)return t;var h=o?o.join("."):e;this.emit("change:"+h,t,i);this.emit("change",h,t,i);return t},bind:function(e,t,n){return o(this,e,t,n)},dispose:function(){this.emit("dispose")},toJSON:function(){var e={},t;for(var n in this.__context){t=this.__context[n];if(t&&t.__isBindable){t=t.toJSON()}e[n]=t}return e}});t.exports=s},{"../core/eventEmitter":24,"./watchProperty":28,protoclass:31}],27:[function(e,t,n){var r=e("toarray"),i=e("underscore");function o(e,t){return function(n){e.set(t,n)}}function s(e,t){if(e.length!==t.length)return true;for(var n=t.length;n--;){if(t[n]!==e[n])return true}return false}function a(e,t,n){var r=0;return function(){var i=Array.prototype.slice.call(arguments,0),o=i.length%2===0?i.slice(0,i.length/2):i;if(!s(o,t))return;if(~n&&++r>=n){this.dispose()}t=o;e.apply(this,i)}}function u(e,t,n){var i=n.when||function(){return true},s=n.map||function(){return Array.prototype.slice.call(arguments,0)},c=n.target||e,f=n.max||(n.once?1:undefined)||-1,l=r(n.to).concat(),p=r(n.defaultValue),h=[],d=n.bothWays;if(!i.test&&typeof i==="function"){i={test:i}}if(!p.length){p.push(undefined)}if(!l.length){throw new Error("missing 'to' option")}for(var v=l.length;v--;){var m=l[v],g=typeof m;if(g==="object"){for(var y in m){m[y].to=y;l.push(u(c,t,m[y]))}l.splice(v,1)}else if(g==="string"){h.push(m);l[v]=a(o(c,m),p,f)}else if(g==="function"){l[v]=a(m,p,f)}else{throw new Error("'to' must be a function")}}if(d){for(var v=h.length;v--;){c.bind(h[v],{to:t})}}return function(){var e=r(s.apply(this,arguments));if(!i.test.apply(i,e))return;for(var t=l.length;t--;){l[t].apply(this,e)}}}t.exports=u},{toarray:33,underscore:34}],28:[function(e,t,n){var r=e("underscore"),i=e("./transform"),o=e("../utils/options");function s(e,t,n){e.emit("watching",[t]);var r=e.on("change:"+t,function(){n.apply(i,arguments)}),i;return i={target:e,now:function(){n.call(i,e.get(t));return i},dispose:function(){r.dispose()}}}function a(e,n,i,o){var s=[],a=n?[]:undefined,u;function c(){l();s=[];a=n?[]:undefined;f(e,i);u.now()}if(n&&typeof window!=="undefined"){c=r.debounce(c,1)}function f(e,r,i){var o=[],u,l,p,h,d,v,m=r.length?e.__context:e;if(n){for(var g=0,y=r.length;g<y;g++){o.push(r[g]);l=r[g];e.emit("watching",o);if(h=l.charCodeAt(0)===64){d=true;o[g]=l=o[g].substr(1)}v=m;if(m)m=m[l];if(h&&m){if(m.compute){for(var p=m.compute.length;p--;){f(e,[m.compute[p]],false)}}var _=r.slice(g+1);m.call(v,function(e){if(!e)return;if(!e.__isBindable){e=new t.exports.BindableObject(e)}f(e,_,i)});break}else if(m&&m.__isBindable&&g!==y-1){f(m,r.slice(g+1),false);m=m.__context}s.push(e.on("change:"+o.join("."),c))}if(!d&&i!==false){a.push(m)}}else{for(var g=0,y=r.length;g<y;g++){l=r[g];o.push(l);e.emit("watching",o);if(m)m=m[l];if(m&&m.__isBindable&&g!==y-1){f(m,r.slice(g+1),false);m=m.__context}s.push(e.on("change:"+o.join("."),c))}if(i!==false)a=m}}function l(){if(!s)return;for(var e=s.length;e--;){s[e].dispose()}s=[]}u={target:e,now:function(){o.call(u,a);return u},dispose:l};f(e,i);return u}function u(e,t,n){var i=new Array(t.length),s=new Array(t.length),a=new Array(t.length),u=o.computedDelay===-1?n:r.debounce(n,o.computedDelay),c;t.forEach(function(t,n){function r(e,t){i[n]=e;s[n]=t;u.apply(this,i.concat(s))}a[n]=e.bind(t,r)});return c={target:e,now:function(){for(var e=a.length;e--;){a[e].now()}return c},dispose:function(){for(var e=a.length;e--;){a[e].dispose()}}}}function c(e,t,n){if(typeof n==="object"){n=i(e,t,n)}var r;if(typeof t==="string"){if(~t.indexOf(",")){return u(e,t.split(/[,\s]+/),n)}else if(~t.indexOf(".")){r=t.split(".")}else{r=[t]}}else{r=t}if(r.length===1){return s(e,t,n)}else{return a(e,~t.indexOf("@"),r,n)}}t.exports=c},{"../utils/options":30,"./transform":27,underscore:34}],29:[function(e,t,n){var r=e("toarray");t.exports=function(e,t){e=r(e);t.compute=e;return t}},{toarray:33}],30:[function(e,t,n){t.exports={computedDelay:0}},{}],31:[function(e,t,n){function r(e,t){for(var n=0,r=t.length;n<r;n++){var i=t[n];for(var o in i){e[o]=i[o]}}return e}function i(e,t){var n=Array.prototype.slice.call(arguments,2);if(typeof t!=="function"){if(t)n.unshift(t);t=e;e=function(){}}r(t,e);function o(){this.constructor=t}o.prototype=e.prototype;t.prototype=new o;t.__super__=e.prototype;t.parent=t.superclass=e;r(t.prototype,n);i.setup(t);return t}i.setup=function(e){if(!e.extend){e.extend=function(e){var t=Array.prototype.slice.call(arguments,0);if(typeof e!=="function"){t.unshift(e=function(){e.parent.apply(this,arguments)})}return i.apply(this,[this].concat(t))};e.mixin=function(e){r(this.prototype,arguments)}}return e};t.exports=i},{}],32:[function(e,t,n){(function(){var e=function(e,t){var n={},r=n;for(var i=0,o=e.length-1;i<o;i++){r=r[e[i]]={}}r[e[i]]=t;return n};var n=new function(){var t=this.priority=function(e,t){var n=e.exprs,r=0;for(var o=0,s=n.length;o<s;o++){var a=n[o],u;if(!~(u=a.e(a.v,i(t),t)))return-1;r+=u}return r};var n=this.parse=function(i,o){if(!i)i={$eq:i};var a=[];if(Object.prototype.toString.call(i)==="[object Object]"){for(var c in i){var f=!!s[c]?c:"$trav",l=i[c],p=l;if(r[f]){if(~c.indexOf(".")){var h=c.split(".");c=h.shift();p=l=e(h,l)}if(l instanceof Array){p=[];for(var d=l.length;d--;){p.push(n(l[d]))}}else{p=n(l,c)}}a.push(u(f,c,p))}}else{a.push(u("$eq",c,i))}var v={exprs:a,k:o,test:function(e){return!!~v.priority(e)},priority:function(e){return t(v,e)}};return v};var r=this.traversable={$and:true,$or:true,$nor:true,$trav:true,$not:true};function i(e){if(e instanceof Date){return e.getTime()}else{return e}}function o(e){return e?0:-1}var s=this.testers={$eq:function(e,t){return o(e.test(t))},$ne:function(e,t){return o(!e.test(t))},$lt:function(e,t){return o(e>t)},$gt:function(e,t){return o(e<t)},$lte:function(e,t){return o(e>=t)},$gte:function(e,t){return o(e<=t)},$exists:function(e,t){return o(e===(t!=null))},$in:function(e,t){if(t instanceof Array){for(var n=t.length;n--;){if(~e.indexOf(t[n]))return n}}else{return o(~e.indexOf(t))}return-1},$not:function(e,t){if(!e.test)throw new Error("$not test should include an expression, not a value. Use $ne instead.");return o(!e.test(t))},$type:function(e,t,n){return n?o(n instanceof e||n.constructor==e):-1},$nin:function(e,t){return~s.$in(e,t)?-1:0},$mod:function(e,t){return t%e[0]==e[1]?0:-1},$all:function(e,t){t=t||(t=[]);for(var n=e.length;n--;){var r=e[n];var i=~t.indexOf(r);if(!i)return-1}return 0},$size:function(e,t){return t?o(e==t.length):-1},$or:function(e,n){var r=e.length,i,s=r;for(;r--;){if(~t(e[r],n)){return r}}return o(s==0)},$nor:function(e,n){var r=e.length,i=r;for(;r--;){if(~t(e[r],n)){return-1}}return 0},$and:function(e,n){for(var r=e.length;r--;){if(!~t(e[r],n)){return-1}}return 0},$trav:function(e,n){if(n instanceof Array){for(var r=n.length;r--;){var i=n[r];if(i[e.k]&&~t(e,i[e.k]))return r}return-1}return t(e,n?n[e.k]:undefined)},$regex:function(e,t){var n=new RegExp(e);return n.test(t)?0:-1}};var a={$eq:function(e){var t;if(e instanceof RegExp){return e}else if(e instanceof Function){t=e}else{t=function(t){if(t instanceof Array){return~t.indexOf(e)}else{return e==t}}}return{test:t}},$ne:function(e){return a.$eq(e)}};var u=function(e,t,n){var r=i(n);return{k:t,v:a[e]?a[e](r):r,e:s[e]}}};var r=function(e){if(!e){return function(e){return e}}else if(typeof e=="function"){return e}throw new Error("Unknown sift selector "+e)};var i=function(e,t){var r=n.parse(e);var i=function(e){var n=[],i=[],o,s,a;for(var u=0,c=e.length;u<c;u++){s=e[u];o=t(s);if(!~(a=r.priority(o)))continue;n.push({value:s,priority:a})}n.sort(function(e,t){return e.priority>t.priority?-1:1});var f=Array(n.length);for(var u=n.length;u--;){f[u]=n[u].value}return f};i.test=r.test;i.score=r.priority;i.query=e;return i};var o=function(e,t,n){if(typeof t!="object"){n=t;t=undefined}var o=i(e,r(n));if(t)return o(t);return o};o.use=function(e){if(e.operators)o.useOperators(e.operators)};o.useOperators=function(e){for(var t in e){o.useOperator(t,e[t])}};o.useOperator=function(e,t){var r={};if(typeof t=="object"){r=t}else{r={test:t}}var i="$"+e;n.testers[i]=r.test;if(r.traversable||r.traverse){n.traversable[i]=true}};if(typeof t!="undefined"&&typeof t.exports!="undefined"){t.exports=o}else if(typeof window!="undefined"){window.sift=o}})()},{}],33:[function(e,t,n){t.exports=function(e){if(e===undefined)return[];return Object.prototype.toString.call(e)==="[object Array]"?e:[e]}},{}],34:[function(e,t,n){(function(){var e=this;var r=e._;var i={};var o=Array.prototype,s=Object.prototype,a=Function.prototype;var u=o.push,c=o.slice,f=o.concat,l=s.toString,p=s.hasOwnProperty;var h=o.forEach,d=o.map,v=o.reduce,m=o.reduceRight,g=o.filter,y=o.every,_=o.some,b=o.indexOf,w=o.lastIndexOf,x=Array.isArray,k=Object.keys,E=a.bind;var O=function(e){if(e instanceof O)return e;if(!(this instanceof O))return new O(e);this._wrapped=e};if(typeof n!=="undefined"){if(typeof t!=="undefined"&&t.exports){n=t.exports=O}n._=O}else{e._=O}O.VERSION="1.4.4";var j=O.each=O.forEach=function(e,t,n){if(e==null)return;if(h&&e.forEach===h){e.forEach(t,n)}else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++){if(t.call(n,e[r],r,e)===i)return}}else{for(var s in e){if(O.has(e,s)){if(t.call(n,e[s],s,e)===i)return}}}};O.map=O.collect=function(e,t,n){var r=[];if(e==null)return r;if(d&&e.map===d)return e.map(t,n);j(e,function(e,i,o){r[r.length]=t.call(n,e,i,o)});return r};var S="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(v&&e.reduce===v){if(r)t=O.bind(t,r);return i?e.reduce(t,n):e.reduce(t)}j(e,function(e,o,s){if(!i){n=e;i=true}else{n=t.call(r,n,e,o,s)}});if(!i)throw new TypeError(S);return n};O.reduceRight=O.foldr=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(m&&e.reduceRight===m){if(r)t=O.bind(t,r);return i?e.reduceRight(t,n):e.reduceRight(t)}var o=e.length;if(o!==+o){var s=O.keys(e);o=s.length}j(e,function(a,u,c){u=s?s[--o]:--o;if(!i){n=e[u];i=true}else{n=t.call(r,n,e[u],u,c)}});if(!i)throw new TypeError(S);return n};O.find=O.detect=function(e,t,n){var r;A(e,function(e,i,o){if(t.call(n,e,i,o)){r=e;return true}});return r};O.filter=O.select=function(e,t,n){var r=[];if(e==null)return r;if(g&&e.filter===g)return e.filter(t,n);j(e,function(e,i,o){if(t.call(n,e,i,o))r[r.length]=e});return r};O.reject=function(e,t,n){return O.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)};O.every=O.all=function(e,t,n){t||(t=O.identity);var r=true;if(e==null)return r;if(y&&e.every===y)return e.every(t,n);j(e,function(e,o,s){if(!(r=r&&t.call(n,e,o,s)))return i});return!!r};var A=O.some=O.any=function(e,t,n){t||(t=O.identity);var r=false;if(e==null)return r;if(_&&e.some===_)return e.some(t,n);j(e,function(e,o,s){if(r||(r=t.call(n,e,o,s)))return i});return!!r};O.contains=O.include=function(e,t){if(e==null)return false;if(b&&e.indexOf===b)return e.indexOf(t)!=-1;return A(e,function(e){return e===t})};O.invoke=function(e,t){var n=c.call(arguments,2);var r=O.isFunction(t);return O.map(e,function(e){return(r?t:e[t]).apply(e,n)})};O.pluck=function(e,t){return O.map(e,function(e){return e[t]})};O.where=function(e,t,n){if(O.isEmpty(t))return n?null:[];return O[n?"find":"filter"](e,function(e){for(var n in t){if(t[n]!==e[n])return false}return true})};O.findWhere=function(e,t){return O.where(e,t,true)};O.max=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&O.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};j(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s>=r.computed&&(r={value:e,computed:s})});return r.value};O.min=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&O.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};j(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s<r.computed&&(r={value:e,computed:s})});return r.value};O.shuffle=function(e){var t;var n=0;var r=[];j(e,function(e){t=O.random(n++);r[n-1]=r[t];r[t]=e});return r};var C=function(e){return O.isFunction(e)?e:function(t){return t[e]}};O.sortBy=function(e,t,n){var r=C(t);return O.pluck(O.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria;var r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var T=function(e,t,n,r){var i={};var o=C(t||O.identity);j(e,function(t,s){var a=o.call(n,t,s,e);r(i,a,t)});return i};O.groupBy=function(e,t,n){return T(e,t,n,function(e,t,n){(O.has(e,t)?e[t]:e[t]=[]).push(n)})};O.countBy=function(e,t,n){return T(e,t,n,function(e,t){if(!O.has(e,t))e[t]=0;e[t]++})};O.sortedIndex=function(e,t,n,r){n=n==null?O.identity:C(n);var i=n.call(r,t);var o=0,s=e.length;while(o<s){var a=o+s>>>1;n.call(r,e[a])<i?o=a+1:s=a}return o};O.toArray=function(e){if(!e)return[];if(O.isArray(e))return c.call(e);if(e.length===+e.length)return O.map(e,O.identity);return O.values(e)};O.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:O.keys(e).length};O.first=O.head=O.take=function(e,t,n){if(e==null)return void 0;return t!=null&&!n?c.call(e,0,t):e[0]};O.initial=function(e,t,n){return c.call(e,0,e.length-(t==null||n?1:t))};O.last=function(e,t,n){if(e==null)return void 0;if(t!=null&&!n){return c.call(e,Math.max(e.length-t,0))}else{return e[e.length-1]}};O.rest=O.tail=O.drop=function(e,t,n){return c.call(e,t==null||n?1:t)};O.compact=function(e){return O.filter(e,O.identity)};var N=function(e,t,n){j(e,function(e){if(O.isArray(e)){t?u.apply(n,e):N(e,t,n)}else{n.push(e)}});return n};O.flatten=function(e,t){return N(e,t,[])};O.without=function(e){return O.difference(e,c.call(arguments,1))};O.uniq=O.unique=function(e,t,n,r){if(O.isFunction(t)){r=n;n=t;t=false}var i=n?O.map(e,n,r):e;var o=[];var s=[];j(i,function(n,r){if(t?!r||s[s.length-1]!==n:!O.contains(s,n)){s.push(n);o.push(e[r])}});return o};O.union=function(){return O.uniq(f.apply(o,arguments))};O.intersection=function(e){var t=c.call(arguments,1);return O.filter(O.uniq(e),function(e){return O.every(t,function(t){return O.indexOf(t,e)>=0})})};O.difference=function(e){var t=f.apply(o,c.call(arguments,1));return O.filter(e,function(e){return!O.contains(t,e)})};O.zip=function(){var e=c.call(arguments);var t=O.max(O.pluck(e,"length"));var n=new Array(t);for(var r=0;r<t;r++){n[r]=O.pluck(e,""+r)}return n};O.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++){if(t){n[e[r]]=t[r]}else{n[e[r][0]]=e[r][1]}}return n};O.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n=="number"){r=n<0?Math.max(0,i+n):n}else{r=O.sortedIndex(e,t);return e[r]===t?r:-1}}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1};O.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w){return r?e.lastIndexOf(t,n):e.lastIndexOf(t)}var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1};O.range=function(e,t,n){if(arguments.length<=1){t=e||0;e=0}n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0);var i=0;var o=new Array(r);while(i<r){o[i++]=e;e+=n}return o};O.bind=function(e,t){if(e.bind===E&&E)return E.apply(e,c.call(arguments,1));var n=c.call(arguments,2);return function(){return e.apply(t,n.concat(c.call(arguments)))}};O.partial=function(e){var t=c.call(arguments,1);return function(){return e.apply(this,t.concat(c.call(arguments)))}};O.bindAll=function(e){var t=c.call(arguments,1);if(t.length===0)t=O.functions(e);j(t,function(t){e[t]=O.bind(e[t],e)});return e};O.memoize=function(e,t){var n={};t||(t=O.identity);return function(){var r=t.apply(this,arguments);return O.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}};O.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)};O.defer=function(e){return O.delay.apply(O,[e,1].concat(c.call(arguments,1)))};O.throttle=function(e,t){var n,r,i,o;var s=0;var a=function(){s=new Date;i=null;o=e.apply(n,r)};return function(){var u=new Date;var c=t-(u-s);n=this;r=arguments;if(c<=0){clearTimeout(i);i=null;s=u;o=e.apply(n,r)}else if(!i){i=setTimeout(a,c)}return o}};O.debounce=function(e,t,n){var r,i;return function(){var o=this,s=arguments;var a=function(){r=null;if(!n)i=e.apply(o,s)};var u=n&&!r;clearTimeout(r);r=setTimeout(a,t);if(u)i=e.apply(o,s);return i}};O.once=function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}};O.wrap=function(e,t){return function(){var n=[e];u.apply(n,arguments);return t.apply(this,n)}};O.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--){t=[e[n].apply(this,t)]}return t[0]}};O.after=function(e,t){if(e<=0)return t();return function(){if(--e<1){return t.apply(this,arguments)}}};O.keys=k||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)if(O.has(e,n))t[t.length]=n;return t};O.values=function(e){var t=[];for(var n in e)if(O.has(e,n))t.push(e[n]);return t};O.pairs=function(e){var t=[];for(var n in e)if(O.has(e,n))t.push([n,e[n]]);return t
};O.invert=function(e){var t={};for(var n in e)if(O.has(e,n))t[e[n]]=n;return t};O.functions=O.methods=function(e){var t=[];for(var n in e){if(O.isFunction(e[n]))t.push(n)}return t.sort()};O.extend=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){e[n]=t[n]}}});return e};O.pick=function(e){var t={};var n=f.apply(o,c.call(arguments,1));j(n,function(n){if(n in e)t[n]=e[n]});return t};O.omit=function(e){var t={};var n=f.apply(o,c.call(arguments,1));for(var r in e){if(!O.contains(n,r))t[r]=e[r]}return t};O.defaults=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){if(e[n]==null)e[n]=t[n]}}});return e};O.clone=function(e){if(!O.isObject(e))return e;return O.isArray(e)?e.slice():O.extend({},e)};O.tap=function(e,t){t(e);return e};var q=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof O)e=e._wrapped;if(t instanceof O)t=t._wrapped;var i=l.call(e);if(i!=l.call(t))return false;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var o=n.length;while(o--){if(n[o]==e)return r[o]==t}n.push(e);r.push(t);var s=0,a=true;if(i=="[object Array]"){s=e.length;a=s==t.length;if(a){while(s--){if(!(a=q(e[s],t[s],n,r)))break}}}else{var u=e.constructor,c=t.constructor;if(u!==c&&!(O.isFunction(u)&&u instanceof u&&O.isFunction(c)&&c instanceof c)){return false}for(var f in e){if(O.has(e,f)){s++;if(!(a=O.has(t,f)&&q(e[f],t[f],n,r)))break}}if(a){for(f in t){if(O.has(t,f)&&!s--)break}a=!s}}n.pop();r.pop();return a};O.isEqual=function(e,t){return q(e,t,[],[])};O.isEmpty=function(e){if(e==null)return true;if(O.isArray(e)||O.isString(e))return e.length===0;for(var t in e)if(O.has(e,t))return false;return true};O.isElement=function(e){return!!(e&&e.nodeType===1)};O.isArray=x||function(e){return l.call(e)=="[object Array]"};O.isObject=function(e){return e===Object(e)};j(["Arguments","Function","String","Number","Date","RegExp"],function(e){O["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}});if(!O.isArguments(arguments)){O.isArguments=function(e){return!!(e&&O.has(e,"callee"))}}if(typeof/./!=="function"){O.isFunction=function(e){return typeof e==="function"}}O.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};O.isNaN=function(e){return O.isNumber(e)&&e!=+e};O.isBoolean=function(e){return e===true||e===false||l.call(e)=="[object Boolean]"};O.isNull=function(e){return e===null};O.isUndefined=function(e){return e===void 0};O.has=function(e,t){return p.call(e,t)};O.noConflict=function(){e._=r;return this};O.identity=function(e){return e};O.times=function(e,t,n){var r=Array(e);for(var i=0;i<e;i++)r[i]=t.call(n,i);return r};O.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=O.invert(I.escape);var R={escape:new RegExp("["+O.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(I.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(e){O[e]=function(t){if(t==null)return"";return(""+t).replace(R[e],function(t){return I[e][t]})}});O.result=function(e,t){if(e==null)return null;var n=e[t];return O.isFunction(n)?n.call(e):n};O.mixin=function(e){j(O.functions(e),function(t){var n=O[t]=e[t];O.prototype[t]=function(){var e=[this._wrapped];u.apply(e,arguments);return P.call(this,n.apply(O,e))}})};var B=0;O.uniqueId=function(e){var t=++B+"";return e?e+t:t};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/;var D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var F=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(e,t,n){var r;n=O.defaults({},n,O.templateSettings);var i=new RegExp([(n.escape||L).source,(n.interpolate||L).source,(n.evaluate||L).source].join("|")+"|$","g");var o=0;var s="__p+='";e.replace(i,function(t,n,r,i,a){s+=e.slice(o,a).replace(F,function(e){return"\\"+D[e]});if(n){s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"}if(r){s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}if(i){s+="';\n"+i+"\n__p+='"}o=a+t.length;return t});s+="';\n";if(!n.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(n.variable||"obj","_",s)}catch(a){a.source=s;throw a}if(t)return r(t,O);var u=function(e){return r.call(this,e,O)};u.source="function("+(n.variable||"obj")+"){\n"+s+"}";return u};O.chain=function(e){return O(e).chain()};var P=function(e){return this._chain?O(e).chain():e};O.mixin(O);j(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];O.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);if((e=="shift"||e=="splice")&&n.length===0)delete n[0];return P.call(this,n)}});j(["concat","join","slice"],function(e){var t=o[e];O.prototype[e]=function(){return P.call(this,t.apply(this._wrapped,arguments))}});O.extend(O.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}],35:[function(e,t,n){var r=e("protoclass");function i(){}r(i,{createElement:function(e){},createFragment:function(){},createComment:function(e){},createTextNode:function(e){},parseHtml:function(e){}});t.exports=i},{protoclass:57}],36:[function(e,t,n){var r=e("./base"),i=e("factories");function o(e,t){r.call(this);this._mainFactory=e;if(!e){throw new Error("main factory must be provided. User string, or dom")}this._factories={element:{}};if(t){this.registerElements(t)}}r.extend(o,{registerElement:function(e,t){this._factories.element[e]=i.factory.create(t);return this},registerElements:function(e){for(var t in e){this.registerElement(t,e[t])}return this},createElement:function(e){var t=this._factories.element[e];if(t)return t.create(e);return this._mainFactory.createElement(e)},createComment:function(e){return this._mainFactory.createTextNode(e)},createTextNode:function(e){return this._mainFactory.createTextNode(e)},createFragment:function(){return this._mainFactory.createFragment.apply(this._mainFactory,arguments)},parseHtml:function(e){return this._mainFactory.parseHtml(e)}});t.exports=function(e,t){return new o(e,t)}},{"./base":35,factories:55}],37:[function(e,t,n){var r=e("./base");function i(){}r.extend(i,{name:"dom",createElement:function(e){return document.createElement(e)},createComment:function(e){return document.createComment(e)},createTextNode:function(e){return document.createTextNode(e)},createFragment:function(e){if(!e)e=[];var t=document.createDocumentFragment();var n=[];for(var r=0,i=e.length;r<i;r++){n.push(e[r])}for(var o=0,s=n.length;o<s;o++){t.appendChild(n[o])}return t}});t.exports=new i},{"./base":35}],38:[function(e,t,n){t.exports={string:e("./string"),dom:e("./dom"),custom:e("./custom")};t.exports["default"]=typeof window!=="undefined"?t.exports.dom:t.exports.custom(t.exports.string,t.exports.string.voidElements);if(typeof window!=="undefined"){window.nofactor=t.exports}},{"./custom":36,"./dom":37,"./string":44}],39:[function(e,t,n){var r=e("./text");function i(){i.superclass.apply(this,arguments)}r.extend(i,{nodeType:8,toString:function(){return"<!--"+i.__super__.toString.call(this)+"-->"},cloneNode:function(){return new i(this.nodeValue)}});t.exports=i},{"./text":47}],40:[function(e,t,n){var r=e("./node");function i(){this.childNodes=[]}r.extend(i,{appendChild:function(e){if(e.nodeType===11&&e.childNodes.length){while(e.childNodes.length){this.appendChild(e.childNodes[0])}return}this._unlink(e);this.childNodes.push(e);this._link(e)},prependChild:function(e){if(!this.childNodes.length){this.appendChild(e)}else{this.insertBefore(e,this.childNodes[0])}},removeChild:function(e){var t=this.childNodes.indexOf(e);if(!~t)return;this.childNodes.splice(t,1);if(e.previousSibling)e.previousSibling.nextSibling=e.nextSibling;if(e.nextSibling)e.nextSibling.previousSibling=e.previousSibling;delete e.parentNode;delete e.nextSibling;delete e.previousSibling},insertBefore:function(e,t){if(e.nodeType===11){var t,n;for(var r=e.childNodes.length;r--;){this.insertBefore(n=e.childNodes[r],t);t=n}}this._splice(this.childNodes.indexOf(t),0,e)},_splice:function(e,t,n){if(typeof e==="undefined")e=-1;if(!~e)return;if(n)this._unlink(n);this.childNodes.splice.apply(this.childNodes,arguments);if(n)this._link(n)},_unlink:function(e){if(e.parentNode){e.parentNode.removeChild(e)}},_link:function(e){if(!e.__isNode){throw new Error("cannot append non-node")}e.parentNode=this;var t=this.childNodes.indexOf(e);if(t!==0)e.previousSibling=this.childNodes[t-1];if(t!=this.childNodes.length-1)e.nextSibling=this.childNodes[t+1];if(e.previousSibling)e.previousSibling.nextSibling=e;if(e.nextSibling)e.nextSibling.previousSibling=e}});t.exports=i},{"./node":45}],41:[function(e,t,n){var r=e("./container"),i=e("./style");function o(e){o.superclass.call(this);this.nodeName=e.toUpperCase();this._name=e.toLowerCase();this.attributes=[];this._attrsByKey={};this.style=new i}r.extend(o,{nodeType:3,setAttribute:function(e,t){e=e.toLowerCase();if(e==="style"){return this.style.reset(t)}if(t==undefined){return this.removeAttribute(e)}var n;if(!(n=this._attrsByKey[e])){this.attributes.push(n=this._attrsByKey[e]={})}n.name=e;n.value=t},removeAttribute:function(e){for(var t=this.attributes.length;t--;){var n=this.attributes[t];if(n.name==e){this.attributes.splice(t,1);break}}delete this._attrsByKey[e]},getAttribute:function(e){var t;if(t=this._attrsByKey[e])return t.value},toString:function(){var e="<"+this._name,t="",n;for(var r in this._attrsByKey){var i=this._attrsByKey[r].value;n=r;if(r!=undefined){n+='="'+i+'"'}t+=" "+n}if(this.style.hasStyles()){t+=" style="+'"'+this.style.toString()+'"'}if(t.length){e+=t}return e+">"+this.childNodes.join("")+"</"+this._name+">"},cloneNode:function(){var e=new o(this.nodeName);for(var t in this._attrsByKey){e.setAttribute(t,this._attrsByKey[t].value)}e.setAttribute("style",this.style.toString());for(var n=0,r=this.childNodes.length;n<r;n++){e.appendChild(this.childNodes[n].cloneNode())}return e}});t.exports=o},{"./container":40,"./style":46}],42:[function(e,t,n){var r={"<":"lt","&":"amp",">":"gt",'"':"quote"};t.exports=function(e){e=String(e);return e.split("").map(function(e){var t=r[e],n=e.charCodeAt(0);if(t){return"&"+t+";"}else if(e.match(/\s/)){return e}else if(n<32||n>126){return"&#"+n+";"}return e}).join("")}},{}],43:[function(e,t,n){var r=e("./container");function i(){i.superclass.call(this)}r.extend(i,{nodeType:11,toString:function(){return this.childNodes.join("")},cloneNode:function(){var e=new i;for(var t=0,n=this.childNodes.length;t<n;t++){e.appendChild(this.childNodes[t].cloneNode())}return e}});t.exports=i},{"./container":40}],44:[function(e,t,n){var r=e("../base"),i=e("./element"),o=e("./fragment"),s=e("./text"),a=e("./comment"),u=e("./container"),c=e("./voidElements");function f(e){this.context=e}r.extend(f,{name:"string",createElement:function(e){return new i(e)},createTextNode:function(e,t){return new s(e,t)},createComment:function(e){return new a(e)},createFragment:function(e){if(!e)e=[];var t=new o,n=Array.prototype.slice.call(e,0);for(var r=0,i=n.length;r<i;r++){t.appendChild(n[r])}return t},parseHtml:function(e){return this.createTextNode(e)}});t.exports=new f;t.exports.Element=i;t.exports.Fragment=o;t.exports.Text=s;t.exports.Container=u;t.exports.voidElements=c},{"../base":35,"./comment":39,"./container":40,"./element":41,"./fragment":43,"./text":47,"./voidElements":48}],45:[function(e,t,n){var r=e("protoclass");function i(){}r(i,{__isNode:true});t.exports=i},{protoclass:57}],46:[function(e,t,n){var r=e("protoclass");function i(){this._currentStyles={}}r(i,{_hasStyle:false,setProperty:function(e,t){if(t===""||t==undefined){delete this[e];return}this[e]=t},reset:function(e){var t=e.split(/;\s*/);for(var n=0,r=t.length;n<r;n++){var i=t[n].split(/:\s*/);if(i[1]==undefined||i[1]==""){continue}this[i[0]]=i[1]}},toString:function(){var e="",t=this.getStyles();for(var n in t){e+=n+":"+t[n]+";"}return e},hasStyles:function(){if(this._hasStyle)return true;for(var e in this){if(e.substr(0,1)!=="_"&&this[e]!=undefined&&this.constructor.prototype[e]==undefined){return this._hasStyle=true}}return false},hasChanged:function(){var e=this.getStyles(),t=this._currentStyles;this._currentStyles=e;for(var n in e){if(e[n]!==t[n]){return true}}for(var n in t){if(e[n]!==t[n]){return true}}return false},getStyles:function(){var e={};for(var t in this){var n=this[t];if(t.substr(0,1)!=="_"&&n!==""&&this[t]!=undefined&&this.constructor.prototype[t]==undefined){e[t]=this[t]}}return e}});t.exports=i},{protoclass:57}],47:[function(e,t,n){var r=e("./node"),i=e("./ent");function o(e,t){this.replaceText(e,t)}r.extend(o,{nodeType:3,toString:function(){return this.nodeValue},cloneNode:function(){return new o(this.nodeValue)},replaceText:function(e,t){this.nodeValue=t?i(e):e}});t.exports=o},{"./ent":42,"./node":45}],48:[function(e,t,n){var r=e("./element");function i(){r.apply(this,arguments)}r.extend(i,{toString:function(){return r.prototype.toString.call(this).replace("></"+this._name+">","/>")},cloneNode:function(){var e=new i(this._name);for(var t in this._attrsByKey){e.setAttribute(t,this._attrsByKey[t].value)}e.setAttribute("style",this.style.toString());return e}});["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track"].forEach(function(e){n[e]=i})},{"./element":41}],49:[function(e,t,n){(function(){var n,r,i={}.hasOwnProperty,o=function(e,t){for(var n in t){if(i.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};r=e("./factory");n=function(e){o(t,e);function t(e){if(e==null){e=[]}this.factories=e.map(r.create)}t.prototype.test=function(e){return!!this._getFactory(e)};t.prototype.push=function(e){return this.factories.push(r.create(e))};t.prototype.create=function(e){var t;return(t=this._getFactory(e))!=null?t.create(e):void 0};t.prototype._getFactory=function(e){var t,n,r,i;i=this.factories;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.test(e)){return t}}};return t}(e("./base"));t.exports=function(e){return new n(e)}}).call(this)},{"./base":50,"./factory":52}],50:[function(e,t,n){(function(){var e;e=function(){function e(){}e.prototype.create=function(e){};e.prototype.test=function(e){};return e}();t.exports=e}).call(this)},{}],51:[function(e,t,n){(function(){var n,r={}.hasOwnProperty,i=function(e,t){for(var n in t){if(r.call(t,n))e[n]=t[n]}function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i;e.__super__=t.prototype;return e};n=function(e){i(t,e);function t(e){this.clazz=e}t.prototype.create=function(e){return new this.clazz(e)};t.prototype.test=function(e){return this.clazz.test(e)};return t}(e("./base"));t.exports=function(e){return new n(e)}}).call(this)},{"./base":50}],52:[function(e,t,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(e,t){for(var n in t){if(a.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};n=e("./class");s=e("type-component");i=e("./fn");r=function(e){u(t,e);function t(){}t.prototype.create=function(e){var t;if(e.create&&e.test){return e}else if((t=s(e))==="function"){if(e.prototype.constructor){return new n(e)}else{return new i(e)}}return e};return t}(e("./base"));o=new r;t.exports=o}).call(this)},{"./base":50,"./class":51,"./fn":53,"type-component":56}],53:[function(e,t,n){(function(){var e;e=function(){function e(e){this.fn=e}e.prototype.test=function(e){return this.fn.test(e)};e.prototype.create=function(e){return this.fn(e)};return e}();t.exports=function(t){return new e(t)}}).call(this)},{}],54:[function(e,t,n){(function(){var n,r,i={}.hasOwnProperty,o=function(e,t){for(var n in t){if(i.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};r=e("./factory");n=function(e){o(t,e);function t(e,t,n){if(e==null){e=[]}if(t==null){t=[]}this.groupClass=n;this.mandatory=e.map(r.create);this.optional=t.map(r.create)}t.prototype.test=function(e){return!!this._getFactories(e,this.mandatory).length};t.prototype.create=function(e){var t,n,r,i,o,s,a,u;n=[];a=this._getFactories(e,this.mandatory);for(r=0,o=a.length;r<o;r++){t=a[r];n.push(t.create(e))}u=this._getFactories(e,this.optional);for(i=0,s=u.length;i<s;i++){t=u[i];n.push(t.create(e))}if(n.length===1){return n[0]}return new this.groupClass(e,n)};t.prototype._getFactories=function(e,t){var n,r,i,o;n=[];for(i=0,o=t.length;i<o;i++){r=t[i];if(r.test(e)){n.push(r)}}return n};return t}(e("./base"));t.exports=function(e,t,r){return new n(e,t,r)}}).call(this)},{"./base":50,"./factory":52}],55:[function(e,t,n){(function(){t.exports={any:e("./any"),"class":e("./class"),factory:e("./factory"),fn:e("./fn"),group:e("./group")}}).call(this)},{"./any":49,"./class":51,"./factory":52,"./fn":53,"./group":54}],56:[function(e,t,n){var r=Object.prototype.toString;t.exports=function(e){switch(r.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array"}if(e===null)return"null";if(e===undefined)return"undefined";if(e===Object(e))return"object";return typeof e}},{}],57:[function(e,t,n){t.exports=e(31)},{}],58:[function(e,t,n){t.exports=function(t){t.use(e("mojo-mediator"));t.once("initialize",function(e){t.mediator.execute("bootstrap",e,function(){if(t.didBootstrap){t.didBootstrap(e)}})})}},{"mojo-mediator":67}],59:[function(e,t,n){},{}],60:[function(e,t,n){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=r;r.EventEmitter=r;r.prototype._events=undefined;r.prototype._maxListeners=undefined;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};r.prototype.emit=function(e){var t,n,r,o,u,c;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||s(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{throw TypeError('Uncaught, unspecified "error" event.')}return false}}n=this._events[e];if(a(n))return false;if(i(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=arguments.length;o=new Array(r-1);for(u=1;u<r;u++)o[u-1]=arguments[u];n.apply(this,o)}}else if(s(n)){r=arguments.length;o=new Array(r-1);for(u=1;u<r;u++)o[u-1]=arguments[u];c=n.slice();r=c.length;for(u=0;u<r;u++)c[u].apply(this,o)}return true};r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(s(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(s(this._events[e])&&!this._events[e].warned){var n;if(!a(this._maxListeners)){n=this._maxListeners}else{n=r.defaultMaxListeners}if(n&&n>0&&this._events[e].length>n){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=false;function r(){this.removeListener(e,r);if(!n){n=true;t.apply(this,arguments)}}r.listener=t;this.on(e,r);return this};r.prototype.removeListener=function(e,t){var n,r,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;n=this._events[e];o=n.length;r=-1;if(n===t||i(n.listener)&&n.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(s(n)){for(a=o;a-->0;){if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}}if(r<0)return this;if(n.length===1){n.length=0;delete this._events[e]}else{n.splice(r,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}n=this._events[e];if(i(n)){this.removeListener(e,n)}else{while(n.length)this.removeListener(e,n[n.length-1])}delete this._events[e];return this};r.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};r.listenerCount=function(e,t){var n;if(!e._events||!e._events[t])n=0;else if(i(e._events[t]))n=1;else n=e._events[t].length;return n};function i(e){return typeof e==="function"}function o(e){return typeof e==="number"}function s(e){return typeof e==="object"&&e!==null}function a(e){return e===void 0}},{}],61:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e=typeof window!=="undefined"&&window.setImmediate;var t=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(e){return function(e){return window.setImmediate(e)}}if(t){var n=[];window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(n.length>0){var r=n.shift();r()}}},true);return function r(e){n.push(e);window.postMessage("process-tick","*")}}return function i(e){setTimeout(e,0)}}();r.title="browser";r.browser=true;r.env={};r.argv=[];function i(){}r.on=i;r.addListener=i;r.once=i;r.off=i;r.removeListener=i;r.removeAllListeners=i;r.emit=i;r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],62:[function(e,t,n){(function(e){(function(r){var i=typeof n=="object"&&n;var o=typeof t=="object"&&t&&t.exports==i&&t;var s=typeof e=="object"&&e;if(s.global===s||s.window===s){r=s}var a,u=2147483647,c=36,f=1,l=26,p=38,h=700,d=72,v=128,m="-",g=/^xn--/,y=/[^ -~]/,_=/\x2E|\u3002|\uFF0E|\uFF61/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-f,x=Math.floor,k=String.fromCharCode,E;function O(e){throw RangeError(b[e])}function j(e,t){var n=e.length;while(n--){e[n]=t(e[n])}return e}function S(e,t){return j(e.split(_),t).join(".")}function A(e){var t=[],n=0,r=e.length,i,o;while(n<r){i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){o=e.charCodeAt(n++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);n--}}else{t.push(i)}}return t}function C(e){return j(e,function(e){var t="";if(e>65535){e-=65536;t+=k(e>>>10&1023|55296);e=56320|e&1023}t+=k(e);return t}).join("")}function T(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return c}function N(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function q(e,t,n){var r=0;e=n?x(e/h):e>>1;e+=x(e/t);for(;e>w*l>>1;r+=c){e=x(e/w)}return x(r+(w+1)*e/(e+p))}function I(e){var t=[],n=e.length,r,i=0,o=v,s=d,a,p,h,g,y,_,b,w,k;a=e.lastIndexOf(m);if(a<0){a=0}for(p=0;p<a;++p){if(e.charCodeAt(p)>=128){O("not-basic")}t.push(e.charCodeAt(p))}for(h=a>0?a+1:0;h<n;){for(g=i,y=1,_=c;;_+=c){if(h>=n){O("invalid-input")}b=T(e.charCodeAt(h++));if(b>=c||b>x((u-i)/y)){O("overflow")}i+=b*y;w=_<=s?f:_>=s+l?l:_-s;if(b<w){break}k=c-w;if(y>x(u/k)){O("overflow")}y*=k}r=t.length+1;s=q(i-g,r,g==0);if(x(i/r)>u-o){O("overflow")}o+=x(i/r);i%=r;t.splice(i++,0,o)}return C(t)}function R(e){var t,n,r,i,o,s,a,p,h,g,y,_=[],b,w,E,j;e=A(e);b=e.length;t=v;n=0;o=d;for(s=0;s<b;++s){y=e[s];if(y<128){_.push(k(y))}}r=i=_.length;if(i){_.push(m)}while(r<b){for(a=u,s=0;s<b;++s){y=e[s];if(y>=t&&y<a){a=y}}w=r+1;if(a-t>x((u-n)/w)){O("overflow")}n+=(a-t)*w;t=a;for(s=0;s<b;++s){y=e[s];if(y<t&&++n>u){O("overflow")}if(y==t){for(p=n,h=c;;h+=c){g=h<=o?f:h>=o+l?l:h-o;if(p<g){break}j=p-g;E=c-g;_.push(k(N(g+j%E,0)));p=x(j/E)}_.push(k(N(p,0)));o=q(n,w,r==i);n=0;++r}}++n;++t}return _.join("")}function B(e){return S(e,function(e){return g.test(e)?I(e.slice(4).toLowerCase()):e})}function L(e){return S(e,function(e){return y.test(e)?"xn--"+R(e):e})}a={version:"1.2.4",ucs2:{decode:A,encode:C},decode:I,encode:R,toASCII:L,toUnicode:B};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return a})}else if(i&&!i.nodeType){if(o){o.exports=a}else{for(E in a){a.hasOwnProperty(E)&&(i[E]=a[E])}}}else{r.punycode=a}})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],63:[function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||"&";n=n||"=";var s={};if(typeof e!=="string"||e.length===0){return s}var a=/\+/g;e=e.split(t);var u=1e3;if(o&&typeof o.maxKeys==="number"){u=o.maxKeys}var c=e.length;if(u>0&&c>u){c=u}for(var f=0;f<c;++f){var l=e[f].replace(a,"%20"),p=l.indexOf(n),h,d,v,m;if(p>=0){h=l.substr(0,p);d=l.substr(p+1)}else{h=l;d=""}v=decodeURIComponent(h);m=decodeURIComponent(d);if(!r(s,v)){s[v]=m}else if(i(s[v])){s[v].push(m)}else{s[v]=[s[v],m]}}return s};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},{}],64:[function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,a){t=t||"&";n=n||"=";if(e===null){e=undefined}if(typeof e==="object"){return o(s(e),function(s){var a=encodeURIComponent(r(s))+n;if(i(e[s])){return o(e[s],function(e){return a+encodeURIComponent(r(e))}).join(t)}else{return a+encodeURIComponent(r(e[s]))}}).join(t)}if(!a)return"";return encodeURIComponent(r(a))+n+encodeURIComponent(r(e))};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function o(e,t){if(e.map)return e.map(t);var n=[];for(var r=0;r<e.length;r++){n.push(t(e[r],r))}return n}var s=Object.keys||function(e){var t=[];for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n))t.push(n)}return t}},{}],65:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode");n.encode=n.stringify=e("./encode")},{"./decode":63,"./encode":64}],66:[function(e,t,n){var r=e("punycode");n.parse=_;n.resolve=w;n.resolveObject=x;n.format=b;n.Url=i;function i(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=["<",">",'"',"`"," ","\r","\n","	"],u=["{","}","|","\\","^","`"].concat(a),c=["'"].concat(u),f=["%","/","?",";","#"].concat(c),l=["/","?","#"],p=255,h=/^[a-z0-9A-Z_-]{0,63}$/,d=/^([a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:true,"javascript:":true},m={javascript:true,"javascript:":true},g={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},y=e("querystring");function _(e,t,n){if(e&&E(e)&&e instanceof i)return e;var r=new i;r.parse(e,t,n);return r}i.prototype.parse=function(e,t,n){if(!k(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var i=e;i=i.trim();var s=o.exec(i);if(s){s=s[0];var a=s.toLowerCase();this.protocol=a;i=i.substr(s.length)}if(n||s||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=i.substr(0,2)==="//";if(u&&!(s&&m[s])){i=i.substr(2);this.slashes=true}}if(!m[s]&&(u||s&&!g[s])){var _=-1;for(var b=0;b<l.length;b++){var w=i.indexOf(l[b]);if(w!==-1&&(_===-1||w<_))_=w}var x,E;if(_===-1){E=i.lastIndexOf("@")}else{E=i.lastIndexOf("@",_)}if(E!==-1){x=i.slice(0,E);i=i.slice(E+1);this.auth=decodeURIComponent(x)}_=-1;for(var b=0;b<f.length;b++){var w=i.indexOf(f[b]);if(w!==-1&&(_===-1||w<_))_=w}if(_===-1)_=i.length;this.host=i.slice(0,_);i=i.slice(_);this.parseHost();this.hostname=this.hostname||"";var O=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!O){var j=this.hostname.split(/\./);for(var b=0,S=j.length;b<S;b++){var A=j[b];if(!A)continue;if(!A.match(h)){var C="";for(var T=0,N=A.length;T<N;T++){if(A.charCodeAt(T)>127){C+="x"}else{C+=A[T]}}if(!C.match(h)){var q=j.slice(0,b);var I=j.slice(b+1);var R=A.match(d);if(R){q.push(R[1]);I.unshift(R[2])}if(I.length){i="/"+I.join(".")+i}this.hostname=q.join(".");break}}}}if(this.hostname.length>p){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!O){var B=this.hostname.split(".");var L=[];for(var b=0;b<B.length;++b){var D=B[b];L.push(D.match(/[^A-Za-z0-9_-]/)?"xn--"+r.encode(D):D)}this.hostname=L.join(".")}var F=this.port?":"+this.port:"";var P=this.hostname||"";this.host=P+F;this.href+=this.host;if(O){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(i[0]!=="/"){i="/"+i}}}if(!v[a]){for(var b=0,S=c.length;b<S;b++){var M=c[b];var $=encodeURIComponent(M);if($===M){$=escape(M)}i=i.split(M).join($)}}var U=i.indexOf("#");if(U!==-1){this.hash=i.substr(U);i=i.slice(0,U)}var z=i.indexOf("?");if(z!==-1){this.search=i.substr(z);this.query=i.substr(z+1);if(t){this.query=y.parse(this.query)}i=i.slice(0,z)}else if(t){this.search="";this.query={}}if(i)this.pathname=i;if(g[a]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var F=this.pathname||"";var D=this.search||"";this.path=F+D}this.href=this.format();return this};function b(e){if(k(e))e=_(e);if(!(e instanceof i))return i.prototype.format.call(e);return e.format()}i.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=false,o="";if(this.host){i=e+this.host}else if(this.hostname){i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){i+=":"+this.port}}if(this.query&&E(this.query)&&Object.keys(this.query).length){o=y.stringify(this.query)}var s=this.search||o&&"?"+o||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||g[t])&&i!==false){i="//"+(i||"");if(n&&n.charAt(0)!=="/")n="/"+n}else if(!i){i=""}if(r&&r.charAt(0)!=="#")r="#"+r;if(s&&s.charAt(0)!=="?")s="?"+s;n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)});s=s.replace("#","%23");return t+i+n+s+r};function w(e,t){return _(e,false,true).resolve(t)}i.prototype.resolve=function(e){return this.resolveObject(_(e,false,true)).format()};function x(e,t){if(!e)return t;return _(e,false,true).resolveObject(t)}i.prototype.resolveObject=function(e){if(k(e)){var t=new i;t.parse(e,false,true);e=t}var n=new i;Object.keys(this).forEach(function(e){n[e]=this[e]},this);n.hash=e.hash;if(e.href===""){n.href=n.format();return n}if(e.slashes&&!e.protocol){Object.keys(e).forEach(function(t){if(t!=="protocol")n[t]=e[t]});if(g[n.protocol]&&n.hostname&&!n.pathname){n.path=n.pathname="/"}n.href=n.format();return n}if(e.protocol&&e.protocol!==n.protocol){if(!g[e.protocol]){Object.keys(e).forEach(function(t){n[t]=e[t]});n.href=n.format();return n}n.protocol=e.protocol;if(!e.host&&!m[e.protocol]){var r=(e.pathname||"").split("/");while(r.length&&!(e.host=r.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(r[0]!=="")r.unshift("");if(r.length<2)r.unshift("");n.pathname=r.join("/")
}else{n.pathname=e.pathname}n.search=e.search;n.query=e.query;n.host=e.host||"";n.auth=e.auth;n.hostname=e.hostname||e.host;n.port=e.port;if(n.pathname||n.search){var o=n.pathname||"";var s=n.search||"";n.path=o+s}n.slashes=n.slashes||e.slashes;n.href=n.format();return n}var a=n.pathname&&n.pathname.charAt(0)==="/",u=e.host||e.pathname&&e.pathname.charAt(0)==="/",c=u||a||n.host&&e.pathname,f=c,l=n.pathname&&n.pathname.split("/")||[],r=e.pathname&&e.pathname.split("/")||[],p=n.protocol&&!g[n.protocol];if(p){n.hostname="";n.port=null;if(n.host){if(l[0]==="")l[0]=n.host;else l.unshift(n.host)}n.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){if(r[0]==="")r[0]=e.host;else r.unshift(e.host)}e.host=null}c=c&&(r[0]===""||l[0]==="")}if(u){n.host=e.host||e.host===""?e.host:n.host;n.hostname=e.hostname||e.hostname===""?e.hostname:n.hostname;n.search=e.search;n.query=e.query;l=r}else if(r.length){if(!l)l=[];l.pop();l=l.concat(r);n.search=e.search;n.query=e.query}else if(!j(e.search)){if(p){n.hostname=n.host=l.shift();var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):false;if(h){n.auth=h.shift();n.host=n.hostname=h.shift()}}n.search=e.search;n.query=e.query;if(!O(n.pathname)||!O(n.search)){n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")}n.href=n.format();return n}if(!l.length){n.pathname=null;if(n.search){n.path="/"+n.search}else{n.path=null}n.href=n.format();return n}var d=l.slice(-1)[0];var v=(n.host||e.host)&&(d==="."||d==="..")||d==="";var y=0;for(var _=l.length;_>=0;_--){d=l[_];if(d=="."){l.splice(_,1)}else if(d===".."){l.splice(_,1);y++}else if(y){l.splice(_,1);y--}}if(!c&&!f){for(;y--;y){l.unshift("..")}}if(c&&l[0]!==""&&(!l[0]||l[0].charAt(0)!=="/")){l.unshift("")}if(v&&l.join("/").substr(-1)!=="/"){l.push("")}var b=l[0]===""||l[0]&&l[0].charAt(0)==="/";if(p){n.hostname=n.host=b?"":l.length?l.shift():"";var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):false;if(h){n.auth=h.shift();n.host=n.hostname=h.shift()}}c=c||n.host&&l.length;if(c&&!b){l.unshift("")}if(!l.length){n.pathname=null;n.path=null}else{n.pathname=l.join("/")}if(!O(n.pathname)||!O(n.search)){n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")}n.auth=e.auth||n.auth;n.slashes=n.slashes||e.slashes;n.href=n.format();return n};i.prototype.parseHost=function(){var e=this.host;var t=s.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e};function k(e){return typeof e==="string"}function E(e){return typeof e==="object"&&e!==null}function O(e){return e===null}function j(e){return e==null}},{punycode:62,querystring:65}],67:[function(e,t,n){var r=e("mediocre");t.exports=function(e){if(e.mediator)return;var t=e.mediator=r();t.application=e}},{mediocre:73}],68:[function(e,t,n){var r=e("type-component"),i=e("async");t.exports={test:function(e){return r(e.listener)==="array"},create:function(e){if(e.listener.length===1){return e.listener[0]}return function(t,n){i.eachSeries(e.listener,function(e,n){e.call(this,t,n)},n)}}}},{async:75,"type-component":88}],69:[function(e,t,n){var r=e("type-component");t.exports={test:function(e){return r(e.listener)==="function"},create:function(e){var t=e.listener;return function(e,n){t(e,function(t){if(t)return n(t);var r=Array.prototype.slice.call(arguments,1);if(r.length){e.root.args=r}n()})}}}},{"type-component":88}],70:[function(e,t,n){var r,i=[e("./obj"),e("./fn"),e("./ref"),r=e("./collection")];t.exports={push:function(e){i.push(e)},create:function(e,t){var n=[],o,s,a;for(var u=0;u<t.length;u++){o=t[u];s={mediator:e,listener:o};for(var c=0;c<i.length;c++){a=i[c];if(a.test(s)){n=n.concat(a.create(s))}}}return r.create({mediator:e,listener:n})}}},{"./collection":68,"./fn":69,"./obj":71,"./ref":72}],71:[function(e,t,n){var r=e("type-component"),i=e("async");t.exports={test:function(e){return r(e.listener)==="object"},create:function(e){var t=Object.keys(e.listener),n=e.mediator;return function(r,o){i.eachSeries(t,function(t,i){n.execute(r.child(t,e.listener[t]),i)},o)}}}},{async:75,"type-component":88}],72:[function(e,t,n){var r=e("type-component");t.exports={test:function(e){return r(e)==="string"},create:function(e){var t=e.mediator,n=e.listener;return function(e,r){t.execute(e.child(n),r)}}}},{"type-component":88}],73:[function(e,t,n){var r=e("./message"),i=e("./factory"),o=e("./factory/collection"),s=e("type-component"),a=e("async"),u=e("protoclass"),c=e("sift");function f(){this._listeners={};this._spies=[]}u(f,{on:function(e){var t,n,r,o;t=Array.prototype.slice.call(arguments,1);if(e.test){return i.push(e)}n=this._parse(e);if(!(o=this._listeners[n.name])){o=this._listeners[n.name]={pre:[],post:[]}}t=i.create(this,t);if(n.type){r=o[n.type];r.push(t)}else{o.callback=t}return{dispose:function(){var e;if(r){e=r.indexOf(t);if(~e){r.splice(e,1)}}else{delete this._listeners[n.name]}}}},spy:function(e,t){this._spies.push({test:c(e).test,listener:t})},_triggerSpies:function(e){for(var t=this._spies.length;t--;){var n=this._spies[t];if(n.test(e.data)){n.listener(e)}}},message:function(e,t,n){if(arguments.length===2){n={}}return new r(e,t||{},n||{},this)},once:function(e){var t,n;t=Array.prototype.slice.call(arguments,1);t.unshift(function(e,t){n.dispose();t()});return n=this.on.apply(this,[e].concat(t))},execute:function(e,t,n){var r,i,o;if(!e.__isCommand){r=this.message(e,t)}else{r=e;n=t}if(arguments.length===2&&s(t)==="function"){n=t}if(s(n)!=="function"){n=function(){}}i=this._listeners[r.name]||{};o=(i.pre||[]).concat(i.callback||[]).concat(i.post||[]);r.listeners=o;this._triggerSpies(r);r.set("loading",true);function u(e,t){var i=arguments;a.nextTick(function(){if(e){r.set("error",e);return n(e)}r.set("success",!e);r.set("loading",false);r.set("data",t);n.apply(this,i)})}if(!o.length){u(new Error("command '"+e+"' does not exist"));return r}var c=[];a.eachSeries(o,function(e,t){e(r,function(n){if(!n&&e===i.callback){c=r.args.length?[null].concat(r.args):Array.prototype.slice.call(arguments,0)}t(n)})},function(e){if(e)return u.apply(this,arguments);u.apply(this,c)});return r},_parse:function(e){var t=e.split(" "),n=t.pop(),r=t.pop();return{type:r,name:n}}});t.exports=function(){return new f}},{"./factory":70,"./factory/collection":68,"./message":74,async:75,protoclass:86,sift:87,"type-component":88}],74:[function(e,t,n){var r=e("bindable");function i(e,t,n,i,o){r.Object.call(this,this);this.name=e;this.data=t;this.options=n||{};this.mediator=i;this.parent=o;this.args=[];this.root=o?o.root:this;var s=this;["success","result","data","error"].forEach(function(e){s.bind(e,function(){s.emit.apply(s,[e].concat(Array.prototype.slice.call(arguments,0)))})})}r.Object.extend(i,{__isCommand:true,child:function(e,t){return new i(e,this.data,t,this.mediator,this)}});t.exports=i},{bindable:78}],75:[function(e,t,n){(function(e){(function(){var n={};var r,i;r=this;if(r!=null){i=r.async}n.noConflict=function(){r.async=i;return n};function o(e){var t=false;return function(){if(t)throw new Error("Callback was already called.");t=true;e.apply(r,arguments)}}var s=Object.prototype.toString;var a=Array.isArray||function(e){return s.call(e)==="[object Array]"};var u=function(e,t){if(e.forEach){return e.forEach(t)}for(var n=0;n<e.length;n+=1){t(e[n],n,e)}};var c=function(e,t){if(e.map){return e.map(t)}var n=[];u(e,function(e,r,i){n.push(t(e,r,i))});return n};var f=function(e,t,n){if(e.reduce){return e.reduce(t,n)}u(e,function(e,r,i){n=t(n,e,r,i)});return n};var l=function(e){if(Object.keys){return Object.keys(e)}var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t};if(typeof e==="undefined"||!e.nextTick){if(typeof setImmediate==="function"){n.nextTick=function(e){setImmediate(e)};n.setImmediate=n.nextTick}else{n.nextTick=function(e){setTimeout(e,0)};n.setImmediate=n.nextTick}}else{n.nextTick=e.nextTick;if(typeof setImmediate!=="undefined"){n.setImmediate=function(e){setImmediate(e)}}else{n.setImmediate=n.nextTick}}n.each=function(e,t,n){n=n||function(){};if(!e.length){return n()}var r=0;u(e,function(e){t(e,o(i))});function i(t){if(t){n(t);n=function(){}}else{r+=1;if(r>=e.length){n()}}}};n.forEach=n.each;n.eachSeries=function(e,t,n){n=n||function(){};if(!e.length){return n()}var r=0;var i=function(){t(e[r],function(t){if(t){n(t);n=function(){}}else{r+=1;if(r>=e.length){n()}else{i()}}})};i()};n.forEachSeries=n.eachSeries;n.eachLimit=function(e,t,n,r){var i=p(t);i.apply(null,[e,n,r])};n.forEachLimit=n.eachLimit;var p=function(e){return function(t,n,r){r=r||function(){};if(!t.length||e<=0){return r()}var i=0;var o=0;var s=0;(function a(){if(i>=t.length){return r()}while(s<e&&o<t.length){o+=1;s+=1;n(t[o-1],function(e){if(e){r(e);r=function(){}}else{i+=1;s-=1;if(i>=t.length){r()}else{a()}}})}})()}};var h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.each].concat(t))}};var d=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[p(e)].concat(n))}};var v=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.eachSeries].concat(t))}};var m=function(e,t,n,r){var i=[];t=c(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r;t(n)})},function(e){r(e,i)})};n.map=h(m);n.mapSeries=v(m);n.mapLimit=function(e,t,n,r){return g(t)(e,n,r)};var g=function(e){return d(e,m)};n.reduce=function(e,t,r,i){n.eachSeries(e,function(e,n){r(t,e,function(e,r){t=r;n(e)})},function(e){i(e,t)})};n.inject=n.reduce;n.foldl=n.reduce;n.reduceRight=function(e,t,r,i){var o=c(e,function(e){return e}).reverse();n.reduce(o,t,r,i)};n.foldr=n.reduceRight;var y=function(e,t,n,r){var i=[];t=c(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n){if(n){i.push(e)}t()})},function(e){r(c(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.filter=h(y);n.filterSeries=v(y);n.select=n.filter;n.selectSeries=n.filterSeries;var _=function(e,t,n,r){var i=[];t=c(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n){if(!n){i.push(e)}t()})},function(e){r(c(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.reject=h(_);n.rejectSeries=v(_);var b=function(e,t,n,r){e(t,function(e,t){n(e,function(n){if(n){r(e);r=function(){}}else{t()}})},function(e){r()})};n.detect=h(b);n.detectSeries=v(b);n.some=function(e,t,r){n.each(e,function(e,n){t(e,function(e){if(e){r(true);r=function(){}}n()})},function(e){r(false)})};n.any=n.some;n.every=function(e,t,r){n.each(e,function(e,n){t(e,function(e){if(!e){r(false);r=function(){}}n()})},function(e){r(true)})};n.all=n.every;n.sortBy=function(e,t,r){n.map(e,function(e,n){t(e,function(t,r){if(t){n(t)}else{n(null,{value:e,criteria:r})}})},function(e,t){if(e){return r(e)}else{var n=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};r(null,c(t.sort(n),function(e){return e.value}))}})};n.auto=function(e,t){t=t||function(){};var r=l(e);var i=r.length;if(!i){return t()}var o={};var s=[];var c=function(e){s.unshift(e)};var p=function(e){for(var t=0;t<s.length;t+=1){if(s[t]===e){s.splice(t,1);return}}};var h=function(){i--;u(s.slice(0),function(e){e()})};c(function(){if(!i){var e=t;t=function(){};e(null,o)}});u(r,function(r){var i=a(e[r])?e[r]:[e[r]];var s=function(e){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1){i=i[0]}if(e){var s={};u(l(o),function(e){s[e]=o[e]});s[r]=i;t(e,s);t=function(){}}else{o[r]=i;n.setImmediate(h)}};var d=i.slice(0,Math.abs(i.length-1))||[];var v=function(){return f(d,function(e,t){return e&&o.hasOwnProperty(t)},true)&&!o.hasOwnProperty(r)};if(v()){i[i.length-1](s,o)}else{var m=function(){if(v()){p(m);i[i.length-1](s,o)}};c(m)}})};n.retry=function(e,t,r){var i=5;var o=[];if(typeof e==="function"){r=t;t=e;e=i}e=parseInt(e,10)||i;var s=function(i,s){var a=function(e,t){return function(n){e(function(e,r){n(!e||t,{err:e,result:r})},s)}};while(e){o.push(a(t,!(e-=1)))}n.series(o,function(e,t){t=t[t.length-1];(i||r)(t.err,t.result)})};return r?s():s};n.waterfall=function(e,t){t=t||function(){};if(!a(e)){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}if(!e.length){return t()}var i=function(e){return function(r){if(r){t.apply(null,arguments);t=function(){}}else{var o=Array.prototype.slice.call(arguments,1);var s=e.next();if(s){o.push(i(s))}else{o.push(t)}n.setImmediate(function(){e.apply(null,o)})}}};i(n.iterator(e))()};var w=function(e,t,n){n=n||function(){};if(a(t)){e.map(t,function(e,t){if(e){e(function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}t.call(null,e,n)})}},n)}else{var r={};e.each(l(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1){i=i[0]}r[e]=i;n(t)})},function(e){n(e,r)})}};n.parallel=function(e,t){w({map:n.map,each:n.each},e,t)};n.parallelLimit=function(e,t,n){w({map:g(t),each:p(t)},e,n)};n.series=function(e,t){t=t||function(){};if(a(e)){n.mapSeries(e,function(e,t){if(e){e(function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}t.call(null,e,n)})}},t)}else{var r={};n.eachSeries(l(e),function(t,n){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1){i=i[0]}r[t]=i;n(e)})},function(e){t(e,r)})}};n.iterator=function(e){var t=function(n){var r=function(){if(e.length){e[n].apply(null,arguments)}return r.next()};r.next=function(){return n<e.length-1?t(n+1):null};return r};return t(0)};n.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var x=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]);t(e)})},function(e){r(e,i)})};n.concat=h(x);n.concatSeries=v(x);n.whilst=function(e,t,r){if(e()){t(function(i){if(i){return r(i)}n.whilst(e,t,r)})}else{r()}};n.doWhilst=function(e,t,r){e(function(i){if(i){return r(i)}var o=Array.prototype.slice.call(arguments,1);if(t.apply(null,o)){n.doWhilst(e,t,r)}else{r()}})};n.until=function(e,t,r){if(!e()){t(function(i){if(i){return r(i)}n.until(e,t,r)})}else{r()}};n.doUntil=function(e,t,r){e(function(i){if(i){return r(i)}var o=Array.prototype.slice.call(arguments,1);if(!t.apply(null,o)){n.doUntil(e,t,r)}else{r()}})};n.queue=function(e,t){if(t===undefined){t=1}function r(e,t,r,i){if(!e.started){e.started=true}if(!a(t)){t=[t]}if(t.length==0){return n.setImmediate(function(){if(e.drain){e.drain()}})}u(t,function(t){var o={data:t,callback:typeof i==="function"?i:null};if(r){e.tasks.unshift(o)}else{e.tasks.push(o)}if(e.saturated&&e.tasks.length===e.concurrency){e.saturated()}n.setImmediate(e.process)})}var i=0;var s={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:false,paused:false,push:function(e,t){r(s,e,false,t)},kill:function(){s.drain=null;s.tasks=[]},unshift:function(e,t){r(s,e,true,t)},process:function(){if(!s.paused&&i<s.concurrency&&s.tasks.length){var t=s.tasks.shift();if(s.empty&&s.tasks.length===0){s.empty()}i+=1;var n=function(){i-=1;if(t.callback){t.callback.apply(t,arguments)}if(s.drain&&s.tasks.length+i===0){s.drain()}s.process()};var r=o(n);e(t.data,r)}},length:function(){return s.tasks.length},running:function(){return i},idle:function(){return s.tasks.length+i===0},pause:function(){if(s.paused===true){return}s.paused=true;s.process()},resume:function(){if(s.paused===false){return}s.paused=false;s.process()}};return s};n.cargo=function(e,t){var r=false,i=[];var o={tasks:i,payload:t,saturated:null,empty:null,drain:null,drained:true,push:function(e,r){if(!a(e)){e=[e]}u(e,function(e){i.push({data:e,callback:typeof r==="function"?r:null});o.drained=false;if(o.saturated&&i.length===t){o.saturated()}});n.setImmediate(o.process)},process:function s(){if(r)return;if(i.length===0){if(o.drain&&!o.drained)o.drain();o.drained=true;return}var n=typeof t==="number"?i.splice(0,t):i.splice(0,i.length);var a=c(n,function(e){return e.data});if(o.empty)o.empty();r=true;e(a,function(){r=false;var e=arguments;u(n,function(t){if(t.callback){t.callback.apply(null,e)}});s()})},length:function(){return i.length},running:function(){return r}};return o};var k=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(t){if(console.error){console.error(t)}}else if(console[e]){u(n,function(t){console[e](t)})}}}]))}};n.log=k("log");n.dir=k("dir");n.memoize=function(e,t){var r={};var i={};t=t||function(e){return e};var o=function(){var o=Array.prototype.slice.call(arguments);var s=o.pop();var a=t.apply(null,o);if(a in r){n.nextTick(function(){s.apply(null,r[a])})}else if(a in i){i[a].push(s)}else{i[a]=[s];e.apply(null,o.concat([function(){r[a]=arguments;var e=i[a];delete i[a];for(var t=0,n=e.length;t<n;t++){e[t].apply(null,arguments)}}]))}};o.memo=r;o.unmemoized=e;return o};n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}};n.times=function(e,t,r){var i=[];for(var o=0;o<e;o++){i.push(o)}return n.map(i,t,r)};n.timesSeries=function(e,t,r){var i=[];for(var o=0;o<e;o++){i.push(o)}return n.mapSeries(i,t,r)};n.seq=function(){var e=arguments;return function(){var t=this;var r=Array.prototype.slice.call(arguments);var i=r.pop();n.reduce(e,r,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0];var t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){i.apply(t,[e].concat(n))})}};n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))};var E=function(e,t){var n=function(){var n=this;var r=Array.prototype.slice.call(arguments);var i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}else{return n}};n.applyEach=h(E);n.applyEachSeries=v(E);n.forever=function(e,t){function n(r){if(r){if(t){return t(r)}throw r}e(n)}n()};if(typeof t!=="undefined"&&t.exports){t.exports=n}else if(typeof define!=="undefined"&&define.amd){define([],function(){return n})}else{r.async=n}})()}).call(this,e("OpdoqP"))},{OpdoqP:61}],76:[function(e,t,n){arguments[4][23][0].apply(n,arguments)},{"../object":79,"../utils/computed":82,sift:87}],77:[function(e,t,n){t.exports=e(24)},{protoclass:86}],78:[function(e,t,n){arguments[4][25][0].apply(n,arguments)},{"./collection":76,"./core/eventEmitter":77,"./object":79,"./utils/computed":82,"./utils/options":83}],79:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":77,"./watchProperty":81,protoclass:86}],80:[function(e,t,n){t.exports=e(27)},{toarray:84,underscore:85}],81:[function(e,t,n){t.exports=e(28)},{"../utils/options":83,"./transform":80,underscore:85}],82:[function(e,t,n){t.exports=e(29)},{toarray:84}],83:[function(e,t,n){t.exports=e(30)},{}],84:[function(e,t,n){t.exports=e(33)},{}],85:[function(e,t,n){t.exports=e(34)},{}],86:[function(e,t,n){t.exports=e(31)},{}],87:[function(e,t,n){(function(){var e=function(e,t){var n={},r=n;for(var i=0,o=e.length-1;i<o;i++){r=r[e[i]]={}}r[e[i]]=t;return n};var n=new function(){var t=this.priority=function(e,t){var n=e.exprs,r=0;for(var o=0,s=n.length;o<s;o++){var a=n[o],u;if(!~(u=a.e(a.v,i(t),t)))return-1;r+=u}return r};var n=this.parse=function(i,o){if(!i)i={$eq:i};var a=[];if(Object.prototype.toString.call(i)==="[object Object]"){for(var c in i){var f=!!s[c]?c:"$trav",l=i[c],p=l;if(r[f]){if(~c.indexOf(".")){var h=c.split(".");c=h.shift();p=l=e(h,l)}if(l instanceof Array){p=[];for(var d=l.length;d--;){p.push(n(l[d]))}}else{p=n(l,c)}}a.push(u(f,c,p))}}else{a.push(u("$eq",c,i))}var v={exprs:a,k:o,test:function(e){return!!~v.priority(e)},priority:function(e){return t(v,e)}};return v};var r=this.traversable={$and:true,$or:true,$nor:true,$trav:true,$not:true};function i(e){if(e instanceof Date){return e.getTime()}else{return e}}function o(e){return e?0:-1}var s=this.testers={$eq:function(e,t){return o(e.test(t))},$ne:function(e,t){return o(!e.test(t))},$lt:function(e,t){return o(e>t)},$gt:function(e,t){return o(e<t)},$lte:function(e,t){return o(e>=t)},$gte:function(e,t){return o(e<=t)},$exists:function(e,t){return o(e===(t!=null))},$in:function(e,t){if(t instanceof Array){for(var n=t.length;n--;){if(~e.indexOf(t[n]))return n}}else{return o(~e.indexOf(t))}return-1},$not:function(e,t){if(!e.test)throw new Error("$not test should include an expression, not a value. Use $ne instead.");return o(!e.test(t))},$type:function(e,t,n){return n?o(n instanceof e||n.constructor==e):-1},$nin:function(e,t){return~s.$in(e,t)?-1:0},$mod:function(e,t){return t%e[0]==e[1]?0:-1},$all:function(e,t){for(var n=e.length;n--;){var r=e[n];var i=~t.indexOf(r);if(!i)return-1}return 0},$size:function(e,t){return t?o(e==t.length):-1},$or:function(e,n){var r=e.length,i,s=r;for(;r--;){if(~t(e[r],n)){return r}}return o(s==0)},$nor:function(e,n){var r=e.length,i=r;for(;r--;){if(~t(e[r],n)){return-1}}return 0},$and:function(e,n){for(var r=e.length;r--;){if(!~t(e[r],n)){return-1}}return 0},$trav:function(e,n){if(n instanceof Array){for(var r=n.length;r--;){var i=n[r];if(i[e.k]&&~t(e,i[e.k]))return r}return-1}return t(e,n?n[e.k]:undefined)},$regex:function(e,t){var n=new RegExp(e);return n.test(t)?0:-1}};var a={$eq:function(e){var t;if(e instanceof RegExp){return e}else if(e instanceof Function){t=e}else{t=function(t){if(t instanceof Array){return~t.indexOf(e)}else{return e==t}}}return{test:t}},$ne:function(e){return a.$eq(e)}};var u=function(e,t,n){var r=i(n);return{k:t,v:a[e]?a[e](r):r,e:s[e]}}};var r=function(e){if(!e){return function(e){return e}}else if(typeof e=="function"){return e}throw new Error("Unknown sift selector "+e)};var i=function(e,t){var r=n.parse(e);var i=function(e){var n=[],i=[],o,s,a;for(var u=0,c=e.length;u<c;u++){s=e[u];o=t(s);if(!~(a=r.priority(o)))continue;n.push({value:s,priority:a})}n.sort(function(e,t){return e.priority>t.priority?-1:1});var f=Array(n.length);for(var u=n.length;u--;){f[u]=n[u].value}return f};i.test=r.test;i.score=r.priority;i.query=e;return i};var o=function(e,t,n){if(typeof t!="object"){n=t;t=undefined}var o=i(e,r(n));if(t)return o(t);return o};o.use=function(e){if(e.operators)o.useOperators(e.operators)};o.useOperators=function(e){for(var t in e){o.useOperator(t,e[t])}};o.useOperator=function(e,t){var r={};if(typeof t=="object"){r=t}else{r={test:t}}var i="$"+e;n.testers[i]=r.test;if(r.traversable||r.traverse){n.traversable[i]=true}};if(typeof t!="undefined"&&typeof t.exports!="undefined"){t.exports=o}else if(typeof window!="undefined"){window.sift=o}})()},{}],88:[function(e,t,n){t.exports=e(56)},{}],89:[function(e,t,n){var r=e("bindable"),i=e("lodash"),o=e("./model"),s=e("janitorjs");function a(e,t){if(!e)e={};r.Collection.call(this,[]);this.application=t;this._modelsJanitor=s();this.bind("data",i.bind(this._onData,this));this.setProperties(e);t.models.decorate(this)}t.exports=r.Collection.extend(a,{idProperty:"_id",deserialize:function(e){return e},createModel:function(e){var t={data:e,collection:this},n=o;if(this.modelType){if(typeof this.modelType==="function"){n=this.modelType}else{return this.application.models.create(this.modelType,t)}}return new n(t,this.application)},create:function(e){if(!e)e={};var t=this.createModel(e.data);t.setProperties(e);if(!t.data){var n=this;t.once("save",function(){if(e.waitUntilSave===true)n.push(t)})}if(e.waitUntilSave!==true){this.push(this._watchModel(t))}return t},serialize:function(){return this.source().toJSON()},_onData:function(e){var t=this;var n=this.deserialize(e||[]),r=this.source().concat();for(var i=r.length;i--;){var o=r[i];for(var s=n.length;s--;){var a=n[s];if(this._compareIds(o,a)){o.set("data",a);r.splice(i,1);n.splice(s,1)}}}for(var i=r.length;i--;){this.splice(this.indexOf(r[i]),1)}for(var i=0,u=n.length;i<u;i++){this.push(this._watchModel(this.createModel(n[i])))}this._rewatchModels()},_watchModel:function(e){var t=this;e.once("dispose",function(){var n=t.indexOf(e);if(!~n)return;t.splice(t.indexOf(e),1)});return e},_rewatchModels:function(){this._modelsJanitor.dispose();for(var e=this.length;e--;){this._watchModel(this.at(e))}},_compareIds:function(e,t){if(typeof t==="object"){return e.data[this.idProperty]===t[this.idProperty]}else{return e.value===t}},toJSON:function(){return tis.serialize()}})},{"./model":90,bindable:100,janitorjs:112,lodash:115}],90:[function(e,t,n){var r=e("bindable"),i=e("lodash");function o(e,t){r.Object.call(this,this);this.application=t;this.bind("data",i.bind(this._onData,this));this.setProperties(e||{});t.models.decorate(this)}t.exports=r.Object.extend(o,{deserialize:function(e){return e},serialize:function(){var e={},t=this.data;for(var n in t){e[n]=this[n]}return e},toJSON:function(){return this.serialize()},_onData:function(e){var e=this.deserialize(e);if(typeof e==="object"){this.setProperties(e)}else{this.set("value",e)}}})},{bindable:100,lodash:115}],91:[function(e,t,n){var r=e("./utils/memoize"),i=e("lodash");t.exports={getOptions:function(e){return e.persist},decorate:function(e){var t=e.persist;if(typeof t==="function"){t=t(e)}e.save=function(n){if(!n)n=function(){};function r(t){if(t)return n(t);e.emit("save");n(null,e)}if(this.data){if(t.update){t.update.call(this,r)}else{r(new Error("cannot update model"))}}else{if(t.create){t.create.call(this,function(t,n){if(t)return r(t);e.set("data",n);r(t,n)})}else{r(new Error("cannot create model"))}}};e.remove=function(n){if(!n)n=function(){};if(!this.data)return n(new Error("cannot remove model without data"));if(!t.del)return n(new Error("cannot remove model"));t.del.call(this,function(t){if(t)return n(t);e.emit("remove");e.dispose();n(null,e)})};e.reload=function(n){if(!n)n=function(){};if(!t.read)return n(new Error("cannot load model"));t.read.call(this,function(t,r){if(t){n(t);return e.load.clear()}e.set("data",r);n(null,e)})};e.load=r(i.bind(e.reload,e))}}},{"./utils/memoize":93,lodash:115}],92:[function(e,t,n){var r=e("frills"),i=e("./virtuals"),o=e("./crud"),s=e("bindable-decor-bindings");t.exports=function(e){var t=r();t.use(i,o,s());e.models.decorator=function(e){t.decorator(e)};e.models.decorate=function(e,n){t.decorate(e,n)}}},{"./crud":91,"./virtuals":94,"bindable-decor-bindings":96,frills:110}],93:[function(e,t,n){var r=e("bindable");t.exports=function(e,t){if(!t)t={};var n=new r.EventEmitter,i=null,o=false;var s=function(){var r=Array.prototype.slice.call(arguments,0);var a=r.pop()||function(){};if(i){return a.apply(this,i)}n.once("done",a);if(o)return;o=true;r.push(function(){var e=Array.prototype.slice.call(arguments,0);o=false;if(t.store!==false){i=e}n.emit.apply(n,["done"].concat(e));if(t.maxAge){setTimeout(s.clear,t.maxAge)}});e.apply(this,r)};s.clear=function(){i=void 0};return s}},{bindable:100}],94:[function(e,t,n){t.exports={getOptions:function(e){return e.virtuals},decorate:function(e,t){var n={},r=false;e.on("watching",function(i){var o=i[0];if(e.has(o))return;var s=this;if(t[o]){if(n[o])return;n[o]=true;t[o].call(e,function(t,r){n[o]=false;if(t)return;e.set(o,r)})}else{if(r||!e.load)return;r=true;e.load(function(){r=false})}})}}},{}],95:[function(e,t,n){var r=e("mojo-registered-classes"),i=e("./decor"),o=e("./base/model"),s=e("./base/collection");t.exports=function(e){e.models=new r(e);e.use(i)};t.exports.Base=o;t.exports.Collection=s},{"./base/collection":89,"./base/model":90,"./decor":92,"mojo-registered-classes":116}],96:[function(e,t,n){(function(){var n,r,i=function(e,t){return function(){return e.apply(t,arguments)}};r=e("disposable");n=function(){function e(e,t){this.target=e;this.dispose=i(this.dispose,this);this.bind=i(this.bind,this);this.bindings=typeof t==="object"?t:void 0;this._disposable=r.create();this.target.once("dispose",this.dispose)}e.prototype.bind=function(){if(this.bindings){return this._setupExplicitBindings()}};e.prototype.dispose=function(){return this._disposable.dispose()};e.prototype._setupExplicitBindings=function(){var e,t,n;e=this.bindings;n=[];for(t in e){n.push(this._setupBinding(t,e[t]))}return n};e.prototype._setupBinding=function(e,t){var n,r,i=this;r={};if(typeof t==="function"){n=t;t=function(){return n.apply(i.target,arguments)}}if(t.to){r=t}else{r={to:t}}return this._disposable.add(this.target.bind(e,r).now())};return e}();t.exports=function(e){return{priority:"load",getOptions:function(e){return e.bindings},decorate:function(t,r){var i;i=new n(t,r);if(e){return t.once(e,i.bind)}else{return i.bind()}}}}}).call(this)},{disposable:97}],97:[function(e,t,n){(function(){var e={};e.create=function(){var t={},n=[];t.add=function(r){if(arguments.length>1){var i=e.create();for(var o=arguments.length;o--;){i.add(arguments[o])}return t.add(i)}if(typeof r=="function"){var s=r,a=Array.prototype.slice.call(arguments,0);a.shift();r={dispose:function(){s.apply(null,a)}}}else if(!r||!r.dispose){return false}n.push(r);return{dispose:function(){var e=n.indexOf(r);if(e>-1)n.splice(e,1)}}};t.addTimeout=function(e){return t.add(function(){clearTimeout(e)})};t.addInterval=function(e){return t.add(function(){clearInterval(e)})};t.addBinding=function(e){t.add(function(){e.unbind()})};t.dispose=function(){for(var e=n.length;e--;){n[e].dispose()}n=[]};return t};if(typeof t!="undefined"){t.exports=e}else if(typeof window!="undefined"){window.disposable=e}})()},{}],98:[function(e,t,n){t.exports=e(23)},{"../object":101,"../utils/computed":104,sift:435}],99:[function(e,t,n){t.exports=e(24)},{protoclass:106}],100:[function(e,t,n){t.exports=e(25)},{"./collection":98,"./core/eventEmitter":99,"./object":101,"./utils/computed":104,"./utils/options":105}],101:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":99,"./watchProperty":103,protoclass:106}],102:[function(e,t,n){t.exports=e(27)},{toarray:107,underscore:108}],103:[function(e,t,n){t.exports=e(28)},{"../utils/options":105,"./transform":102,underscore:108}],104:[function(e,t,n){t.exports=e(29)},{toarray:107}],105:[function(e,t,n){t.exports=e(30)},{}],106:[function(e,t,n){t.exports=e(31)},{}],107:[function(e,t,n){t.exports=e(33)},{}],108:[function(e,t,n){t.exports=e(34)},{}],109:[function(e,t,n){var r=e("protoclass");function i(){this._priorities={};this._decorators=[]}t.exports=r(i,{priority:function(e,t){this._priorities[e]=t;return this},use:function(){var e=this._priorities;this._decorators=this._decorators.concat(Array.prototype.slice.call(arguments,0)).sort(function(t,n){return e[t.priority]>e[n.priority]?-1:1})},decorate:function(e,t){if(!t){t=e.constructor.prototype;if(t===Object.prototype){t=e}}if(!t.__decorators||t.__decorOwner!=t){this._setDecorators(t)}for(var n=t.__decorators.length;n--;){var r=t.__decorators[n];r.decorator.decorate(e,r.options)}},_setDecorators:function(e){var t=e,n,r,i,o=e.__decorators=[],s={};e.__decorOwner=e;while(t){for(var a=this._decorators.length;a--;){n=this._decorators[a];if(s[a]&&n.multi===false)continue;if((i=n.getOptions(t))!=null){o.push({decorator:n,options:i});s[a]=true}}t=t.constructor.__super__}}})},{protoclass:111}],110:[function(e,t,n){var r=e("./decorator");t.exports=function(){return new r}},{"./decorator":109}],111:[function(e,t,n){t.exports=e(31)},{}],112:[function(e,t,n){var r=e("protoclass"),i=e("type-component");function o(){this._garbage=[]}r(o,{add:function(e){if(e.dispose){this._garbage.push(e)}else if(i(e)==="function"){this._garbage.push({dispose:e})}return this},remove:function(e){var t=this._garbage.indexOf(e);if(!~t)return;this._garbage.splice(t,1)},addTimeout:function(e){return this.add({dispose:function(){clearTimeout(e)}})},addInterval:function(e){return this.add({dispose:function(){clearInterval(e)}})},dispose:function(){for(var e=this._garbage.length;e--;){this._garbage[e].dispose()}this._garbage=[];return this}});t.exports=function(){return new o}},{protoclass:113,"type-component":114}],113:[function(e,t,n){t.exports=e(31)},{}],114:[function(e,t,n){t.exports=e(56)},{}],115:[function(e,t,n){(function(e){(function(){var r;var i=[],o=[];var s=0;var a=+new Date+"";var u=75;var c=40;var f=" 	\f"+"\n\r\u2028\u2029"+"";
var l=/\b__p \+= '';/g,p=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var v=/\w*$/;var m=/^\s*function[ \n\r\t]+\w/;var g=/<%=([\s\S]+?)%>/g;var y=RegExp("^["+f+"]*0+(?=.$)");var _=/($^)/;var b=/\bthis\b/;var w=/['\n\r\t\u2028\u2029\\]/g;var x=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"];var k=0;var E="[object Arguments]",O="[object Array]",j="[object Boolean]",S="[object Date]",A="[object Function]",C="[object Number]",T="[object Object]",N="[object RegExp]",q="[object String]";var I={};I[A]=false;I[E]=I[O]=I[j]=I[S]=I[C]=I[T]=I[N]=I[q]=true;var R={leading:false,maxWait:0,trailing:false};var B={configurable:false,enumerable:false,value:null,writable:false};var L={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};var D={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};var F=L[typeof window]&&window||this;var P=L[typeof n]&&n&&!n.nodeType&&n;var M=L[typeof t]&&t&&!t.nodeType&&t;var $=M&&M.exports===P&&P;var U=L[typeof e]&&e;if(U&&(U.global===U||U.window===U)){F=U}function z(e,t,n){var r=(n||0)-1,i=e?e.length:0;while(++r<i){if(e[r]===t){return r}}return-1}function V(e,t){var n=typeof t;e=e.cache;if(n=="boolean"||t==null){return e[t]?0:-1}if(n!="number"&&n!="string"){n="object"}var r=n=="number"?t:a+t;e=(e=e[n])&&e[r];return n=="object"?e&&z(e,t)>-1?0:-1:e?0:-1}function J(e){var t=this.cache,n=typeof e;if(n=="boolean"||e==null){t[e]=true}else{if(n!="number"&&n!="string"){n="object"}var r=n=="number"?e:a+e,i=t[n]||(t[n]={});if(n=="object"){(i[r]||(i[r]=[])).push(e)}else{i[r]=true}}}function W(e){return e.charCodeAt(0)}function H(e,t){var n=e.criteria,r=t.criteria,i=-1,o=n.length;while(++i<o){var s=n[i],a=r[i];if(s!==a){if(s>a||typeof s=="undefined"){return 1}if(s<a||typeof a=="undefined"){return-1}}}return e.index-t.index}function K(e){var t=-1,n=e.length,r=e[0],i=e[n/2|0],o=e[n-1];if(r&&typeof r=="object"&&i&&typeof i=="object"&&o&&typeof o=="object"){return false}var s=X();s["false"]=s["null"]=s["true"]=s["undefined"]=false;var a=X();a.array=e;a.cache=s;a.push=J;while(++t<n){a.push(e[t])}return a}function G(e){return"\\"+D[e]}function Q(){return i.pop()||[]}function X(){return o.pop()||{array:null,cache:null,criteria:null,"false":false,index:0,"null":false,number:null,object:null,push:null,string:null,"true":false,undefined:false,value:null}}function Y(e){e.length=0;if(i.length<c){i.push(e)}}function Z(e){var t=e.cache;if(t){Z(t)}e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null;if(o.length<c){o.push(e)}}function et(e,t,n){t||(t=0);if(typeof n=="undefined"){n=e?e.length:0}var r=-1,i=n-t||0,o=Array(i<0?0:i);while(++r<i){o[r]=e[t+r]}return o}function tt(e){e=e?nt.defaults(F.Object(),e,nt.pick(F,x)):F;var t=e.Array,n=e.Boolean,i=e.Date,o=e.Function,c=e.Math,D=e.Number,P=e.Object,M=e.RegExp,$=e.String,U=e.TypeError;var J=[];var rt=P.prototype;var it=e._;var ot=rt.toString;var st=M("^"+$(ot).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");var at=c.ceil,ut=e.clearTimeout,ct=c.floor,ft=o.prototype.toString,lt=Wt(lt=P.getPrototypeOf)&&lt,pt=rt.hasOwnProperty,ht=J.push,dt=e.setTimeout,vt=J.splice,mt=J.unshift;var gt=function(){try{var e={},t=Wt(t=P.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}();var yt=Wt(yt=P.create)&&yt,_t=Wt(_t=t.isArray)&&_t,bt=e.isFinite,wt=e.isNaN,xt=Wt(xt=P.keys)&&xt,kt=c.max,Et=c.min,Ot=e.parseInt,jt=c.random;var St={};St[O]=t;St[j]=n;St[S]=i;St[A]=o;St[T]=P;St[C]=D;St[N]=M;St[q]=$;function At(e){return e&&typeof e=="object"&&!Xt(e)&&pt.call(e,"__wrapped__")?e:new Ct(e)}function Ct(e,t){this.__chain__=!!t;this.__wrapped__=e}Ct.prototype=At.prototype;var Tt=At.support={};Tt.funcDecomp=!Wt(e.WinRTError)&&b.test(tt);Tt.funcNames=typeof o.name=="string";At.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:g,variable:"",imports:{_:At}};function Nt(e){var t=e[0],n=e[2],r=e[4];function i(){if(n){var e=et(n);ht.apply(e,arguments)}if(this instanceof i){var o=It(t.prototype),s=t.apply(o,e||arguments);return jn(s)?s:o}return t.apply(r,e||arguments)}Ht(i,e);return i}function qt(e,t,n,r,i){if(n){var o=n(e);if(typeof o!="undefined"){return o}}var s=jn(e);if(s){var a=ot.call(e);if(!I[a]){return e}var u=St[a];switch(a){case j:case S:return new u(+e);case C:case q:return new u(e);case N:o=u(e.source,v.exec(e));o.lastIndex=e.lastIndex;return o}}else{return e}var c=Xt(e);if(t){var f=!r;r||(r=Q());i||(i=Q());var l=r.length;while(l--){if(r[l]==e){return i[l]}}o=c?u(e.length):{}}else{o=c?et(e):on({},e)}if(c){if(pt.call(e,"index")){o.index=e.index}if(pt.call(e,"input")){o.input=e.input}}if(!t){return o}r.push(e);i.push(o);(c?Kn:dn)(e,function(e,s){o[s]=qt(e,t,n,r,i)});if(f){Y(r);Y(i)}return o}function It(e,t){return jn(e)?yt(e):{}}if(!yt){It=function(){function t(){}return function(n){if(jn(n)){t.prototype=n;var r=new t;t.prototype=null}return r||e.Object()}}()}function Rt(e,t,n){if(typeof e!="function"){return Zr}if(typeof t=="undefined"||!("prototype"in e)){return e}var r=e.__bindData__;if(typeof r=="undefined"){if(Tt.funcNames){r=!e.name}r=r||!Tt.funcDecomp;if(!r){var i=ft.call(e);if(!Tt.funcNames){r=!m.test(i)}if(!r){r=b.test(i);Ht(e,r)}}}if(r===false||r!==true&&r[1]&1){return e}switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return Lr(e,t)}function Bt(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5];var a=n&1,u=n&2,c=n&4,f=n&8,l=t;function p(){var e=a?o:this;if(r){var h=et(r);ht.apply(h,arguments)}if(i||c){h||(h=et(arguments));if(i){ht.apply(h,i)}if(c&&h.length<s){n|=16&~32;return Bt([t,f?n:n&~3,h,null,o,s])}}h||(h=arguments);if(u){t=e[l]}if(this instanceof p){e=It(t.prototype);var d=t.apply(e,h);return jn(d)?d:e}return t.apply(e,h)}Ht(p,e);return p}function Lt(e,t){var n=-1,r=Jt(),i=e?e.length:0,o=i>=u&&r===z,s=[];if(o){var a=K(t);if(a){r=V;t=a}else{o=false}}while(++n<i){var c=e[n];if(r(t,c)<0){s.push(c)}}if(o){Z(t)}return s}function Dt(e,t,n,r){var i=(r||0)-1,o=e?e.length:0,s=[];while(++i<o){var a=e[i];if(a&&typeof a=="object"&&typeof a.length=="number"&&(Xt(a)||Qt(a))){if(!t){a=Dt(a,t,n)}var u=-1,c=a.length,f=s.length;s.length+=c;while(++u<c){s[f++]=a[u]}}else if(!n){s.push(a)}}return s}function Ft(e,t,n,r,i,o){if(n){var s=n(e,t);if(typeof s!="undefined"){return!!s}}if(e===t){return e!==0||1/e==1/t}var a=typeof e,u=typeof t;if(e===e&&!(e&&L[a])&&!(t&&L[u])){return false}if(e==null||t==null){return e===t}var c=ot.call(e),f=ot.call(t);if(c==E){c=T}if(f==E){f=T}if(c!=f){return false}switch(c){case j:case S:return+e==+t;case C:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case N:case q:return e==$(t)}var l=c==O;if(!l){var p=pt.call(e,"__wrapped__"),h=pt.call(t,"__wrapped__");if(p||h){return Ft(p?e.__wrapped__:e,h?t.__wrapped__:t,n,r,i,o)}if(c!=T){return false}var d=e.constructor,v=t.constructor;if(d!=v&&!(On(d)&&d instanceof d&&On(v)&&v instanceof v)&&("constructor"in e&&"constructor"in t)){return false}}var m=!i;i||(i=Q());o||(o=Q());var g=i.length;while(g--){if(i[g]==e){return o[g]==t}}var y=0;s=true;i.push(e);o.push(t);if(l){g=e.length;y=t.length;s=y==g;if(s||r){while(y--){var _=g,b=t[y];if(r){while(_--){if(s=Ft(e[_],b,n,r,i,o)){break}}}else if(!(s=Ft(e[y],b,n,r,i,o))){break}}}}else{pn(t,function(t,a,u){if(pt.call(u,a)){y++;return s=pt.call(e,a)&&Ft(e[a],t,n,r,i,o)}});if(s&&!r){pn(e,function(e,t,n){if(pt.call(n,t)){return s=--y>-1}})}}i.pop();o.pop();if(m){Y(i);Y(o)}return s}function Pt(e,t,n,r,i){(Xt(t)?Kn:dn)(t,function(t,o){var s,a,u=t,c=e[o];if(t&&((a=Xt(t))||Tn(t))){var f=r.length;while(f--){if(s=r[f]==t){c=i[f];break}}if(!s){var l;if(n){u=n(c,t);if(l=typeof u!="undefined"){c=u}}if(!l){c=a?Xt(c)?c:[]:Tn(c)?c:{}}r.push(t);i.push(c);if(!l){Pt(c,t,n,r,i)}}}else{if(n){u=n(c,t);if(typeof u=="undefined"){u=t}}if(typeof u!="undefined"){c=u}}e[o]=c})}function Mt(e,t){return e+ct(jt()*(t-e+1))}function $t(e,t,n){var r=-1,i=Jt(),o=e?e.length:0,s=[];var a=!t&&o>=u&&i===z,c=n||a?Q():s;if(a){var f=K(c);i=V;c=f}while(++r<o){var l=e[r],p=n?n(l,r,e):l;if(t?!r||c[c.length-1]!==p:i(c,p)<0){if(n||a){c.push(p)}s.push(l)}}if(a){Y(c.array);Z(c)}else if(n){Y(c)}return s}function Ut(e){return function(t,n,r){var i={};n=At.createCallback(n,r,3);var o=-1,s=t?t.length:0;if(typeof s=="number"){while(++o<s){var a=t[o];e(i,a,n(a,o,t),t)}}else{dn(t,function(t,r,o){e(i,t,n(t,r,o),o)})}return i}}function zt(e,t,n,r,i,o){var s=t&1,a=t&2,u=t&4,c=t&8,f=t&16,l=t&32;if(!a&&!On(e)){throw new U}if(f&&!n.length){t&=~16;f=n=false}if(l&&!r.length){t&=~32;l=r=false}var p=e&&e.__bindData__;if(p&&p!==true){p=et(p);if(p[2]){p[2]=et(p[2])}if(p[3]){p[3]=et(p[3])}if(s&&!(p[1]&1)){p[4]=i}if(!s&&p[1]&1){t|=8}if(u&&!(p[1]&4)){p[5]=o}if(f){ht.apply(p[2]||(p[2]=[]),n)}if(l){mt.apply(p[3]||(p[3]=[]),r)}p[1]|=t;return zt.apply(null,p)}var h=t==1||t===17?Nt:Bt;return h([e,t,n,r,i,o])}function Vt(e){return en[e]}function Jt(){var e=(e=At.indexOf)===_r?z:e;return e}function Wt(e){return typeof e=="function"&&st.test(e)}var Ht=!gt?ni:function(e,t){B.value=t;gt(e,"__bindData__",B)};function Kt(e){var t,n;if(!(e&&ot.call(e)==T)||(t=e.constructor,On(t)&&!(t instanceof t))){return false}pn(e,function(e,t){n=t});return typeof n=="undefined"||pt.call(e,n)}function Gt(e){return tn[e]}function Qt(e){return e&&typeof e=="object"&&typeof e.length=="number"&&ot.call(e)==E||false}var Xt=_t||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&ot.call(e)==O||false};var Yt=function(e){var t,n=e,r=[];if(!n)return r;if(!L[typeof e])return r;for(t in n){if(pt.call(n,t)){r.push(t)}}return r};var Zt=!xt?Yt:function(e){if(!jn(e)){return[]}return xt(e)};var en={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var tn=yn(en);var nn=M("("+Zt(tn).join("|")+")","g"),rn=M("["+Zt(en).join("")+"]","g");var on=function(e,t,n){var r,i=e,o=i;if(!i)return o;var s=arguments,a=0,u=typeof n=="number"?2:s.length;if(u>3&&typeof s[u-2]=="function"){var c=Rt(s[--u-1],s[u--],2)}else if(u>2&&typeof s[u-1]=="function"){c=s[--u]}while(++a<u){i=s[a];if(i&&L[typeof i]){var f=-1,l=L[typeof i]&&Zt(i),p=l?l.length:0;while(++f<p){r=l[f];o[r]=c?c(o[r],i[r]):i[r]}}}return o};function sn(e,t,n,r){if(typeof t!="boolean"&&t!=null){r=n;n=t;t=false}return qt(e,t,typeof n=="function"&&Rt(n,r,1))}function an(e,t,n){return qt(e,true,typeof t=="function"&&Rt(t,n,1))}function un(e,t){var n=It(e);return t?on(n,t):n}var cn=function(e,t,n){var r,i=e,o=i;if(!i)return o;var s=arguments,a=0,u=typeof n=="number"?2:s.length;while(++a<u){i=s[a];if(i&&L[typeof i]){var c=-1,f=L[typeof i]&&Zt(i),l=f?f.length:0;while(++c<l){r=f[c];if(typeof o[r]=="undefined")o[r]=i[r]}}}return o};function fn(e,t,n){var r;t=At.createCallback(t,n,3);dn(e,function(e,n,i){if(t(e,n,i)){r=n;return false}});return r}function ln(e,t,n){var r;t=At.createCallback(t,n,3);vn(e,function(e,n,i){if(t(e,n,i)){r=n;return false}});return r}var pn=function(e,t,n){var r,i=e,o=i;if(!i)return o;if(!L[typeof i])return o;t=t&&typeof n=="undefined"?t:Rt(t,n,3);for(r in i){if(t(i[r],r,e)===false)return o}return o};function hn(e,t,n){var r=[];pn(e,function(e,t){r.push(t,e)});var i=r.length;t=Rt(t,n,3);while(i--){if(t(r[i--],r[i],e)===false){break}}return e}var dn=function(e,t,n){var r,i=e,o=i;if(!i)return o;if(!L[typeof i])return o;t=t&&typeof n=="undefined"?t:Rt(t,n,3);var s=-1,a=L[typeof i]&&Zt(i),u=a?a.length:0;while(++s<u){r=a[s];if(t(i[r],r,e)===false)return o}return o};function vn(e,t,n){var r=Zt(e),i=r.length;t=Rt(t,n,3);while(i--){var o=r[i];if(t(e[o],o,e)===false){break}}return e}function mn(e){var t=[];pn(e,function(e,n){if(On(e)){t.push(n)}});return t.sort()}function gn(e,t){return e?pt.call(e,t):false}function yn(e){var t=-1,n=Zt(e),r=n.length,i={};while(++t<r){var o=n[t];i[e[o]]=o}return i}function _n(e){return e===true||e===false||e&&typeof e=="object"&&ot.call(e)==j||false}function bn(e){return e&&typeof e=="object"&&ot.call(e)==S||false}function wn(e){return e&&e.nodeType===1||false}function xn(e){var t=true;if(!e){return t}var n=ot.call(e),r=e.length;if(n==O||n==q||n==E||n==T&&typeof r=="number"&&On(e.splice)){return!r}dn(e,function(){return t=false});return t}function kn(e,t,n,r){return Ft(e,t,typeof n=="function"&&Rt(n,r,2))}function En(e){return bt(e)&&!wt(parseFloat(e))}function On(e){return typeof e=="function"}function jn(e){return!!(e&&L[typeof e])}function Sn(e){return Cn(e)&&e!=+e}function An(e){return e===null}function Cn(e){return typeof e=="number"||e&&typeof e=="object"&&ot.call(e)==C||false}var Tn=!lt?Kt:function(e){if(!(e&&ot.call(e)==T)){return false}var t=e.valueOf,n=Wt(t)&&(n=lt(t))&&lt(n);return n?e==n||lt(e)==n:Kt(e)};function Nn(e){return e&&typeof e=="object"&&ot.call(e)==N||false}function qn(e){return typeof e=="string"||e&&typeof e=="object"&&ot.call(e)==q||false}function In(e){return typeof e=="undefined"}function Rn(e,t,n){var r={};t=At.createCallback(t,n,3);dn(e,function(e,n,i){r[n]=t(e,n,i)});return r}function Bn(e){var t=arguments,n=2;if(!jn(e)){return e}if(typeof t[2]!="number"){n=t.length}if(n>3&&typeof t[n-2]=="function"){var r=Rt(t[--n-1],t[n--],2)}else if(n>2&&typeof t[n-1]=="function"){r=t[--n]}var i=et(arguments,1,n),o=-1,s=Q(),a=Q();while(++o<n){Pt(e,i[o],r,s,a)}Y(s);Y(a);return e}function Ln(e,t,n){var r={};if(typeof t!="function"){var i=[];pn(e,function(e,t){i.push(t)});i=Lt(i,Dt(arguments,true,false,1));var o=-1,s=i.length;while(++o<s){var a=i[o];r[a]=e[a]}}else{t=At.createCallback(t,n,3);pn(e,function(e,n,i){if(!t(e,n,i)){r[n]=e}})}return r}function Dn(e){var n=-1,r=Zt(e),i=r.length,o=t(i);while(++n<i){var s=r[n];o[n]=[s,e[s]]}return o}function Fn(e,t,n){var r={};if(typeof t!="function"){var i=-1,o=Dt(arguments,true,false,1),s=jn(e)?o.length:0;while(++i<s){var a=o[i];if(a in e){r[a]=e[a]}}}else{t=At.createCallback(t,n,3);pn(e,function(e,n,i){if(t(e,n,i)){r[n]=e}})}return r}function Pn(e,t,n,r){var i=Xt(e);if(n==null){if(i){n=[]}else{var o=e&&e.constructor,s=o&&o.prototype;n=It(s)}}if(t){t=At.createCallback(t,r,4);(i?Kn:dn)(e,function(e,r,i){return t(n,e,r,i)})}return n}function Mn(e){var n=-1,r=Zt(e),i=r.length,o=t(i);while(++n<i){o[n]=e[r[n]]}return o}function $n(e){var n=arguments,r=-1,i=Dt(n,true,false,1),o=n[2]&&n[2][n[1]]===e?1:i.length,s=t(o);while(++r<o){s[r]=e[i[r]]}return s}function Un(e,t,n){var r=-1,i=Jt(),o=e?e.length:0,s=false;n=(n<0?kt(0,o+n):n)||0;if(Xt(e)){s=i(e,t,n)>-1}else if(typeof o=="number"){s=(qn(e)?e.indexOf(t,n):i(e,t,n))>-1}else{dn(e,function(e){if(++r>=n){return!(s=e===t)}})}return s}var zn=Ut(function(e,t,n){pt.call(e,n)?e[n]++:e[n]=1});function Vn(e,t,n){var r=true;t=At.createCallback(t,n,3);var i=-1,o=e?e.length:0;if(typeof o=="number"){while(++i<o){if(!(r=!!t(e[i],i,e))){break}}}else{dn(e,function(e,n,i){return r=!!t(e,n,i)})}return r}function Jn(e,t,n){var r=[];t=At.createCallback(t,n,3);var i=-1,o=e?e.length:0;if(typeof o=="number"){while(++i<o){var s=e[i];if(t(s,i,e)){r.push(s)}}}else{dn(e,function(e,n,i){if(t(e,n,i)){r.push(e)}})}return r}function Wn(e,t,n){t=At.createCallback(t,n,3);var r=-1,i=e?e.length:0;if(typeof i=="number"){while(++r<i){var o=e[r];if(t(o,r,e)){return o}}}else{var s;dn(e,function(e,n,r){if(t(e,n,r)){s=e;return false}});return s}}function Hn(e,t,n){var r;t=At.createCallback(t,n,3);Gn(e,function(e,n,i){if(t(e,n,i)){r=e;return false}});return r}function Kn(e,t,n){var r=-1,i=e?e.length:0;t=t&&typeof n=="undefined"?t:Rt(t,n,3);if(typeof i=="number"){while(++r<i){if(t(e[r],r,e)===false){break}}}else{dn(e,t)}return e}function Gn(e,t,n){var r=e?e.length:0;t=t&&typeof n=="undefined"?t:Rt(t,n,3);if(typeof r=="number"){while(r--){if(t(e[r],r,e)===false){break}}}else{var i=Zt(e);r=i.length;dn(e,function(e,n,o){n=i?i[--r]:--r;return t(o[n],n,o)})}return e}var Qn=Ut(function(e,t,n){(pt.call(e,n)?e[n]:e[n]=[]).push(t)});var Xn=Ut(function(e,t,n){e[n]=t});function Yn(e,n){var r=et(arguments,2),i=-1,o=typeof n=="function",s=e?e.length:0,a=t(typeof s=="number"?s:0);Kn(e,function(e){a[++i]=(o?n:e[n]).apply(e,r)});return a}function Zn(e,n,r){var i=-1,o=e?e.length:0;n=At.createCallback(n,r,3);if(typeof o=="number"){var s=t(o);while(++i<o){s[i]=n(e[i],i,e)}}else{s=[];dn(e,function(e,t,r){s[++i]=n(e,t,r)})}return s}function er(e,t,n){var r=-Infinity,i=r;if(typeof t!="function"&&n&&n[t]===e){t=null}if(t==null&&Xt(e)){var o=-1,s=e.length;while(++o<s){var a=e[o];if(a>i){i=a}}}else{t=t==null&&qn(e)?W:At.createCallback(t,n,3);Kn(e,function(e,n,o){var s=t(e,n,o);if(s>r){r=s;i=e}})}return i}function tr(e,t,n){var r=Infinity,i=r;if(typeof t!="function"&&n&&n[t]===e){t=null}if(t==null&&Xt(e)){var o=-1,s=e.length;while(++o<s){var a=e[o];if(a<i){i=a}}}else{t=t==null&&qn(e)?W:At.createCallback(t,n,3);Kn(e,function(e,n,o){var s=t(e,n,o);if(s<r){r=s;i=e}})}return i}var nr=Zn;function rr(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=At.createCallback(t,r,4);var o=-1,s=e.length;if(typeof s=="number"){if(i){n=e[++o]}while(++o<s){n=t(n,e[o],o,e)}}else{dn(e,function(e,r,o){n=i?(i=false,e):t(n,e,r,o)})}return n}function ir(e,t,n,r){var i=arguments.length<3;t=At.createCallback(t,r,4);Gn(e,function(e,r,o){n=i?(i=false,e):t(n,e,r,o)});return n}function or(e,t,n){t=At.createCallback(t,n,3);return Jn(e,function(e,n,r){return!t(e,n,r)})}function sr(e,t,n){if(e&&typeof e.length!="number"){e=Mn(e)}if(t==null||n){return e?e[Mt(0,e.length-1)]:r}var i=ar(e);i.length=Et(kt(0,t),i.length);return i}function ar(e){var n=-1,r=e?e.length:0,i=t(typeof r=="number"?r:0);Kn(e,function(e){var t=Mt(0,++n);i[n]=i[t];i[t]=e});return i}function ur(e){var t=e?e.length:0;return typeof t=="number"?t:Zt(e).length}function cr(e,t,n){var r;t=At.createCallback(t,n,3);var i=-1,o=e?e.length:0;if(typeof o=="number"){while(++i<o){if(r=t(e[i],i,e)){break}}}else{dn(e,function(e,n,i){return!(r=t(e,n,i))})}return!!r}function fr(e,n,r){var i=-1,o=Xt(n),s=e?e.length:0,a=t(typeof s=="number"?s:0);if(!o){n=At.createCallback(n,r,3)}Kn(e,function(e,t,r){var s=a[++i]=X();if(o){s.criteria=Zn(n,function(t){return e[t]})}else{(s.criteria=Q())[0]=n(e,t,r)}s.index=i;s.value=e});s=a.length;a.sort(H);while(s--){var u=a[s];a[s]=u.value;if(!o){Y(u.criteria)}Z(u)}return a}function lr(e){if(e&&typeof e.length=="number"){return et(e)}return Mn(e)}var pr=Jn;function hr(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];if(i){r.push(i)}}return r}function dr(e){return Lt(e,Dt(arguments,true,true,1))}function vr(e,t,n){var r=-1,i=e?e.length:0;t=At.createCallback(t,n,3);while(++r<i){if(t(e[r],r,e)){return r}}return-1}function mr(e,t,n){var r=e?e.length:0;t=At.createCallback(t,n,3);while(r--){if(t(e[r],r,e)){return r}}return-1}function gr(e,t,n){var i=0,o=e?e.length:0;if(typeof t!="number"&&t!=null){var s=-1;t=At.createCallback(t,n,3);while(++s<o&&t(e[s],s,e)){i++}}else{i=t;if(i==null||n){return e?e[0]:r}}return et(e,0,Et(kt(0,i),o))}function yr(e,t,n,r){if(typeof t!="boolean"&&t!=null){r=n;n=typeof t!="function"&&r&&r[t]===e?null:t;t=false}if(n!=null){e=Zn(e,n,r)}return Dt(e,t)}function _r(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=n<0?kt(0,r+n):n||0}else if(n){var i=Ar(e,t);return e[i]===t?i:-1}return z(e,t,n)}function br(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&t!=null){var o=i;t=At.createCallback(t,n,3);while(o--&&t(e[o],o,e)){r++}}else{r=t==null||n?1:t||r}return et(e,0,Et(kt(0,i-r),i))}function wr(){var e=[],t=-1,n=arguments.length,r=Q(),i=Jt(),o=i===z,s=Q();while(++t<n){var a=arguments[t];if(Xt(a)||Qt(a)){e.push(a);r.push(o&&a.length>=u&&K(t?e[t]:s))}}var c=e[0],f=-1,l=c?c.length:0,p=[];e:while(++f<l){var h=r[0];a=c[f];if((h?V(h,a):i(s,a))<0){t=n;(h||s).push(a);while(--t){h=r[t];if((h?V(h,a):i(e[t],a))<0){continue e}}p.push(a)}}while(n--){h=r[n];if(h){Z(h)}}Y(r);Y(s);return p}function xr(e,t,n){var i=0,o=e?e.length:0;if(typeof t!="number"&&t!=null){var s=o;t=At.createCallback(t,n,3);while(s--&&t(e[s],s,e)){i++}}else{i=t;if(i==null||n){return e?e[o-1]:r}}return et(e,kt(0,o-i))}function kr(e,t,n){var r=e?e.length:0;if(typeof n=="number"){r=(n<0?kt(0,r+n):Et(n,r-1))+1}while(r--){if(e[r]===t){return r}}return-1}function Er(e){var t=arguments,n=0,r=t.length,i=e?e.length:0;while(++n<r){var o=-1,s=t[n];while(++o<i){if(e[o]===s){vt.call(e,o--,1);i--}}}return e}function Or(e,n,r){e=+e||0;r=typeof r=="number"?r:+r||1;if(n==null){n=e;e=0}var i=-1,o=kt(0,at((n-e)/(r||1))),s=t(o);while(++i<o){s[i]=e;e+=r}return s}function jr(e,t,n){var r=-1,i=e?e.length:0,o=[];t=At.createCallback(t,n,3);while(++r<i){var s=e[r];if(t(s,r,e)){o.push(s);vt.call(e,r--,1);i--}}return o}function Sr(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,o=e?e.length:0;t=At.createCallback(t,n,3);while(++i<o&&t(e[i],i,e)){r++}}else{r=t==null||n?1:kt(0,t)}return et(e,r)}function Ar(e,t,n,r){var i=0,o=e?e.length:i;n=n?At.createCallback(n,r,1):Zr;t=n(t);while(i<o){var s=i+o>>>1;n(e[s])<t?i=s+1:o=s}return i}function Cr(){return $t(Dt(arguments,true,true))}function Tr(e,t,n,r){if(typeof t!="boolean"&&t!=null){r=n;n=typeof t!="function"&&r&&r[t]===e?null:t;t=false}if(n!=null){n=At.createCallback(n,r,3)}return $t(e,t,n)}function Nr(e){return Lt(e,et(arguments,1))}function qr(){var e=-1,t=arguments.length;while(++e<t){var n=arguments[e];if(Xt(n)||Qt(n)){var r=r?$t(Lt(r,n).concat(Lt(n,r))):n}}return r||[]}function Ir(){var e=arguments.length>1?arguments:arguments[0],n=-1,r=e?er(nr(e,"length")):0,i=t(r<0?0:r);while(++n<r){i[n]=nr(e,n)}return i}function Rr(e,t){var n=-1,r=e?e.length:0,i={};if(!t&&r&&!Xt(e[0])){t=[]}while(++n<r){var o=e[n];if(t){i[o]=t[n]}else if(o){i[o[0]]=o[1]}}return i}function Br(e,t){if(!On(t)){throw new U}return function(){if(--e<1){return t.apply(this,arguments)}}}function Lr(e,t){return arguments.length>2?zt(e,17,et(arguments,2),null,t):zt(e,1,null,null,t)}function Dr(e){var t=arguments.length>1?Dt(arguments,true,false,1):mn(e),n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=zt(e[i],1,null,null,e)}return e}function Fr(e,t){return arguments.length>2?zt(t,19,et(arguments,2),null,e):zt(t,3,null,null,e)}function Pr(){var e=arguments,t=e.length;while(t--){if(!On(e[t])){throw new U}}return function(){var t=arguments,n=e.length;while(n--){t=[e[n].apply(this,t)]}return t[0]}}function Mr(e,t){t=typeof t=="number"?t:+t||e.length;return zt(e,4,null,null,null,t)}function $r(e,t,n){var i,o,s,a,u,c,f,l=0,p=false,h=true;if(!On(e)){throw new U}t=kt(0,t)||0;if(n===true){var d=true;h=false}else if(jn(n)){d=n.leading;p="maxWait"in n&&(kt(t,n.maxWait)||0);h="trailing"in n?n.trailing:h}var v=function(){var n=t-(ri()-a);if(n<=0){if(o){ut(o)}var p=f;o=c=f=r;if(p){l=ri();s=e.apply(u,i);if(!c&&!o){i=u=null}}}else{c=dt(v,n)}};var m=function(){if(c){ut(c)}o=c=f=r;if(h||p!==t){l=ri();s=e.apply(u,i);if(!c&&!o){i=u=null}}};return function(){i=arguments;a=ri();u=this;f=h&&(c||!d);if(p===false){var n=d&&!c}else{if(!o&&!d){l=a}var r=p-(a-l),g=r<=0;if(g){if(o){o=ut(o)}l=a;s=e.apply(u,i)}else if(!o){o=dt(m,r)}}if(g&&c){c=ut(c)}else if(!c&&t!==p){c=dt(v,t)}if(n){g=true;s=e.apply(u,i)}if(g&&!c&&!o){i=u=null}return s}}function Ur(e){if(!On(e)){throw new U}var t=et(arguments,1);return dt(function(){e.apply(r,t)},1)}function zr(e,t){if(!On(e)){throw new U}var n=et(arguments,2);return dt(function(){e.apply(r,n)},t)}function Vr(e,t){if(!On(e)){throw new U}var n=function(){var r=n.cache,i=t?t.apply(this,arguments):a+arguments[0];return pt.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};n.cache={};return n}function Jr(e){var t,n;if(!On(e)){throw new U}return function(){if(t){return n}t=true;n=e.apply(this,arguments);e=null;return n}}function Wr(e){return zt(e,16,et(arguments,1))}function Hr(e){return zt(e,32,null,et(arguments,1))}function Kr(e,t,n){var r=true,i=true;if(!On(e)){throw new U}if(n===false){r=false}else if(jn(n)){r="leading"in n?n.leading:r;i="trailing"in n?n.trailing:i}R.leading=r;R.maxWait=t;R.trailing=i;return $r(e,t,R)}function Gr(e,t){return zt(t,16,[e])}function Qr(e){return function(){return e}}function Xr(e,t,n){var r=typeof e;if(e==null||r=="function"){return Rt(e,t,n)}if(r!="object"){return oi(e)}var i=Zt(e),o=i[0],s=e[o];if(i.length==1&&s===s&&!jn(s)){return function(e){var t=e[o];return s===t&&(s!==0||1/s==1/t)}}return function(t){var n=i.length,r=false;while(n--){if(!(r=Ft(t[i[n]],e[i[n]],null,true))){break}}return r}}function Yr(e){return e==null?"":$(e).replace(rn,Vt)}function Zr(e){return e}function ei(e,t,n){var r=true,i=t&&mn(t);if(!t||!n&&!i.length){if(n==null){n=t}o=Ct;t=e;e=At;i=mn(t)}if(n===false){r=false}else if(jn(n)&&"chain"in n){r=n.chain}var o=e,s=On(o);Kn(i,function(n){var i=e[n]=t[n];if(s){o.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,s=[n];ht.apply(s,arguments);var a=i.apply(e,s);if(r||t){if(n===a&&jn(a)){return this}a=new o(a);a.__chain__=t}return a}}})}function ti(){e._=it;return this}function ni(){}var ri=Wt(ri=i.now)&&ri||function(){return(new i).getTime()};var ii=Ot(f+"08")==8?Ot:function(e,t){return Ot(qn(e)?e.replace(y,""):e,t||0)};function oi(e){return function(t){return t[e]}}function si(e,t,n){var r=e==null,i=t==null;if(n==null){if(typeof e=="boolean"&&i){n=e;e=1}else if(!i&&typeof t=="boolean"){n=t;i=true}}if(r&&i){t=1}e=+e||0;if(i){t=e;e=0}else{t=+t||0}if(n||e%1||t%1){var o=jt();return Et(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return Mt(e,t)}function ai(e,t){if(e){var n=e[t];return On(n)?e[t]():n}}function ui(e,t,n){var i=At.templateSettings;e=$(e||"");n=cn({},n,i);var s=cn({},n.imports,i.imports),a=Zt(s),u=Mn(s);var c,f=0,v=n.interpolate||_,m="__p += '";var y=M((n.escape||_).source+"|"+v.source+"|"+(v===g?d:_).source+"|"+(n.evaluate||_).source+"|$","g");e.replace(y,function(t,n,r,i,o,s){r||(r=i);m+=e.slice(f,s).replace(w,G);if(n){m+="' +\n__e("+n+") +\n'"}if(o){c=true;m+="';\n"+o+";\n__p += '"}if(r){m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"}f=s+t.length;return t});m+="';\n";var b=n.variable,x=b;if(!x){b="obj";m="with ("+b+") {\n"+m+"\n}\n"}m=(c?m.replace(l,""):m).replace(p,"$1").replace(h,"$1;");m="function("+b+") {\n"+(x?"":b+" || ("+b+" = {});\n")+"var __t, __p = '', __e = _.escape"+(c?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var E="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+k++ +"]")+"\n*/";try{var O=o(a,"return "+m+E).apply(r,u)}catch(j){j.source=m;throw j}if(t){return O(t)}O.source=m;return O}function ci(e,n,r){e=(e=+e)>-1?e:0;var i=-1,o=t(e);n=Rt(n,r,1);while(++i<e){o[i]=n(i)}return o}function fi(e){return e==null?"":$(e).replace(nn,Gt)}function li(e){var t=++s;return $(e==null?"":e)+t}function pi(e){e=new Ct(e);e.__chain__=true;return e}function hi(e,t){t(e);return e}function di(){this.__chain__=true;return this}function vi(){return $(this.__wrapped__)}function mi(){return this.__wrapped__}At.after=Br;At.assign=on;At.at=$n;At.bind=Lr;At.bindAll=Dr;At.bindKey=Fr;At.chain=pi;At.compact=hr;At.compose=Pr;At.constant=Qr;At.countBy=zn;At.create=un;At.createCallback=Xr;At.curry=Mr;At.debounce=$r;At.defaults=cn;At.defer=Ur;At.delay=zr;At.difference=dr;At.filter=Jn;At.flatten=yr;At.forEach=Kn;At.forEachRight=Gn;At.forIn=pn;At.forInRight=hn;At.forOwn=dn;At.forOwnRight=vn;At.functions=mn;At.groupBy=Qn;At.indexBy=Xn;At.initial=br;At.intersection=wr;At.invert=yn;At.invoke=Yn;At.keys=Zt;At.map=Zn;At.mapValues=Rn;At.max=er;At.memoize=Vr;At.merge=Bn;At.min=tr;At.omit=Ln;At.once=Jr;At.pairs=Dn;At.partial=Wr;At.partialRight=Hr;At.pick=Fn;At.pluck=nr;At.property=oi;At.pull=Er;At.range=Or;At.reject=or;At.remove=jr;At.rest=Sr;At.shuffle=ar;At.sortBy=fr;At.tap=hi;At.throttle=Kr;At.times=ci;At.toArray=lr;At.transform=Pn;At.union=Cr;At.uniq=Tr;At.values=Mn;At.where=pr;At.without=Nr;At.wrap=Gr;At.xor=qr;At.zip=Ir;At.zipObject=Rr;At.collect=Zn;At.drop=Sr;At.each=Kn;At.eachRight=Gn;At.extend=on;At.methods=mn;At.object=Rr;At.select=Jn;At.tail=Sr;At.unique=Tr;At.unzip=Ir;ei(At);At.clone=sn;At.cloneDeep=an;At.contains=Un;At.escape=Yr;At.every=Vn;At.find=Wn;At.findIndex=vr;At.findKey=fn;At.findLast=Hn;At.findLastIndex=mr;At.findLastKey=ln;At.has=gn;At.identity=Zr;At.indexOf=_r;At.isArguments=Qt;At.isArray=Xt;At.isBoolean=_n;At.isDate=bn;At.isElement=wn;At.isEmpty=xn;At.isEqual=kn;At.isFinite=En;At.isFunction=On;At.isNaN=Sn;At.isNull=An;At.isNumber=Cn;At.isObject=jn;At.isPlainObject=Tn;At.isRegExp=Nn;At.isString=qn;At.isUndefined=In;At.lastIndexOf=kr;At.mixin=ei;At.noConflict=ti;At.noop=ni;At.now=ri;At.parseInt=ii;At.random=si;At.reduce=rr;At.reduceRight=ir;At.result=ai;At.runInContext=tt;At.size=ur;At.some=cr;At.sortedIndex=Ar;At.template=ui;At.unescape=fi;At.uniqueId=li;At.all=Vn;At.any=cr;At.detect=Wn;At.findWhere=Wn;At.foldl=rr;At.foldr=ir;At.include=Un;At.inject=rr;ei(function(){var e={};dn(At,function(t,n){if(!At.prototype[n]){e[n]=t}});return e}(),false);At.first=gr;At.last=xr;At.sample=sr;At.take=gr;At.head=gr;dn(At,function(e,t){var n=t!=="sample";if(!At.prototype[t]){At.prototype[t]=function(t,r){var i=this.__chain__,o=e(this.__wrapped__,t,r);return!i&&(t==null||r&&!(n&&typeof t=="function"))?o:new Ct(o,i)}}});At.VERSION="2.4.1";At.prototype.chain=di;At.prototype.toString=vi;At.prototype.value=mi;At.prototype.valueOf=mi;Kn(["join","pop","shift"],function(e){var t=J[e];At.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new Ct(n,e):n}});Kn(["push","reverse","sort","unshift"],function(e){var t=J[e];At.prototype[e]=function(){t.apply(this.__wrapped__,arguments);return this}});Kn(["concat","slice","splice"],function(e){var t=J[e];At.prototype[e]=function(){return new Ct(t.apply(this.__wrapped__,arguments),this.__chain__)}});return At}var nt=tt();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){F._=nt;define(function(){return nt})}else if(P&&M){if($){(M.exports=nt)._=nt}else{P._=nt}}else{F._=nt}}).call(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],116:[function(e,t,n){var r=e("bindable");function i(e){r.Object.call(this);this._classes={};this.application=e}t.exports=r.Object.extend(i,{register:function(e,t){if(typeof e==="object"){for(var n in e){this.register(n,e[n])}return}this._classes[e.substr(0,1).toLowerCase()+e.substr(1)]=t},create:function(e,t){var n=this._classes[e];if(!n)throw new Error("class '"+e+"' doesn't exist");return new n(t==null?{}:t,this.application)}})},{bindable:100}],117:[function(e,t,n){var r=e("protoclass"),i=e("paperclip");var o={multi:false,priority:"render",getOptions:function(e){return e.__isView},decorate:function(e,t){var n,r,o,s;e._define("paper");e.on("render",u);e.on("remove",c);e.on("warm",u);e.on("change:paper",f);if(e.paper)f(e.paper);var a;function u(){if(e.paper!==a){c(true);a=e.paper;if(typeof a!=="function"){throw new Error("paper template must be a function for view '"+e.path()+"'")}s=i.template(a,e.application)}r=true;if(!s)return;if(o){o.bind(e)}else{o=s.bind(e,e.section)}}function c(e){if(!o)return;if(e){o.removeAllNodes();o.unbind();o=undefined}else{o.unbind()}}function f(e){if(r){u()}}}};t.exports=function(e){if(e.views.__paperclip)return;e.views.__paperclip=true;e.views.decorator(o)}},{paperclip:118,protoclass:198}],118:[function(e,t,n){t.exports=e("./paper");if(typeof window!=="undefined"){window.paperclip=t.exports}},{"./paper":152}],119:[function(e,t,n){var r=e("bindable"),i=e("./index"),o=e("underscore"),s=e("protoclass");function a(e,t){this.clippedBuffer=e;this.clip=new i({script:t,application:e.application});this.clip.bind("value",o.bind(this._onUpdated,this))}s(a,{dispose:function(){this.clip.dispose()},update:function(){this.clip.reset(this.clippedBuffer._data);this.clip.update();this.value=this.clip.get("value")},_onUpdated:function(e){this.value=e;if(this.clippedBuffer._updating)return;this.clippedBuffer.update()}});function u(e,t){r.Object.call(this,this);var n=this;this.application=t;this.bindings=[];this._data={};this.buffer=e.map(function(e){var t;if(e.run){t=new a(n,e);n.bindings.push(t);return t}else{return{value:e}}})}r.Object.extend(u,{reset:function(e){this._data=e;
this.update();return this},dispose:function(){for(var e=this.bindings.length;e--;){this.bindings[e].dispose()}this.bindings=[]},update:function(){this._updating=true;for(var e=this.bindings.length;e--;){this.bindings[e].update()}this._updating=false;this.set("value",this._getText())},_getText:function(){var e="";for(var t=0,n=this.buffer.length;t<n;t++){var r=this.buffer[t].value;e+=r!=null?r:""}return e}});t.exports=u},{"./index":120,bindable:164,protoclass:198,underscore:197}],120:[function(e,t,n){(function(n){var r=e("protoclass"),i=e("dref"),o=e("bindable"),s=o.Object,a=e("./ref"),u=e("type-component"),c=e("underscore");function f(e,t,n){this.script=e;this.name=t;this.clip=n;this.application=n.application;this._bindings=[];this.refs=this.script.refs;this.run=this.script.run}r(f,{dispose:function(){for(var e=this._bindings.length;e--;){this._bindings[e].dispose()}this._bindings=[]},update:function(){if(this.__context)this.dispose();this.__context=this.clip.data;if(this.__context&&this.__watch)this._watchRefs();this._locked=true;var e=this.run.call(this);this._locked=false;if(e===this.value){return}this.clip.set(this.name,this.value=e)},bindTo:function(e,t){return new a(this,e,t)},get:function(e){return this.__context.get(e)},set:function(e,t){return this.__context.set(e,t)},call:function(e,t,n){var r;if(!e)return;if(e.__isBindable){r=e.get(t);e=e.context()}else{r=e[t]}if(r)return r.apply(e,n)},watch:function(){this.__watch=true;return this},_watchRefs:function(){if(!this._boundWatchRef){this._boundWatchRef=true;this._watchRef=c.bind(this._watchRef,this)}for(var e=this.refs.length;e--;){this._watchRef(this.refs[e])}},_watchRef:function(e){var t=this,n,r=true;this._bindings.push(this.__context.bind(e,function(e,i){if(n){n.dispose();n=undefined;t._bindings.splice(t._bindings.indexOf(n),1)}if(e&&e.__isBindable){t._bindings.push(n=t._watchBindable(e,i))}if(!r&&!t._locked){t.dispose();t.application.animate(t)}}).now());r=false},_watchBindable:function(e,t){var n,r=this;e.on("change",n=function(){r._debounceUpdate()});return{dispose:function(){e.off("change",n)}}},_debounceUpdate:function(){if(!n.browser){return this.update()}if(this._debounceTimeout)clearTimeout(this._debounceTimeout);var e=this;this._debounceTimeout=setTimeout(function(){e.update()},0)}});function l(e,t){this.clip=e;this._scripts={};this.names=[];this._bindScripts(t)}r(l,{watch:function(){for(var e in this._scripts){this._scripts[e].watch()}},update:function(){for(var e in this._scripts){this._scripts[e].update()}},dispose:function(){for(var e in this._scripts){this._scripts[e].dispose()}},get:function(e){return this._scripts[e]},_bindScripts:function(e){if(e.run){this._bindScript("value",e)}else{for(var t in e){this._bindScript(t,e[t])}}},_bindScript:function(e,t,n){this.names.push(e);var r=this._scripts[e]=new f(t,e,this.clip),i=this}});function p(e){s.call(this);this.application=e.application;this.scripts=new l(this,e.scripts||e.script);if(e.watch!==false){this.watch()}}r(s,p,{reset:function(e,t){this.data=e?e:new o.Object;if(t!==false){this.update()}},watch:function(){this.scripts.watch();return this},update:function(){this.scripts.update();return this},dispose:function(){this.scripts.dispose()},script:function(e){return this.scripts.get(e)}});t.exports=p}).call(this,e("OpdoqP"))},{"./ref":121,OpdoqP:61,bindable:164,dref:171,protoclass:198,"type-component":199,underscore:197}],121:[function(e,t,n){var r=e("protoclass"),i=e("underscore");function o(e,t){this.clip=e;this.path=t}r(o,{__isBindableReference:true,value:function(e){if(!arguments.length)return this.clip.get(this.path);this.clip.set(this.path,e)},toString:function(){return this.clip.get(this.path)}});t.exports=o},{protoclass:198,underscore:197}],122:[function(e,t,n){var r=e("protoclass");function i(e,t,n,r,i){this.template=e;this.node=t;this.bindings=n;this.section=r;this.nodeFactory=i}r(i,{remove:function(){this.section.remove();return this},removeAllNodes:function(){this.section.removeAll()},dispose:function(){this.unbind();this.section.remove();return this},bind:function(e){if(e){this.context=e}this.bindings.bind(this.context);return this},unbind:function(){this.bindings.unbind();return this},render:function(){return this.section.show().render()},toString:function(){if(this.nodeFactory.name!=="dom"){return this.section.toString()}var e=this.section.render();var t=document.createElement("div");t.appendChild(e.cloneNode(true));return t.innerHTML}});t.exports=i},{protoclass:198}],123:[function(e,t,n){var r=e("protoclass");function i(e){this.marker=e.marker;this.application=e.application}r(i,{init:function(){this._findPathToMarker()},getBinding:function(e){},_findMark:function(e){var t=e;while(t.parentNode){t=t.parentNode}for(var n=0,r=this.pathLength;n<r;n++){t=t.childNodes[this.path[n]]}return t},_findPathToMarker:function(){var e=[],t=this.marker,n=t;while(n.parentNode){var r=[];for(var i=0,o=n.parentNode.childNodes.length;i<o;i++){r.push(n.parentNode.childNodes[i])}e.unshift(r.indexOf(n));n=n.parentNode}this.path=e;this.pathLength=e.length}});t.exports=i},{protoclass:198}],124:[function(e,t,n){var r=e("protoclass");function i(e){this.node=e}r(i,{bind:function(e){this.context=e},unbind:function(){}});t.exports=i},{protoclass:198}],125:[function(e,t,n){var r=e("protoclass"),i=e("./binding");function o(e,t,n){this.application=e;this.clip=t;this.scriptName=n;this.script=t.script(n)}r(i,o,{bind:function(e){this.context=e;if(this.watch!==false){this.script.watch().update()}var t=this;this._binding=this.clip.bind(this.scriptName,function(e,n){t.value=e;t.oldValue=n;t.application.animate(t)}).now();return this},unbind:function(){if(this._binding)this._binding.dispose();this._binding=undefined;return this},update:function(){this._onChange(this.value,this.oldValue)},_onChange:function(e,t){}});t.exports=o},{"./binding":124,protoclass:198}],126:[function(e,t,n){var r=e("./base/binding"),i=e("./collection");function o(e,t){this.node=e;this._source=t||[]}r.extend(o,{push:function(){this._source.push.apply(this._source,arguments)},getBindings:function(e){if(this._source.length===1){return this._source[0].getBinding(e)}var t=new i;for(var n=0;n<this._source.length;n++){var r=this._source[n].getBinding(e);if(!r){console.log(this._source.length);continue}t.push(r)}return t},init:function(){for(var e=0,t=this._source.length;e<t;e++){this._source[e].init()}}});t.exports=o},{"./base/binding":124,"./collection":132}],127:[function(e,t,n){var r=e("../base/script");function i(e){var t=e.clip;this.section=e.section;this.application=e.application;this.nodeFactory=this.application.nodeFactory;this.contentTemplate=e.template;this.scriptName=e.scriptName;this.childBlockTemplate=e.childBlockTemplate;this.script=t.script(this.scriptName);r.call(this,this.application,t,this.scriptName)}r.extend(i,{bind:function(e){this.context=e;this.clip.reset(e,false);return r.prototype.bind.call(this,e)},unbind:function(){r.prototype.unbind.call(this);return this.clip.dispose()},test:function(e){return false}});t.exports=i},{"../base/script":125}],128:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{_onChange:function(e,t){e=!!e;if(this._oldValue===e){return}this._oldValue=e;var n=this.child;if(n){n.unbind();this.child=undefined}var r;if(e){r=this.contentTemplate}else{r=this.childBlockTemplate}if(r){this.child=r.bind(this.context);this.section.replaceChildNodes(this.child.render())}else if(n){n.dispose()}},unbind:function(){this._oldValue=undefined;r.prototype.unbind.call(this);return this.child?this.child.dispose():undefined}});t.exports=i},{"./base":127}],129:[function(e,t,n){var r=e("../collection"),i=e("loaf"),o=e("../../../clip"),s=e("protoclass");var a={html:e("./html"),"if":e("./conditional"),"else":e("./conditional"),elseif:e("./conditional"),value:e("./value")};function u(e){this.options=e}s(u,{getNode:function(){return this.options.clazz.getNode?this.options.clazz.getNode(this.options):undefined},prepare:function(){return this.options.clazz.prepare?this.options.clazz.prepare(this.options):undefined},init:function(){return this._path=this.path()},getBinding:function(e){var t=e;while(t.parentNode){t=t.parentNode}for(var n=0,r=this._path.length;n<r;n++){t=t.childNodes[this._path[n]]}var s=this.options.clazz;var a={node:t,clip:new o({script:this.options.script,watch:false,application:this.options.application})};if(this.options.section){a.section=i(this.options.section.nodeFactory,t,t.nextSibling)}for(var u in this.options){if(a[u]!=null){continue}a[u]=this.options[u]}return new s(a)},path:function(e){if(!e&&this._path)return this._path;var t=[],n=[];var r=this.options.node||this.options.section.start;while(r.parentNode){n=[];for(var i=0,o=r.parentNode.childNodes.length;i<o;i++){n.push(r.parentNode.childNodes[i])}t.unshift(n.indexOf(r));r=r.parentNode}return this._path=t}});function c(){}s(c,{getBinder:function(e){var t=e.script.fn?["value"]:Object.keys(e.script),n;for(var r=0,i=t.length;r<i;r++){var o=t[r];if(n=a[o]){e.scriptName=o;e.clazz=n;if(n.prepare)n.prepare(e);return new u(e)}}},register:function(e,t){a[e]=t}});t.exports=new c},{"../../../clip":120,"../collection":132,"./conditional":128,"./html":130,"./value":131,loaf:172,protoclass:198}],130:[function(e,t,n){var r=e("type-component"),i=e("./base");function o(){i.apply(this,arguments)}i.extend(o,{_onChange:function(e,t){if(t&&t.remove){t.remove()}if(!e){return this.section.removeAll()}var n;if(e.render){e.remove();n=e.render()}else if(e.nodeType!=null){n=e}else{if(this.nodeFactory.name!=="dom"){n=this.nodeFactory.createTextNode(String(e))}else{var r=this.nodeFactory.createElement("div");r.innerHTML=String(e);n=this.nodeFactory.createFragment(r.childNodes)}}return this.section.replaceChildNodes(n)}});t.exports=o},{"./base":127,"type-component":199}],131:[function(e,t,n){var r=e("protoclass"),i=e("./base");function o(e){this.node=e.node;i.call(this,e)}r(i,o,{update:function(){var e=this.value;if(e==undefined){e=""}if(this.nodeFactory.name==="dom"){this.node.nodeValue=String(e)}else if(this.node.replaceText){this.node.replaceText(e,true)}}});o.getNode=function(e){return e.node=e.application.nodeFactory.createTextNode("",true)};t.exports=o},{"./base":127,protoclass:198}],132:[function(e,t,n){var r=e("./base/binding");function i(e,t){this._source=t||[]}r.extend(i,{push:function(){this._source.push.apply(this._source,arguments)},bind:function(e,t){for(var n=0,r=this._source.length;n<r;n++){this._source[n].bind(e,t)}},unbind:function(){for(var e=0,t=this._source.length;e<t;e++){this._source[e].unbind()}}});t.exports=i},{"./base/binding":124}],133:[function(e,t,n){t.exports={BaseBlockBinding:e("./block/base"),blockBindingFactory:e("./block/factory"),nodeBindingFactory:e("./node/factory"),BaseNodeBinding:e("./node/base"),BaseAttrDataBinding:e("./node/attrs/dataBind/handlers/base")}},{"./block/base":127,"./block/factory":129,"./node/attrs/dataBind/handlers/base":134,"./node/base":148,"./node/factory":149}],134:[function(e,t,n){var r=e("../../../../base/script");function i(e,t,n,i){this.node=t;r.call(this,e,this.clip=n,this.name=i)}r.extend(i,{});t.exports=i},{"../../../../base/script":125}],135:[function(e,t,n){var r=e("./event"),i=e("underscore");function o(){r.apply(this,arguments)}o.events="keydown change input mousedown mouseup click";r.extend(o,{preventDefault:false,event:o.events,_update:function(e){clearTimeout(this._changeTimeout);this._changeTimeout=setTimeout(i.bind(this._update2,this),5)},_update2:function(){this.script.update()}});t.exports=o},{"./event":141,underscore:197}],136:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{_onChange:function(e){var t=this.node.getAttribute("class");t=t?t.split(" "):[];for(var n in e){var r=e[n];var i=n.split(/,\s*/);for(var o=0,s=i.length;o<s;o++){var a=i[o];var u=t.indexOf(a);if(r){if(!~u){t.push(a)}}else if(~u){t.splice(u,1)}}}this.node.setAttribute("class",t.join(" "))}});t.exports=i},{"./base":134}],137:[function(e,t,n){var r=e("./event");function i(){r.apply(this,arguments)}r.extend(i,{preventDefault:true,event:"keydown",_onEvent:function(e){if(!~[8].indexOf(e.keyCode)){return}r.prototype._onEvent.apply(this,arguments)}});t.exports=i},{"./event":141}],138:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{_onChange:function(e){if(e){this.node.setAttribute("disabled","disabled")}else{this.node.removeAttribute("disabled")}}});t.exports=i},{"./base":134}],139:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{_onChange:function(e){if(e){this.node.removeAttribute("disabled")}else{this.node.setAttribute("disabled","disabled")}}});t.exports=i},{"./base":134}],140:[function(e,t,n){var r=e("./event");function i(){r.apply(this,arguments)}r.extend(i,{preventDefault:true,event:"keydown",_onEvent:function(e){if(!~[13].indexOf(e.keyCode)){return}r.prototype._onEvent.apply(this,arguments)}});t.exports=i},{"./event":141}],141:[function(e,t,n){var r=e("./base"),i=e("underscore");function o(){r.apply(this,arguments);this._onEvent=i.bind(this._onEvent,this)}r.extend(o,{watch:false,propagateEvent:true,preventDefault:false,bind:function(){r.prototype.bind.apply(this,arguments);var e=(this.event||this.name).toLowerCase(),t=this.name.toLowerCase();if(t.substr(0,2)==="on"){t=t.substr(2)}if(e.substr(0,2)==="on"){e=e.substr(2)}this._updateScript(this.clip.script("propagateEvent"));this._updateScript(this.clip.script("preventDefault"));if(~["click","mouseup","mousedown","submit"].indexOf(t)){this.preventDefault=true;this.propagateEvent=false}this._pge="propagateEvent."+t;this._pde="preventDefault."+t;this._setDefaultProperties(this._pge);this._setDefaultProperties(this._pde);(this.$node=$(this.node)).bind(this._event=e,this._onEvent)},unbind:function(){r.prototype.unbind.call(this);return this.$node.unbind(this._event,this._onEvent)},_updateScript:function(e){if(e){e.update()}},_setDefaultProperties:function(e){var t=e.split(".").shift();if(!this.clip.has(e)&&!this.clip.has(t)&&this[t]!=null){this.clip.set(e,this[t])}},_onEvent:function(e){if(this.clip.get("propagateEvent")!==true&&this.clip.get(this._pge)!==true){e.stopPropagation()}if(this.clip.get("preventDefault")===true||this.clip.get(this._pde)===true){e.preventDefault()}if(this.clip.get("disable"))return;this.clip.data.set("event",e);this._update(e)},_update:function(e){this.script.update()}});t.exports=o},{"./base":134,underscore:197}],142:[function(e,t,n){var r=e("protoclass"),i=e("./base");function o(){i.apply(this,arguments)}r(i,o,{_onChange:function(e){if(typeof $==="undefined"||!e)return;$(this.node).focus();$(this.node).trigger("focusin")}});t.exports=o},{"./base":134,protoclass:198}],143:[function(e,t,n){(function(n){var r=e("underscore"),i=e("./change"),o=e("./base"),s=e("type-component"),a=e("dref");function u(){this._elementValue=r.bind(this._elementValue,this);this._onValueChange=r.bind(this._onValueChange,this);this._onChange=r.bind(this._onChange,this);this._onElementChange=r.bind(this._onElementChange,this);u.__super__.constructor.apply(this,arguments)}o.extend(u,{bind:function(){var e=this;if(/^(text|password|email)$/.test(this.node.getAttribute("type"))){this._autocompleteCheckInterval=setInterval(function(){e._onElementChange()},500)}u.__super__.bind.apply(this,arguments);(this.$element=$(this.node)).bind(i.events,this._onElementChange);this._nameBinding=this.clip.data.bind("name",this._onChange);this._onChange()},_onElementChange:function(e){if(e)e.stopPropagation();clearTimeout(this._changeTimeout);var t=this;function r(){var e=t._parseValue(t._elementValue()),n=t._elementName(),r=t.script.refs,i=t.clip.get("model");if(e){clearInterval(t._autocompleteCheckInterval)}if(t.clip.get("bothWays")!==false){ref=n||(r.length?r[0]:undefined);if(!n&&!i.__isBindableReference){i=t.context}t.currentValue=e;if(i){if(i.__isBindableReference){i.value(e)}else if(i.set){i.set(ref,e)}else{a.set(i,ref,e)}}}}if(!n.browser){r()}else{this._changeTimeout=setTimeout(r,5)}},unbind:function(){u.__super__.unbind.apply(this,arguments);clearInterval(this._autocompleteCheckInterval);if(this._modelBinding)this._modelBinding.dispose();if(this._nameBinding)this._nameBinding.dispose();this.$element.unbind(i.events,this._onElementChange)},_onChange:function(){var e=this.clip.get("model");var t=this._elementName();if(this._modelBinding)this._modelBinding.dispose();if(t){this._modelBinding=e?e.bind(t,r.bind(this._onValueChange,this)).now():undefined}else if(e&&e.__isBindableReference){this._onValueChange(e.value())}else if(s(e)!=="object"){this._onValueChange(e)}},_onValueChange:function(e){this._elementValue(this._parseValue(e))},_parseValue:function(e){if(e==null||e==="")return void 0;var t=this.clip.script("type");if(!t)return e;t.update();var n=this.clip.get("type");if(!n)return e;switch(n){case"number":return Number(e);case"boolean":return Boolean(e);default:return e}},_elementValue:function(e){var t=Object.prototype.hasOwnProperty.call(this.node,"value")||/input|textarea|checkbox/.test(this.node.nodeName.toLowerCase());if(!arguments.length)return t?this._checkedOrValue():this.node.innerHTML;if(e==null){e=""}if(this.currentValue===e){return}this.currentValue=e;if(t){this._checkedOrValue(e)}else{this.node.innerHTML=e}},_elementName:function(){return $(this.node).attr("name")},_checkedOrValue:function(e){var t=/checkbox/.test(this.node.type),n=/radio/.test(this.node.type),r=t||n;if(!arguments.length){if(t){return Boolean($(this.node).is(":checked"))}else{return this.node.value}}if(r){if(n){if(String(e)===String($(this.node).val())){$(this.node).prop("checked",true)}}else{this.node.checked=e}}else{this.node.value=e}}});t.exports=u}).call(this,e("OpdoqP"))},{"./base":134,"./change":135,OpdoqP:61,dref:171,"type-component":199,underscore:197}],144:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{bind:function(e){this._displayStyle=this.node.style.display;r.prototype.bind.call(this,e)},_onChange:function(e){this.node.style.display=e?this._displayStyle:"none"}});t.exports=i},{"./base":134}],145:[function(e,t,n){(function(n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{bind:function(e){this._currentStyles={};r.prototype.bind.call(this,e)},_onChange:function(e){var t={};for(var r in e){var i=e[r];if(i!==this._currentStyles[r]){t[r]=this._currentStyles[r]=i||""}}if(!n.browser){for(var o in t){this.node.style[o]=t[o]}}else{$(this.node).css(t)}}});t.exports=i}).call(this,e("OpdoqP"))},{"./base":134,OpdoqP:61}],146:[function(e,t,n){var r=e("../../../../../clip"),i=e("../../../collection"),o=e("../../base");var s={show:e("./handlers/show"),css:e("./handlers/css"),style:e("./handlers/style"),focus:e("./handlers/focus"),disable:e("./handlers/disable"),enable:e("./handlers/enable"),model:e("./handlers/model"),onClick:e("./handlers/event"),onDblClick:e("./handlers/event"),onLoad:e("./handlers/event"),onSubmit:e("./handlers/event"),onMouseDown:e("./handlers/event"),onMouseMove:e("./handlers/event"),onMouseUp:e("./handlers/event"),onMouseOver:e("./handlers/event"),onMouseOut:e("./handlers/event"),onFocusIn:e("./handlers/event"),onFocusOut:e("./handlers/event"),onKeyDown:e("./handlers/event"),onKeyUp:e("./handlers/event"),onEnter:e("./handlers/enter"),onChange:e("./handlers/change"),onDelete:e("./handlers/delete")};function a(e){o.call(this,e);this.clip=new r({scripts:e.value[0],watch:false,application:e.application});this._bindings=new i;for(var t=0,n=this.clip.scripts.names.length;t<n;t++){var a=this.clip.scripts.names[t],u;if(!(u=s[a]))continue;this._bindings.push(new u(e.application,this.node,this.clip,a))}}o.extend(a,{type:"attr",bind:function(e){this.context=e;this.clip.reset(e,false);this._bindings.bind(e)},unbind:function(){this._bindings.unbind();this.clip.dispose()}});t.exports=a;t.exports.register=function(e,t){s[e]=t}},{"../../../../../clip":120,"../../../collection":132,"../../base":148,"./handlers/change":135,"./handlers/css":136,"./handlers/delete":137,"./handlers/disable":138,"./handlers/enable":139,"./handlers/enter":140,"./handlers/event":141,"./handlers/focus":142,"./handlers/model":143,"./handlers/show":144,"./handlers/style":145}],147:[function(e,t,n){var r=e("type-component"),i=e("../../../../../clip/buffer"),o=e("../../base"),s=e("underscore");function a(e){o.apply(this,arguments);this.clippedBuffer=new i(this.value,e.application)}o.extend(a,{type:"attr",bind:function(e){this.context=e;this._binding=this.clippedBuffer.reset(this.context).bind("value",s.bind(this._onChange,this)).now()},unbind:function(){if(this._binding)this._binding.dispose();this.clippedBuffer.dispose()},_onChange:function(e){if(!e.length){return this.node.removeAttribute(this.name)}this.node.setAttribute(this.name,e)},test:function(e){if(r(e.value)!=="array"){return false}for(var t=0,n=e.value.length;t<n;t++){if(e.value[t].run)return true}return false}});t.exports=a},{"../../../../../clip/buffer":119,"../../base":148,"type-component":199,underscore:197}],148:[function(e,t,n){var r=e("../../base/binding");function i(e){this.name=e.name||this.namel;this.node=e.node;this.value=e.value;this.nodeMOdel=e.context}r.extend(i,{bind:function(e){this.context=e},unbind:function(){}});t.exports=i},{"../../base/binding":124}],149:[function(e,t,n){var r=e("underscore"),i=e("protoclass");var o={node:{},attr:{"default":[]}};function s(e){this.options=e}i(s,{init:function(){},getBinding:function(e){var t=e;while(t.parentNode){t=t.parentNode}var n=this.path();for(var i=0,o=n.length;i<o;i++){t=t.childNodes[n[i]]}var s=this.options.clazz;return new s(r.extend({},this.options,{node:t}))},path:function(){if(this._path)return this._path;var e=[];var t=this.options.node;while(t.parentNode){var n=[];for(var r=0,i=t.parentNode.childNodes.length;r<i;r++){n.push(t.parentNode.childNodes[r])}e.unshift(n.indexOf(t));t=t.parentNode}return this._path=e}});function a(){}i(a,{getBinders:function(e){var t=[],n=e.attributes,r=e.nodeName,i=e.node;var a=[{name:r,key:r,value:i,type:"node",node:i},{name:r,key:"default",value:i,type:"node",node:i}];var u;for(var c in n){a.push({node:i,name:c,key:c,value:n[c],type:"attr"},{node:i,name:c,key:"default",value:n[c],type:"attr"})}for(var f=0,l=a.length;f<l;f++){var p=a[f];var h=o[p.type][p.key]||[];for(var d=0,v=h.length;d<v;d++){var m=h[d];if(m.prototype.test(p)){p.clazz=m;p.application=e.application;t.push(new s(p))}}}return t},register:function(e,t){var n=t.type||t.prototype.type;if(!/node|attr/.test(String(n))){throw new Error("node binding class '"+t.name+"' must have property type 'node', or 'attr'")}var r=o[n];if(!t.prototype.test){t.prototype.test=function(){return true}}if(!r[e]){r[e]=[]}r[e].push(t);return this}});var u=t.exports=new a;var c={"default":[e("./attrs/text")],"data-bind":[t.exports.dataBind=e("./attrs/dataBind")]};for(var f in c){var l=c[f];for(var p=0,h=l.length;p<h;p++){u.register(f,l[p])}}},{"./attrs/dataBind":146,"./attrs/text":147,protoclass:198,underscore:197}],150:[function(e,t,n){var r=e("protoclass"),i=e("../base/binder"),o=e("./binding");function s(e){i.apply(this,arguments);this.blocks=e.blocks}i.extend(s,{getBinding:function(e){var t=this._findMark(e);return new o(t,this.blocks,this.application)}});t.exports=s},{"../base/binder":123,"./binding":151,protoclass:198}],151:[function(e,t,n){var r=e("protoclass"),i=e("../base/binding"),o=e("../../../clip/buffer"),s=e("underscore");function a(e,t,n){this.node=e;this.blocks=t;this.application=n;this.clip=new o(t,n)}i.extend(a,{bind:function(e){return this._binding=this.clip.reset(e).bind("value",s.bind(this.update,this)).now()},unbind:function(){this._binding.dispose()},update:function(){this.node.nodeValue=String(this.clip.value);if(this.node.replaceText){this.node.replaceText(this.clip.value,true)}}});t.exports=a},{"../../../clip/buffer":119,"../base/binding":124,protoclass:198,underscore:197}],152:[function(e,t,n){var r=e("../clip"),i=e("./template"),o=e("nofactor"),s=e("./modifiers"),a=e("./bindings"),u=e("bindable");t.exports={Clip:r,bindable:u,template:i,modifier:function(e,t){return s[e]=t},BaseBlockBinding:a.BaseBlockBinding,BaseNodeBinding:a.BaseNodeBinding,BaseAttrDataBinding:a.BaseAttrDataBinding,blockBinding:a.blockBindingFactory.register,nodeBinding:a.nodeBindingFactory.register,attrDataBinding:a.nodeBindingFactory.dataBind.register,Application:e("mojo-application"),use:function(e){return e(this)}}},{"../clip":120,"./bindings":133,"./modifiers":153,"./template":154,bindable:164,"mojo-application":22,nofactor:178}],153:[function(e,t,n){t.exports={uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},titlecase:function(e){var t;t=String(e);return t.substr(0,1).toUpperCase()+t.substr(1)},json:function(e,t,n){return JSON.stringify.apply(JSON,arguments)}}},{}],154:[function(e,t,n){(function(n){var r=e("protoclass"),i=e("./modifiers"),o=e("nofactor"),s=e("./writers/fragment"),a=e("./writers/block"),u=e("./writers/text"),c=e("./writers/textBlock"),f=e("./writers/element"),l=e("./writers/parse"),p=e("./bindings/collection"),h=e("./bindings/binders"),d=e("mojo-application"),v=e("mojo-animator"),m=e("bindable");loaf=e("loaf"),PaperBinding=e("./binding");function g(e,t,n){this.paper=e;this.application=t;this.nodeFactory=t.nodeFactory;this.useTemplateNode=n.useTemplateNode}r(g,{load:function(e){if(!this._templateNode||!this.useTemplateNode){this._templateNode=this._createTemplateNode()}var t=this.useTemplateNode?this._templateNode.cloneNode(true):this._templateNode;var n=this.binders.getBindings(t);if(!e){e=loaf(this.nodeFactory)}e.append(t);return new PaperBinding(this,t,n,e,this.nodeFactory)},bind:function(e,t){if(!e){e={}}if(!e.__isBindable){e=new m.Object(e)}return this.load(t).bind(e)},_createTemplateNode:function(){this.binders=new h;var e={fragment:new s(this),block:new a(this),text:new u(this),element:new f(this),parse:new l(this),textBlock:new c(this)};var t=this.paper(e.fragment.write,e.block.write,e.element.write,e.text.write,e.textBlock.write,e.parse.write,i);this.binders.init();return t}});var y=new d;var _=g.prototype.creator=t.exports=function(e,t){var r,i=false;if(!t){t=y}if(!t.animate){t.use(v)}if(typeof e==="string"){if(!_.compiler){throw new Error("template must be a function")}r=_.compiler.compile(e,{eval:true})}else{r=e}if(n.browser){i=~navigator.userAgent.toLowerCase().indexOf("msie")||~navigator.userAgent.toLowerCase().indexOf("trident")}var o={useTemplateNode:!t.fake&&!i&&false};if(o.useTemplateNode&&r.template){return r.template}return r.template=new g(r,t,o)}}).call(this,e("OpdoqP"))},{"./binding":122,"./bindings/binders":126,"./bindings/collection":132,"./modifiers":153,"./writers/block":156,"./writers/element":157,"./writers/fragment":158,"./writers/parse":159,"./writers/text":160,"./writers/textBlock":161,OpdoqP:61,bindable:164,loaf:172,"mojo-animator":174,"mojo-application":22,nofactor:178,protoclass:198}],155:[function(e,t,n){var r=e("protoclass"),i=e("underscore");function o(e){this.template=e;this.nodeFactory=e.application.nodeFactory;this.application=this.template.application;this.binders=e.binders;this.write=i.bind(this.write,this)}r(o,{write:function(e,t,n){}});t.exports=o},{protoclass:198,underscore:197}],156:[function(e,t,n){var r=e("loaf"),i=e("../bindings/block/factory"),o=e("../../clip"),s=e("./base");function a(){s.apply(this,arguments)}s.extend(a,{write:function(e,t,n){var r=t?this.template.creator(t,this.application):undefined,o=n?this.template.creator(n,this.application):undefined,s,a;this.binders.push(s=i.getBinder(a={script:e,template:r,application:this.application,childBlockTemplate:o}));var u=s.getNode(a)||this.getDefaultNode(a);s.prepare(a);return u},getDefaultNode:function(e){return(e.section=r(this.nodeFactory)).render()}});t.exports=a},{"../../clip":120,"../bindings/block/factory":129,"./base":155,loaf:172}],157:[function(e,t,n){var r=e("../bindings/node/factory"),i=e("type-component"),o=e("./base");function s(){o.apply(this,arguments)}o.extend(s,{write:function(e,t,n){if(!t)t={};if(!n)n=[];var i=this.nodeFactory.createElement(e),o,s;for(o in t){s=t[o];if(typeof s==="object")continue;i.setAttribute(o,s)}this.binders.push.apply(this.binders,r.getBinders({node:i,nodeName:e,application:this.application,attributes:t}));for(var a=0,u=n.length;a<u;a++){try{i.appendChild(n[a])}catch(c){console.error("parent: ",i.nodeName);console.log("child: ",n[a].nodeName)}}return i}});t.exports=s},{"../bindings/node/factory":149,"./base":155,"type-component":199}],158:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{write:function(e){if(e.length===1)return e[0];return this.nodeFactory.createFragment(e)}});t.exports=i},{"./base":155}],159:[function(e,t,n){(function(n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{write:function(e){var t;if(n.browser){t=this.nodeFactory.createElement("div");t.innerHTML=e}else{t=this.nodeFactory.createTextNode(e)}return t}});t.exports=i}).call(this,e("OpdoqP"))},{"./base":155,OpdoqP:61}],160:[function(e,t,n){var r=e("./base");function i(){r.apply(this,arguments)}r.extend(i,{write:function(e){return this.nodeFactory.createTextNode(e)}});t.exports=i},{"./base":155}],161:[function(e,t,n){var r=e("./base"),i=e("../bindings/textBlock/binder");function o(){r.apply(this,arguments)}r.extend(o,{write:function(e){var t=this.nodeFactory.createTextNode("");this.binders.push(new i({marker:t,blocks:e,application:this.application}));return t}});t.exports=o},{"../bindings/textBlock/binder":150,"./base":155}],162:[function(e,t,n){arguments[4][23][0].apply(n,arguments)},{"../object":165,"../utils/computed":168,sift:196}],163:[function(e,t,n){t.exports=e(24)},{protoclass:198}],164:[function(e,t,n){arguments[4][25][0].apply(n,arguments)},{"./collection":162,"./core/eventEmitter":163,"./object":165,"./utils/computed":168,"./utils/options":169}],165:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":163,"./watchProperty":167,protoclass:198}],166:[function(e,t,n){t.exports=e(27)},{toarray:170,underscore:197}],167:[function(e,t,n){t.exports=e(28)},{"../utils/options":169,"./transform":166,underscore:197}],168:[function(e,t,n){t.exports=e(29)},{toarray:170}],169:[function(e,t,n){t.exports=e(30)},{}],170:[function(e,t,n){t.exports=e(33)},{}],171:[function(e,t,n){(function(t){var r=t._gss=t._gss||[],i=e("type-component");var o=function(e){for(var t=r.length;t--;){var n=r[t];if(n.test(e)){return n}}};var s=function(e){var t=o(e);return t?t.length(e):e.length};var a=function(e,t){var n=o(e);return n?n.get(e,t):e[t]};var u=function(e,t,n){var r=o(e);return r?r.set(e,t,n):e[t]=n};var c=function(e,t,n,r,o){if(!o){e=(i(e)==="array"?e:e.split(".")).filter(function(e){return!!e.length});o=[];r=0}var f,l,p,h=r,d=e.length,v=t;for(;h<d;h++){p=e[h];f=a(v,p);if(p=="$"){for(l=s(v);l--;){c(e,a(v,l),n,h+1,o)}return o}else if(f==undefined||f==null){if(!n)return o;u(v,p,{});f=a(v,p)}v=f}if(f){o.push(f)}else{o.push(v)}return o};var f=function(e,t){t=String(t);var n=c(t,e);return t.indexOf(".$.")==-1?n[0]:n};var l=function(e,t,n){t=String(t);var r=t.split("."),i=r.pop();if(i=="$"){i=r.pop()}var o=c(r,e,true);for(var s=o.length;s--;){u(o[s],i,n)}};n.get=f;n.set=l;n.use=function(e){r.push(e)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"type-component":199}],172:[function(e,t,n){var r=e("protoclass"),i=e("nofactor");var o=function(e,t,n){this.nodeFactory=e=e||i["default"];this.start=t||e.createTextNode("");this.end=n||e.createTextNode("");this.visible=true;if(!this.start.parentNode){var r=e.createFragment();r.appendChild(this.start);r.appendChild(this.end)}};o=r(o,{__isLoafSection:true,render:function(){return this.start.parentNode},remove:function(){return this.nodeFactory.createFragment(this.getChildNodes())},show:function(){if(!this._detached)return this;this.append.apply(this,this._detached.getInnerChildNodes());this._detached=void 0;this.visible=true;return this
},hide:function(){this._detached=this.removeAll();this.visible=false;return this},removeAll:function(){return this._section(this._removeAll())},_removeAll:function(){var e=this.start,t=this.end,n=e.nextSibling,r=[];while(n!=t){n.parentNode.removeChild(n);r.push(n);n=this.start.nextSibling}return r},append:function(){this._insertAfter(Array.prototype.slice.call(arguments,0),this.end.previousSibling)},prepend:function(){this._insertAfter(Array.prototype.slice.call(arguments,0),this.start)},replaceChildNodes:function(){this.removeAll();this.append.apply(this,arguments)},toString:function(){var e=this.getChildNodes().map(function(e){return e.outerHTML||(e.nodeValue!=undefined?e.nodeValue:String(e))});return e.join("")},dispose:function(){if(this._disposed)return;this._disposed=true;this.removeAll();this.start.parentNode.removeChild(this.start);this.end.parentNode.removeChild(this.end)},getChildNodes:function(){var e=this.start,t=this.end.nextSibling,n=[];while(e!=t){n.push(e);e=e.nextSibling}return n},getInnerChildNodes:function(){var e=this.getChildNodes();e.shift();e.pop();return e},_insertAfter:function(e,t){if(!e.length)return;if(e.length>1){e=this.nodeFactory.createFragment(e)}else{e=e[0]}return t.parentNode.insertBefore(e,t.nextSibling)},_section:function(e){var t=new o(this.nodeFactory);t.append.apply(t,e);return t}});t.exports=function(e,t,n){return new o(e,t,n)}},{nofactor:178,protoclass:198}],173:[function(e,t,n){(function(n){var r=e("protoclass");function i(){this._animationQueue=[]}r(i,{animate:function(e){if(!n.browser){return e.update()}this._animationQueue.push(e);if(this._requestingFrame)return;this._requestingFrame=true;var t=this;requestAnimationFrame(function(){var e=t._animationQueue;for(var n=0;n<e.length;n++){e[n].update()}t._animationQueue=[];t._requestingFrame=false})}});t.exports=i}).call(this,e("OpdoqP"))},{OpdoqP:61,protoclass:198}],174:[function(e,t,n){var r=e("./animator");t.exports=function(e){var t=new r;e.animate=function(e){t.animate(e)}}},{"./animator":173}],175:[function(e,t,n){t.exports=e(35)},{protoclass:198}],176:[function(e,t,n){t.exports=e(36)},{"./base":175,factories:195}],177:[function(e,t,n){t.exports=e(37)},{"./base":175}],178:[function(e,t,n){t.exports=e(38)},{"./custom":176,"./dom":177,"./string":184}],179:[function(e,t,n){t.exports=e(39)},{"./text":187}],180:[function(e,t,n){t.exports=e(40)},{"./node":185}],181:[function(e,t,n){t.exports=e(41)},{"./container":180,"./style":186}],182:[function(e,t,n){t.exports=e(42)},{}],183:[function(e,t,n){t.exports=e(43)},{"./container":180}],184:[function(e,t,n){t.exports=e(44)},{"../base":175,"./comment":179,"./container":180,"./element":181,"./fragment":183,"./text":187,"./voidElements":188}],185:[function(e,t,n){t.exports=e(45)},{protoclass:198}],186:[function(e,t,n){t.exports=e(46)},{protoclass:198}],187:[function(e,t,n){t.exports=e(47)},{"./ent":182,"./node":185}],188:[function(e,t,n){t.exports=e(48)},{"./element":181}],189:[function(e,t,n){t.exports=e(49)},{"./base":190,"./factory":192}],190:[function(e,t,n){t.exports=e(50)},{}],191:[function(e,t,n){t.exports=e(51)},{"./base":190}],192:[function(e,t,n){t.exports=e(52)},{"./base":190,"./class":191,"./fn":193,"type-component":199}],193:[function(e,t,n){t.exports=e(53)},{}],194:[function(e,t,n){t.exports=e(54)},{"./base":190,"./factory":192}],195:[function(e,t,n){t.exports=e(55)},{"./any":189,"./class":191,"./factory":192,"./fn":193,"./group":194}],196:[function(e,t,n){(function(){var e=function(e,t){var n={},r=n;for(var i=0,o=e.length-1;i<o;i++){r=r[e[i]]={}}r[e[i]]=t;return n};var n=new function(){var t=this.priority=function(e,t){var n=e.exprs,r=0;for(var o=0,s=n.length;o<s;o++){var a=n[o],u;if(!~(u=a.e(a.v,i(t),t)))return-1;r+=u}return r};var n=this.parse=function(i,o){if(!i)i={$eq:i};var a=[];if(i.constructor==Object){for(var c in i){var f=!!s[c]?c:"$trav",l=i[c],p=l;if(r[f]){if(~c.indexOf(".")){var h=c.split(".");c=h.shift();p=l=e(h,l)}if(l instanceof Array){p=[];for(var d=l.length;d--;){p.push(n(l[d]))}}else{p=n(l,c)}}a.push(u(f,c,p))}}else{a.push(u("$eq",c,i))}var v={exprs:a,k:o,test:function(e){return!!~v.priority(e)},priority:function(e){return t(v,e)}};return v};var r=this.traversable={$and:true,$or:true,$nor:true,$trav:true,$not:true};function i(e){if(e instanceof Date){return e.getTime()}else{return e}}function o(e){return e?0:-1}var s=this.testers={$eq:function(e,t){return o(e.test(t))},$ne:function(e,t){return o(!e.test(t))},$lt:function(e,t){return o(e>t)},$gt:function(e,t){return o(e<t)},$lte:function(e,t){return o(e>=t)},$gte:function(e,t){return o(e<=t)},$exists:function(e,t){return o(e===(t!=null))},$in:function(e,t){if(t instanceof Array){for(var n=t.length;n--;){if(~e.indexOf(t[n]))return n}}else{return o(~e.indexOf(t))}return-1},$not:function(e,t){if(!e.test)throw new Error("$not test should include an expression, not a value. Use $ne instead.");return o(!e.test(t))},$type:function(e,t,n){return n?o(n instanceof e||n.constructor==e):-1},$nin:function(e,t){return~s.$in(e,t)?-1:0},$mod:function(e,t){return t%e[0]==e[1]?0:-1},$all:function(e,t){for(var n=e.length;n--;){if(t.indexOf(e[n])==-1)return-1}return 0},$size:function(e,t){return t?o(e==t.length):-1},$or:function(e,n){var r=e.length,i,s=r;for(;r--;){if(~t(e[r],n)){return r}}return o(s==0)},$nor:function(e,n){var r=e.length,i=r;for(;r--;){if(~t(e[r],n)){return-1}}return 0},$and:function(e,n){for(var r=e.length;r--;){if(!~t(e[r],n)){return-1}}return 0},$trav:function(e,n){if(n instanceof Array){for(var r=n.length;r--;){var i=n[r];if(i[e.k]&&~t(e,i[e.k]))return r}return-1}return t(e,n?n[e.k]:undefined)}};var a={$eq:function(e){var t;if(e instanceof RegExp){return e}else if(e instanceof Function){t=e}else{t=function(t){if(t instanceof Array){return~t.indexOf(e)}else{return e==t}}}return{test:t}},$ne:function(e){return a.$eq(e)}};var u=function(e,t,n){var r=i(n);return{k:t,v:a[e]?a[e](r):r,e:s[e]}}};var r=function(e){if(!e){return function(e){return e}}else if(typeof e=="function"){return e}throw new Error("Unknown sift selector "+e)};var i=function(e,t){var r=n.parse(e);var i=function(e){var n=[],i=[],o,s;for(var a=0,u=e.length;a<u;a++){o=t(e[a]);if(!~(s=r.priority(o)))continue;n.push({value:o,priority:s})}n.sort(function(e,t){return e.priority>t.priority?-1:1});var c=Array(n.length);for(var a=n.length;a--;){c[a]=n[a].value}return c};i.test=r.test;i.score=r.priority;i.query=e;return i};var o=function(e,t,n){if(typeof t!="object"){n=t;t=undefined}var o=i(e,r(n));if(t)return o(t);return o};o.use=function(e){if(e.operators)o.useOperators(e.operators)};o.useOperators=function(e){for(var t in e){o.useOperator(t,e[t])}};o.useOperator=function(e,t){var r={};if(typeof t=="object"){r=t}else{r={test:t}}var i="$"+e;n.testers[i]=r.test;if(r.traversable||r.traverse){n.traversable[i]=true}};if(typeof t!="undefined"&&typeof t.exports!="undefined"){t.exports=o}else if(typeof window!="undefined"){window.sift=o}})()},{}],197:[function(e,t,n){t.exports=e(34)},{}],198:[function(e,t,n){t.exports=e(31)},{}],199:[function(e,t,n){t.exports=e(56)},{}],200:[function(e,t,n){(function(n){var r=e("paperclip"),i=e("kubrik");t.exports=function(t){t.use(e("mojo-mediator"));r.nodeBinding("data-href",e("./plugins/datahref"));t.use(e("./plugins/statesRouter"));var o=t.router=i({});if(n.browser){o.use(i.listeners.http)}o.bind("location.query",{target:t,to:"models.query"});o.bind("location.params",{target:t,to:"models.params"});o.bind("location.states",{target:t,to:"models.states"});t.mediator.on("post bootstrap",function(e,t){o.init();t()});return o}}).call(this,e("OpdoqP"))},{"./plugins/datahref":201,"./plugins/statesRouter":202,OpdoqP:61,kubrik:208,"mojo-mediator":67,paperclip:242}],201:[function(e,t,n){pc=e("paperclip");t.exports=pc.BaseNodeBinding.extend({type:"attr",bind:function(e){pc.BaseNodeBinding.prototype.bind.apply(this,arguments);var t=$(this.node).attr("data-href");var n=e.get("application.router").routes.find({pathname:t});var r="";var i="";if(!n)return;var o=this;this._binding=this.context.bind(n.params.join(","),function(){var e={},t=arguments;n.params.forEach(function(n,r){var i;if(!(i=t[r]))return;e[n]=i.get("_id")});r="#!"+(i=n.getPathnameWithParams(e));if(o.node.nodeName==="A"){$(o.node).attr("href",r)}}).now();$(o.node).click(function(t){if(t.metaKey||t.ctrlKey){return}t.preventDefault();e.application.router.redirect(i)})},unbind:function(){var e=pc.BaseNodeBinding.prototype.unbind.apply(this,arguments);if(this._binding)this._binding.dispose();return e}})},{paperclip:242}],202:[function(e,t,n){t.exports=function(e){e.views.decorator({priority:"load",getOptions:function(e){return e.route},decorate:function(e,t){var n=e.bind("models.states."+t,{to:function(t){e.set("currentName",t)}}).now();e.once("dispose",n.dispose)}})}},{}],203:[function(e,t,n){var r=e("toarray"),i=e("async");t.exports={test:function(e){return true},decorate:function(e){function t(e){return function(t,n){if(!e.length)return n();i.eachSeries(e,function(e,n){if(e.length<2){e(t.data);return n()}e(t.data,n)},n)}}e.mediator.on("enter",t(r(e.options.enter)));e.mediator.on("exit",t(r(e.options.exit)))}}},{async:216,toarray:240}],204:[function(e,t,n){var r=e("protoclass"),i=[e("./parentEnterExit"),e("./enterExit"),e("./states"),e("./redirect")];function o(){this._decorators=i.concat()}r(o,{add:function(e){this._decorators.push(e);this._resort()},decorate:function(e){for(var t=this._decorators.length;t--;){var n=this._decorators[t];if(n.test(e)){n.decorate(e)}}return e},_resort:function(){this._decorators=this._decorators.sort(function(e,t){return e.priority>t.priority?-1:1})}});t.exports=o},{"./enterExit":203,"./parentEnterExit":205,"./redirect":206,"./states":207,protoclass:239}],205:[function(e,t,n){t.exports={priority:999,test:function(e){return!!e.parent},decorate:function(e){var t=e.parent;e.mediator.on("pre enter",function(e,n){t.enter(e.data,n)});e.mediator.on("pre exit",function(e,n){t.exit(e.data,n)})}}},{}],206:[function(e,t,n){var r=e("toarray"),i=e("async");t.exports={test:function(e){return e.options.redirect},decorate:function(e){var t=e.options.redirect;e.mediator.on("post enter",function(e,n){e.data.redirect(t)})}}},{async:216,toarray:240}],207:[function(e,t,n){var r=e("toarray"),i=e("async"),o=e("bindable");t.exports={test:function(e){return e.options.states},decorate:function(e){var t=e.options.states,n=e.router;e.mediator.on("post enter",function(e,n){if(!e.data.get("states")){e.data.set("states",new o.Object)}for(var r in t){e.data.set("states."+r,t[r])}n()})}}},{async:216,bindable:219,toarray:240}],208:[function(e,t,n){var r=e("./router");t.exports=function(e){return new r(e)};t.exports.listeners=e("./listeners")},{"./listeners":210,"./router":214}],209:[function(e,t,n){t.exports=function(t){var n=e("hasher");function r(e){t.redirect(String(e||"/").replace(/^#?!?\/?(.*)/,"/$1"),function(e){console.log(e);if(e&&e.code==="404"){t.redirect("404")}})}t.bind("_location.url",function(e){window.location.hash="!"+e});n.changed.add(r);n.initialized.add(r);t.once("init",function(){n.init()})}},{hasher:228}],210:[function(e,t,n){t.exports={http:e("./http")}},{"./http":209}],211:[function(e,t,n){var r=e("async");t.exports=function(e){var t={};e.param=function(e,n){t[e]=n;n.paramName=e};e.routes.decorators.add({test:function(e){return!!e.params.length},decorate:function(e){var n=e.params.map(function(e){return t[e]}).filter(function(e){return!!e});if(!n.length)return;e.mediator.on("pre enter",function(e,t){r.eachSeries(n,function(t,n){t(e.data,function(r,i){if(r)return n(r);if(i!=null){e.data.set("params."+t.paramName,i)}n()})},t)})}})}},{async:216}],212:[function(e,t,n){var r=e("bindable"),i=e("underscore"),o=e("querystring");function s(e){r.Object.call(this,this);this.pathname=e.pathname;this.query=new r.Object(e.query||{});this.params=new r.Object(e.params||{});this.router=e.router;this._rebuildUrl=i.bind(this._rebuildUrl,this);this.query.on("change",this._rebuildUrl);this.params.on("change",this._rebuildUrl);this.on("change",this._rebuildUrl)}r.Object.extend(s,{__isRequest:true,equals:function(e){if(e.pathname!==this.pathname)return false;return true},redirect:function(e,t){this.router.redirect(e,t)},mergeQuery:function(e){var t=e.context();for(var n in t){if(this.query.has(n))continue;this.query.set(n,t[n])}},_rebuildUrl:function(){var e=this.get("pathname");if(this.query.keys().length){e+="?"+o.stringify(this.query.context())}this.set("url",e)}});t.exports=s},{bindable:219,querystring:65,underscore:241}],213:[function(e,t,n){var r=e("bindable"),i=e("async"),o=e("toarray"),s=e("mediocre");function a(e,t,n,i){r.Object.call(this,this);this.pathname=e;this.parent=i;this.options=t;this.routes=n;this.router=n.router;this.mediator=s();this._setPathInfo()}r.Object.extend(a,{enter:function(e,t){this.mediator.execute("enter",e,t)},exit:function(e,t){this.mediator.execute("exit",e,t)},match:function(e){if(e.pathname&&!this._matchPath(e.pathname))return false;return true},getParams:function(e){var t=this.pathname;var n=e.split("/"),r=t.split("/"),i={};for(var o=r.length;o--;){var s=r[o];if(s.substr(0,1)===":"){i[s.substr(1)]=n[o]}}return i},getPathnameWithParams:function(e){var t=this.pathname;for(var n in e){t=t.replace(":"+n,e[n])}return t},_matchPath:function(e){return this._pathTester.test(e)||this.options.name===e},_setPathInfo:function(){this.params=[];if(!this.pathname)return;this._pathTester=new RegExp("^"+this.pathname.replace(/\/\:[^\/]+/g,"/[^/]+")+"$");var e=this.pathname.match(/\/\:[^\/]+/g)||[];for(var t=e.length;t--;){this.params.unshift(e[t].substr(2))}}});t.exports=a},{async:216,bindable:219,mediocre:235,toarray:240}],214:[function(e,t,n){(function(n){var r=e("protoclass"),i=e("bindable"),o=e("./request"),s=e("./routes"),a=e("url"),u=e("async"),c=e("comerr"),f=e("underscore");function l(t){i.Object.call(this,this);this.routes=new s(this);this.use(e("./plugins/param"))}i.Object.extend(l,{use:function(){for(var e=arguments.length;e--;){arguments[e](this)}return this},init:function(){this.emit("init")},redirect:function(e,t,r){if(!t)t={};if(typeof t==="function"){r=t;t={}}if(!r)r=function(){};var i=a.parse(e,true);var s=this.routes.find(i);if(!s){var f=c.notFound("path "+e+" not found");this.emit("error",f);return r(f)}if(s.options.name===i.pathname){i=a.parse(s.getPathnameWithParams(t.params));i.query=t.query;i.params=t.params}else{i.params=s.getParams(i.pathname)}i.router=this;var l=this._location,p=this,h=new o(i);h.setProperties({previousRequest:l,route:s});if(l){if(l.equals(h)){l.query.setProperties(i.query);return r(null,l)}else{h.mergeQuery(l.query)}}this.set("_location",h);p.bind("location",{max:1,to:function(e){n.nextTick(function(){r(null,e)})}});u.waterfall([function d(e){if(!l)return e();l.route.exit(h,e)},function v(e){h.route.enter(h,e)},function(){p.set("location",h)}])},add:function(e){this.routes.add(e);return this}});t.exports=l}).call(this,e("OpdoqP"))},{"./plugins/param":211,"./request":212,"./routes":215,OpdoqP:61,async:216,bindable:219,comerr:227,protoclass:239,underscore:241,url:66}],215:[function(e,t,n){var r=e("bindable"),i=e("./route"),o=e("./decorators");function s(e){this._source=[];this.router=e;this.decorators=new o}r.Object.extend(s,{add:function(e,t){if(!e)return;if(!t)this.decorators.decorate(t=new i(null,e,this));for(var n in e){if(n.substr(0,1)==="/"){var r=e[n],o=(t.pathname||"")+n,s;this._source.push(this.decorators.decorate(s=new i(o,r,this,t)));this.add(r.routes||r,s)}}this._resort();return this},all:function(){return this._source},find:function(e){for(var t=this._source.length;t--;){var n=this._source[t];if(n.match(e))return n}},_resort:function(){this._source=this._source.sort(function(e,t){var n=e.pathname.split("/"),r=t.pathname.split("/");if(n.length>r.length){return-1}else if(n.length<r.length){return 1}for(var i=0,o=n.length;i<o;i++){var s=n[i],a=r[i];if(s!==a)if(s.substr(0,1)===":"){return-1}else{return 1}}return 1})}});t.exports=s},{"./decorators":204,"./route":213,bindable:219}],216:[function(e,t,n){t.exports=e(75)},{OpdoqP:61}],217:[function(e,t,n){t.exports=e(23)},{"../object":220,"../utils/computed":223,sift:225}],218:[function(e,t,n){t.exports=e(24)},{protoclass:239}],219:[function(e,t,n){t.exports=e(25)},{"./collection":217,"./core/eventEmitter":218,"./object":220,"./utils/computed":223,"./utils/options":224}],220:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":218,"./watchProperty":222,protoclass:239}],221:[function(e,t,n){t.exports=e(27)},{toarray:240,underscore:226}],222:[function(e,t,n){t.exports=e(28)},{"../utils/options":224,"./transform":221,underscore:226}],223:[function(e,t,n){t.exports=e(29)},{toarray:240}],224:[function(e,t,n){t.exports=e(30)},{}],225:[function(e,t,n){t.exports=e(32)},{}],226:[function(e,t,n){t.exports=e(34)},{}],227:[function(e,t,n){var r={401:"Unauthorized",402:"Payment Required",404:"Not Found",403:"Forbidden",408:"Timeout",423:"Locked",429:"Too Many Requests",500:"Unknown",501:"Not Implemented",601:"Incorrect Input",602:"Invalid",604:"Already Exists",605:"Expired",606:"Unable To Connect",607:"Already Called",608:"Not Enough Info",609:"Incorrect Type"};n.codes={};n.byCode={};n.register=function(e){Object.keys(e).forEach(function(t){var r=e[t],i=r,o=r.replace(/\s+/g,"");if(n[o]){throw new Error("Error code '"+t+"' already exists.")}function s(e,n){e.code=t;if(n)e.tags=n;return e}var a=n[o]=function(e,t){Error.call(this,e);this.message=e||r;this.stack=new Error(this.message).stack;s(this)};a.prototype=new Error;a.prototype.constructor=a;a.prototype.name=r;n.byCode[t]=a;n.codes[o]=t;n[o.substr(0,1).toLowerCase()+o.substr(1)]=a.fn=function(e,t){return s(new Error(e||r),t)}})};n.fromCode=function(e,t){var r=n.byCode[Number(e)]||n.Unknown;return r.fn(t)};n.register(r)},{}],228:[function(e,t,n){(function(){var r=function(e){var t=function(t){var n=25,r=t.document,i=t.history,o=e.Signal,s,a,u,c,f,l,p=/#(.*)$/,h=/(\?.*)|(\#.*)/,d=/^\#/,v=!+"1",m="onhashchange"in t&&r.documentMode!==7,g=v&&!m,y=location.protocol==="file:";function _(e){return String(e||"").replace(/\W/g,"\\$&")}function b(e){if(!e)return"";var t=new RegExp("^"+_(s.prependHash)+"|"+_(s.appendHash)+"$","g");return e.replace(t,"")}function w(){var e=p.exec(s.getURL());var t=e&&e[1]||"";try{return s.raw?t:decodeURIComponent(t)}catch(n){return t}}function x(){return f?f.contentWindow.frameHash:null}function k(){f=r.createElement("iframe");f.src="about:blank";f.style.display="none";r.body.appendChild(f)}function E(){if(f&&a!==x()){var e=f.contentWindow.document;e.open();e.write("<html><head><title>"+r.title+'</title><script type="text/javascript">var frameHash="'+a+'";</script></head><body>&nbsp;</body></html>');e.close()}}function O(e,t){if(a!==e){var n=a;a=e;if(g){if(!t){E()}else{f.contentWindow.frameHash=e}}s.changed.dispatch(b(e),b(n))}}if(g){l=function(){var e=w(),t=x();if(t!==a&&t!==e){s.setHash(b(t))}else if(e!==a){O(e)}}}else{l=function(){var e=w();if(e!==a){O(e)}}}function j(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}}function S(e,t,n){if(e.removeEventListener){e.removeEventListener(t,n,false)}else if(e.detachEvent){e.detachEvent("on"+t,n)}}function A(e){e=Array.prototype.slice.call(arguments);var t=e.join(s.separator);t=t?s.prependHash+t.replace(d,"")+s.appendHash:t;return t}function C(e){e=encodeURI(e);if(v&&y){e=e.replace(/\?/,"%3F")}return e}s={VERSION:"1.2.0",raw:false,appendHash:"",prependHash:"/",separator:"/",changed:new o,stopped:new o,initialized:new o,init:function(){if(c)return;a=w();if(m){j(t,"hashchange",l)}else{if(g){if(!f){k()}E()}u=setInterval(l,n)}c=true;s.initialized.dispatch(b(a))},stop:function(){if(!c)return;if(m){S(t,"hashchange",l)}else{clearInterval(u);u=null}c=false;s.stopped.dispatch(b(a))},isActive:function(){return c},getURL:function(){return t.location.href},getBaseURL:function(){return s.getURL().replace(h,"")},setHash:function(e){e=A.apply(null,arguments);if(e!==a){O(e);if(e===a){if(!s.raw){e=C(e)}t.location.hash="#"+e}}},replaceHash:function(e){e=A.apply(null,arguments);if(e!==a){O(e,true);if(e===a){if(!s.raw){e=C(e)}t.location.replace("#"+e)}}},getHash:function(){return b(a)},getHashAsArray:function(){return s.getHash().split(s.separator)},dispose:function(){s.stop();s.initialized.dispose();s.stopped.dispose();s.changed.dispose();f=s=t.hasher=null},toString:function(){return'[hasher version="'+s.VERSION+'" hash="'+s.getHash()+'"]'}};s.initialized.memorize=true;return s}(window);return t};if(typeof define==="function"&&define.amd){define(["signals"],r)}else if(typeof n==="object"){t.exports=r(e("signals"))}else{window["hasher"]=r(window["signals"])}})()},{signals:229}],229:[function(e,t,n){(function(e){function n(e,t,n,r,i){this._listener=t;this._isOnce=n;this.context=r;this._signal=e;this._priority=i||0}n.prototype={active:true,params:null,execute:function(e){var t,n;if(this.active&&!!this._listener){n=this.params?this.params.concat(e):e;t=this._listener.apply(this.context,n);if(this._isOnce){this.detach()}}return t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};function r(e,t){if(typeof e!=="function"){throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}}function i(){this._bindings=[];this._prevParams=null;var e=this;this.dispatch=function(){i.prototype.dispatch.apply(e,arguments)}}i.prototype={VERSION:"1.0.0",memorize:false,_shouldPropagate:true,active:true,_registerListener:function(e,t,r,i){var o=this._indexOfListener(e,r),s;if(o!==-1){s=this._bindings[o];if(s.isOnce()!==t){throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(!t?"":"Once")+"() the same listener without removing the relationship first.")}}else{s=new n(this,e,t,r,i);this._addBinding(s)}if(this.memorize&&this._prevParams){s.execute(this._prevParams)}return s},_addBinding:function(e){var t=this._bindings.length;do{--t}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){var n=this._bindings.length,r;while(n--){r=this._bindings[n];if(r._listener===e&&r.context===t){return n}}return-1},has:function(e,t){return this._indexOfListener(e,t)!==-1},add:function(e,t,n){r(e,"add");return this._registerListener(e,false,t,n)},addOnce:function(e,t,n){r(e,"addOnce");return this._registerListener(e,true,t,n)},remove:function(e,t){r(e,"remove");var n=this._indexOfListener(e,t);if(n!==-1){this._bindings[n]._destroy();this._bindings.splice(n,1)}return e},removeAll:function(){var e=this._bindings.length;while(e--){this._bindings[e]._destroy()}this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=false},dispatch:function(e){if(!this.active){return}var t=Array.prototype.slice.call(arguments),n=this._bindings.length,r;if(this.memorize){this._prevParams=t}if(!n){return}r=this._bindings.slice();this._shouldPropagate=true;do{n--}while(r[n]&&this._shouldPropagate&&r[n].execute(t)!==false)},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var o=i;o.Signal=i;if(typeof define==="function"&&define.amd){define(function(){return o})}else if(typeof t!=="undefined"&&t.exports){t.exports=o}else{e["signals"]=o}})(this)},{}],230:[function(e,t,n){t.exports=e(68)},{async:216,"type-component":238}],231:[function(e,t,n){t.exports=e(69)},{"type-component":238}],232:[function(e,t,n){t.exports=e(70)},{"./collection":230,"./fn":231,"./obj":233,"./ref":234}],233:[function(e,t,n){t.exports=e(71)},{async:216,"type-component":238}],234:[function(e,t,n){t.exports=e(72)},{"type-component":238}],235:[function(e,t,n){t.exports=e(73)},{"./factory":232,"./factory/collection":230,"./message":236,async:216,protoclass:239,sift:237,"type-component":238}],236:[function(e,t,n){t.exports=e(74)},{bindable:219}],237:[function(e,t,n){t.exports=e(87)},{}],238:[function(e,t,n){t.exports=e(56)},{}],239:[function(e,t,n){t.exports=e(31)},{}],240:[function(e,t,n){t.exports=e(33)},{}],241:[function(e,t,n){(function(){var e=this;var r=e._;var i={};var o=Array.prototype,s=Object.prototype,a=Function.prototype;var u=o.push,c=o.slice,f=o.concat,l=s.toString,p=s.hasOwnProperty;var h=o.forEach,d=o.map,v=o.reduce,m=o.reduceRight,g=o.filter,y=o.every,_=o.some,b=o.indexOf,w=o.lastIndexOf,x=Array.isArray,k=Object.keys,E=a.bind;var O=function(e){if(e instanceof O)return e;if(!(this instanceof O))return new O(e);this._wrapped=e};if(typeof n!=="undefined"){if(typeof t!=="undefined"&&t.exports){n=t.exports=O}n._=O}else{e._=O}O.VERSION="1.6.0";var j=O.each=O.forEach=function(e,t,n){if(e==null)return e;if(h&&e.forEach===h){e.forEach(t,n)}else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++){if(t.call(n,e[r],r,e)===i)return}}else{var s=O.keys(e);for(var r=0,o=s.length;r<o;r++){if(t.call(n,e[s[r]],s[r],e)===i)return}}return e};O.map=O.collect=function(e,t,n){var r=[];if(e==null)return r;if(d&&e.map===d)return e.map(t,n);j(e,function(e,i,o){r.push(t.call(n,e,i,o))});return r};var S="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(v&&e.reduce===v){if(r)t=O.bind(t,r);return i?e.reduce(t,n):e.reduce(t)}j(e,function(e,o,s){if(!i){n=e;i=true}else{n=t.call(r,n,e,o,s)}});if(!i)throw new TypeError(S);return n};O.reduceRight=O.foldr=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(m&&e.reduceRight===m){if(r)t=O.bind(t,r);return i?e.reduceRight(t,n):e.reduceRight(t)}var o=e.length;if(o!==+o){var s=O.keys(e);o=s.length}j(e,function(a,u,c){u=s?s[--o]:--o;if(!i){n=e[u];i=true}else{n=t.call(r,n,e[u],u,c)}});if(!i)throw new TypeError(S);return n};O.find=O.detect=function(e,t,n){var r;A(e,function(e,i,o){if(t.call(n,e,i,o)){r=e;return true}});return r};O.filter=O.select=function(e,t,n){var r=[];if(e==null)return r;if(g&&e.filter===g)return e.filter(t,n);j(e,function(e,i,o){if(t.call(n,e,i,o))r.push(e)});return r};O.reject=function(e,t,n){return O.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)};O.every=O.all=function(e,t,n){t||(t=O.identity);var r=true;if(e==null)return r;if(y&&e.every===y)return e.every(t,n);j(e,function(e,o,s){if(!(r=r&&t.call(n,e,o,s)))return i});return!!r};var A=O.some=O.any=function(e,t,n){t||(t=O.identity);var r=false;if(e==null)return r;if(_&&e.some===_)return e.some(t,n);j(e,function(e,o,s){if(r||(r=t.call(n,e,o,s)))return i});return!!r};O.contains=O.include=function(e,t){if(e==null)return false;if(b&&e.indexOf===b)return e.indexOf(t)!=-1;return A(e,function(e){return e===t})};O.invoke=function(e,t){var n=c.call(arguments,2);var r=O.isFunction(t);return O.map(e,function(e){return(r?t:e[t]).apply(e,n)})};O.pluck=function(e,t){return O.map(e,O.property(t))};O.where=function(e,t){return O.filter(e,O.matches(t))};O.findWhere=function(e,t){return O.find(e,O.matches(t))};O.max=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}var r=-Infinity,i=-Infinity;j(e,function(e,o,s){var a=t?t.call(n,e,o,s):e;if(a>i){r=e;i=a}});return r};O.min=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}var r=Infinity,i=Infinity;j(e,function(e,o,s){var a=t?t.call(n,e,o,s):e;if(a<i){r=e;i=a}});return r};O.shuffle=function(e){var t;var n=0;var r=[];j(e,function(e){t=O.random(n++);r[n-1]=r[t];r[t]=e});return r};O.sample=function(e,t,n){if(t==null||n){if(e.length!==+e.length)e=O.values(e);return e[O.random(e.length-1)]}return O.shuffle(e).slice(0,Math.max(0,t))};var C=function(e){if(e==null)return O.identity;if(O.isFunction(e))return e;return O.property(e)};O.sortBy=function(e,t,n){t=C(t);return O.pluck(O.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria;var r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,r){var i={};n=C(n);j(t,function(o,s){var a=n.call(r,o,s,t);e(i,a,o)});return i}};O.groupBy=T(function(e,t,n){O.has(e,t)?e[t].push(n):e[t]=[n]});O.indexBy=T(function(e,t,n){e[t]=n});O.countBy=T(function(e,t){O.has(e,t)?e[t]++:e[t]=1});O.sortedIndex=function(e,t,n,r){n=C(n);var i=n.call(r,t);var o=0,s=e.length;while(o<s){var a=o+s>>>1;n.call(r,e[a])<i?o=a+1:s=a}return o};O.toArray=function(e){if(!e)return[];if(O.isArray(e))return c.call(e);if(e.length===+e.length)return O.map(e,O.identity);return O.values(e)};O.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:O.keys(e).length};O.first=O.head=O.take=function(e,t,n){if(e==null)return void 0;if(t==null||n)return e[0];if(t<0)return[];return c.call(e,0,t)};O.initial=function(e,t,n){return c.call(e,0,e.length-(t==null||n?1:t))};O.last=function(e,t,n){if(e==null)return void 0;if(t==null||n)return e[e.length-1];return c.call(e,Math.max(e.length-t,0))};O.rest=O.tail=O.drop=function(e,t,n){return c.call(e,t==null||n?1:t)};O.compact=function(e){return O.filter(e,O.identity)};var N=function(e,t,n){if(t&&O.every(e,O.isArray)){return f.apply(n,e)}j(e,function(e){if(O.isArray(e)||O.isArguments(e)){t?u.apply(n,e):N(e,t,n)}else{n.push(e)}});return n};O.flatten=function(e,t){return N(e,t,[])};O.without=function(e){return O.difference(e,c.call(arguments,1))};O.partition=function(e,t){var n=[],r=[];j(e,function(e){(t(e)?n:r).push(e)});return[n,r]};O.uniq=O.unique=function(e,t,n,r){if(O.isFunction(t)){r=n;n=t;t=false}var i=n?O.map(e,n,r):e;var o=[];var s=[];j(i,function(n,r){if(t?!r||s[s.length-1]!==n:!O.contains(s,n)){s.push(n);o.push(e[r])}});return o};O.union=function(){return O.uniq(O.flatten(arguments,true))};O.intersection=function(e){var t=c.call(arguments,1);return O.filter(O.uniq(e),function(e){return O.every(t,function(t){return O.contains(t,e)})})};O.difference=function(e){var t=f.apply(o,c.call(arguments,1));return O.filter(e,function(e){return!O.contains(t,e)})};O.zip=function(){var e=O.max(O.pluck(arguments,"length").concat(0));var t=new Array(e);for(var n=0;n<e;n++){t[n]=O.pluck(arguments,""+n)}return t};O.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++){if(t){n[e[r]]=t[r]}else{n[e[r][0]]=e[r][1]}}return n};O.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n=="number"){r=n<0?Math.max(0,i+n):n}else{r=O.sortedIndex(e,t);return e[r]===t?r:-1}}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1};O.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w){return r?e.lastIndexOf(t,n):e.lastIndexOf(t)}var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1};O.range=function(e,t,n){if(arguments.length<=1){t=e||0;e=0}n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0);var i=0;var o=new Array(r);while(i<r){o[i++]=e;e+=n}return o};var q=function(){};O.bind=function(e,t){var n,r;if(E&&e.bind===E)return E.apply(e,c.call(arguments,1));if(!O.isFunction(e))throw new TypeError;n=c.call(arguments,2);return r=function(){if(!(this instanceof r))return e.apply(t,n.concat(c.call(arguments)));q.prototype=e.prototype;var i=new q;q.prototype=null;var o=e.apply(i,n.concat(c.call(arguments)));if(Object(o)===o)return o;return i}};O.partial=function(e){var t=c.call(arguments,1);return function(){var n=0;var r=t.slice();for(var i=0,o=r.length;i<o;i++){if(r[i]===O)r[i]=arguments[n++]}while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}};O.bindAll=function(e){var t=c.call(arguments,1);
if(t.length===0)throw new Error("bindAll must be passed function names");j(t,function(t){e[t]=O.bind(e[t],e)});return e};O.memoize=function(e,t){var n={};t||(t=O.identity);return function(){var r=t.apply(this,arguments);return O.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}};O.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)};O.defer=function(e){return O.delay.apply(O,[e,1].concat(c.call(arguments,1)))};O.throttle=function(e,t,n){var r,i,o;var s=null;var a=0;n||(n={});var u=function(){a=n.leading===false?0:O.now();s=null;o=e.apply(r,i);r=i=null};return function(){var c=O.now();if(!a&&n.leading===false)a=c;var f=t-(c-a);r=this;i=arguments;if(f<=0){clearTimeout(s);s=null;a=c;o=e.apply(r,i);r=i=null}else if(!s&&n.trailing!==false){s=setTimeout(u,f)}return o}};O.debounce=function(e,t,n){var r,i,o,s,a;var u=function(){var c=O.now()-s;if(c<t){r=setTimeout(u,t-c)}else{r=null;if(!n){a=e.apply(o,i);o=i=null}}};return function(){o=this;i=arguments;s=O.now();var c=n&&!r;if(!r){r=setTimeout(u,t)}if(c){a=e.apply(o,i);o=i=null}return a}};O.once=function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}};O.wrap=function(e,t){return O.partial(t,e)};O.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--){t=[e[n].apply(this,t)]}return t[0]}};O.after=function(e,t){return function(){if(--e<1){return t.apply(this,arguments)}}};O.keys=function(e){if(!O.isObject(e))return[];if(k)return k(e);var t=[];for(var n in e)if(O.has(e,n))t.push(n);return t};O.values=function(e){var t=O.keys(e);var n=t.length;var r=new Array(n);for(var i=0;i<n;i++){r[i]=e[t[i]]}return r};O.pairs=function(e){var t=O.keys(e);var n=t.length;var r=new Array(n);for(var i=0;i<n;i++){r[i]=[t[i],e[t[i]]]}return r};O.invert=function(e){var t={};var n=O.keys(e);for(var r=0,i=n.length;r<i;r++){t[e[n[r]]]=n[r]}return t};O.functions=O.methods=function(e){var t=[];for(var n in e){if(O.isFunction(e[n]))t.push(n)}return t.sort()};O.extend=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){e[n]=t[n]}}});return e};O.pick=function(e){var t={};var n=f.apply(o,c.call(arguments,1));j(n,function(n){if(n in e)t[n]=e[n]});return t};O.omit=function(e){var t={};var n=f.apply(o,c.call(arguments,1));for(var r in e){if(!O.contains(n,r))t[r]=e[r]}return t};O.defaults=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){if(e[n]===void 0)e[n]=t[n]}}});return e};O.clone=function(e){if(!O.isObject(e))return e;return O.isArray(e)?e.slice():O.extend({},e)};O.tap=function(e,t){t(e);return e};var I=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof O)e=e._wrapped;if(t instanceof O)t=t._wrapped;var i=l.call(e);if(i!=l.call(t))return false;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var o=n.length;while(o--){if(n[o]==e)return r[o]==t}var s=e.constructor,a=t.constructor;if(s!==a&&!(O.isFunction(s)&&s instanceof s&&O.isFunction(a)&&a instanceof a)&&("constructor"in e&&"constructor"in t)){return false}n.push(e);r.push(t);var u=0,c=true;if(i=="[object Array]"){u=e.length;c=u==t.length;if(c){while(u--){if(!(c=I(e[u],t[u],n,r)))break}}}else{for(var f in e){if(O.has(e,f)){u++;if(!(c=O.has(t,f)&&I(e[f],t[f],n,r)))break}}if(c){for(f in t){if(O.has(t,f)&&!u--)break}c=!u}}n.pop();r.pop();return c};O.isEqual=function(e,t){return I(e,t,[],[])};O.isEmpty=function(e){if(e==null)return true;if(O.isArray(e)||O.isString(e))return e.length===0;for(var t in e)if(O.has(e,t))return false;return true};O.isElement=function(e){return!!(e&&e.nodeType===1)};O.isArray=x||function(e){return l.call(e)=="[object Array]"};O.isObject=function(e){return e===Object(e)};j(["Arguments","Function","String","Number","Date","RegExp"],function(e){O["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}});if(!O.isArguments(arguments)){O.isArguments=function(e){return!!(e&&O.has(e,"callee"))}}if(typeof/./!=="function"){O.isFunction=function(e){return typeof e==="function"}}O.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};O.isNaN=function(e){return O.isNumber(e)&&e!=+e};O.isBoolean=function(e){return e===true||e===false||l.call(e)=="[object Boolean]"};O.isNull=function(e){return e===null};O.isUndefined=function(e){return e===void 0};O.has=function(e,t){return p.call(e,t)};O.noConflict=function(){e._=r;return this};O.identity=function(e){return e};O.constant=function(e){return function(){return e}};O.property=function(e){return function(t){return t[e]}};O.matches=function(e){return function(t){if(t===e)return true;for(var n in e){if(e[n]!==t[n])return false}return true}};O.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r};O.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};O.now=Date.now||function(){return(new Date).getTime()};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=O.invert(R.escape);var B={escape:new RegExp("["+O.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(R.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(e){O[e]=function(t){if(t==null)return"";return(""+t).replace(B[e],function(t){return R[e][t]})}});O.result=function(e,t){if(e==null)return void 0;var n=e[t];return O.isFunction(n)?n.call(e):n};O.mixin=function(e){j(O.functions(e),function(t){var n=O[t]=e[t];O.prototype[t]=function(){var e=[this._wrapped];u.apply(e,arguments);return M.call(this,n.apply(O,e))}})};var L=0;O.uniqueId=function(e){var t=++L+"";return e?e+t:t};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/;var F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var P=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(e,t,n){var r;n=O.defaults({},n,O.templateSettings);var i=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g");var o=0;var s="__p+='";e.replace(i,function(t,n,r,i,a){s+=e.slice(o,a).replace(P,function(e){return"\\"+F[e]});if(n){s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"}if(r){s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}if(i){s+="';\n"+i+"\n__p+='"}o=a+t.length;return t});s+="';\n";if(!n.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(n.variable||"obj","_",s)}catch(a){a.source=s;throw a}if(t)return r(t,O);var u=function(e){return r.call(this,e,O)};u.source="function("+(n.variable||"obj")+"){\n"+s+"}";return u};O.chain=function(e){return O(e).chain()};var M=function(e){return this._chain?O(e).chain():e};O.mixin(O);j(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];O.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);if((e=="shift"||e=="splice")&&n.length===0)delete n[0];return M.call(this,n)}});j(["concat","join","slice"],function(e){var t=o[e];O.prototype[e]=function(){return M.call(this,t.apply(this._wrapped,arguments))}});O.extend(O.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}});if(typeof define==="function"&&define.amd){define("underscore",[],function(){return O})}}).call(this)},{}],242:[function(e,t,n){t.exports=e(118)},{"./paper":276}],243:[function(e,t,n){t.exports=e(119)},{"./index":244,bindable:288,protoclass:320,underscore:323}],244:[function(e,t,n){t.exports=e(120)},{"./ref":245,OpdoqP:61,bindable:288,dref:295,protoclass:320,"type-component":322,underscore:323}],245:[function(e,t,n){t.exports=e(121)},{protoclass:320,underscore:323}],246:[function(e,t,n){t.exports=e(122)},{protoclass:320}],247:[function(e,t,n){t.exports=e(123)},{protoclass:320}],248:[function(e,t,n){t.exports=e(124)},{protoclass:320}],249:[function(e,t,n){t.exports=e(125)},{"./binding":248,protoclass:320}],250:[function(e,t,n){t.exports=e(126)},{"./base/binding":248,"./collection":256}],251:[function(e,t,n){t.exports=e(127)},{"../base/script":249}],252:[function(e,t,n){t.exports=e(128)},{"./base":251}],253:[function(e,t,n){t.exports=e(129)},{"../../../clip":244,"../collection":256,"./conditional":252,"./html":254,"./value":255,loaf:296,protoclass:320}],254:[function(e,t,n){t.exports=e(130)},{"./base":251,"type-component":322}],255:[function(e,t,n){t.exports=e(131)},{"./base":251,protoclass:320}],256:[function(e,t,n){t.exports=e(132)},{"./base/binding":248}],257:[function(e,t,n){arguments[4][133][0].apply(n,arguments)},{"./block/base":251,"./block/factory":253,"./node/attrs/dataBind/handlers/base":258,"./node/base":272,"./node/factory":273}],258:[function(e,t,n){t.exports=e(134)},{"../../../../base/script":249}],259:[function(e,t,n){t.exports=e(135)},{"./event":265,underscore:323}],260:[function(e,t,n){t.exports=e(136)},{"./base":258}],261:[function(e,t,n){t.exports=e(137)},{"./event":265}],262:[function(e,t,n){t.exports=e(138)},{"./base":258}],263:[function(e,t,n){t.exports=e(139)},{"./base":258}],264:[function(e,t,n){t.exports=e(140)},{"./event":265}],265:[function(e,t,n){t.exports=e(141)},{"./base":258,underscore:323}],266:[function(e,t,n){t.exports=e(142)},{"./base":258,protoclass:320}],267:[function(e,t,n){t.exports=e(143)},{"./base":258,"./change":259,OpdoqP:61,dref:295,"type-component":322,underscore:323}],268:[function(e,t,n){t.exports=e(144)},{"./base":258}],269:[function(e,t,n){t.exports=e(145)},{"./base":258,OpdoqP:61}],270:[function(e,t,n){var r=e("../../../../../clip"),i=e("../../../collection"),o=e("../../base");var s={show:e("./handlers/show"),css:e("./handlers/css"),style:e("./handlers/style"),focus:e("./handlers/focus"),disable:e("./handlers/disable"),enable:e("./handlers/enable"),model:e("./handlers/model"),onClick:e("./handlers/event"),onLoad:e("./handlers/event"),onSubmit:e("./handlers/event"),onMouseDown:e("./handlers/event"),onMouseMove:e("./handlers/event"),onMouseUp:e("./handlers/event"),onMouseOver:e("./handlers/event"),onMouseOut:e("./handlers/event"),onFocusIn:e("./handlers/event"),onFocusOut:e("./handlers/event"),onKeyDown:e("./handlers/event"),onKeyUp:e("./handlers/event"),onEnter:e("./handlers/enter"),onChange:e("./handlers/change"),onDelete:e("./handlers/delete")};function a(e){o.call(this,e);this.clip=new r({scripts:e.value[0],watch:false,application:e.application});this._bindings=new i;for(var t=0,n=this.clip.scripts.names.length;t<n;t++){var a=this.clip.scripts.names[t],u;if(!(u=s[a]))continue;this._bindings.push(new u(e.application,this.node,this.clip,a))}}o.extend(a,{type:"attr",bind:function(e){this.context=e;this.clip.reset(e,false);this._bindings.bind(e)},unbind:function(){this._bindings.unbind();this.clip.dispose()}});t.exports=a;t.exports.register=function(e,t){s[e]=t}},{"../../../../../clip":244,"../../../collection":256,"../../base":272,"./handlers/change":259,"./handlers/css":260,"./handlers/delete":261,"./handlers/disable":262,"./handlers/enable":263,"./handlers/enter":264,"./handlers/event":265,"./handlers/focus":266,"./handlers/model":267,"./handlers/show":268,"./handlers/style":269}],271:[function(e,t,n){t.exports=e(147)},{"../../../../../clip/buffer":243,"../../base":272,"type-component":322,underscore:323}],272:[function(e,t,n){t.exports=e(148)},{"../../base/binding":248}],273:[function(e,t,n){arguments[4][149][0].apply(n,arguments)},{"./attrs/dataBind":270,"./attrs/text":271,protoclass:320,underscore:323}],274:[function(e,t,n){t.exports=e(150)},{"../base/binder":247,"./binding":275,protoclass:320}],275:[function(e,t,n){t.exports=e(151)},{"../../../clip/buffer":243,"../base/binding":248,protoclass:320,underscore:323}],276:[function(e,t,n){t.exports=e(152)},{"../clip":244,"./bindings":257,"./modifiers":277,"./template":278,bindable:288,"mojo-application":22,nofactor:302}],277:[function(e,t,n){t.exports=e(153)},{}],278:[function(e,t,n){t.exports=e(154)},{"./binding":246,"./bindings/binders":250,"./bindings/collection":256,"./modifiers":277,"./writers/block":280,"./writers/element":281,"./writers/fragment":282,"./writers/parse":283,"./writers/text":284,"./writers/textBlock":285,OpdoqP:61,bindable:288,loaf:296,"mojo-animator":298,"mojo-application":22,nofactor:302,protoclass:320}],279:[function(e,t,n){t.exports=e(155)},{protoclass:320,underscore:323}],280:[function(e,t,n){t.exports=e(156)},{"../../clip":244,"../bindings/block/factory":253,"./base":279,loaf:296}],281:[function(e,t,n){arguments[4][157][0].apply(n,arguments)},{"../bindings/node/factory":273,"./base":279,"type-component":322}],282:[function(e,t,n){t.exports=e(158)},{"./base":279}],283:[function(e,t,n){t.exports=e(159)},{"./base":279,OpdoqP:61}],284:[function(e,t,n){t.exports=e(160)},{"./base":279}],285:[function(e,t,n){t.exports=e(161)},{"../bindings/textBlock/binder":274,"./base":279}],286:[function(e,t,n){arguments[4][23][0].apply(n,arguments)},{"../object":289,"../utils/computed":292,sift:321}],287:[function(e,t,n){t.exports=e(24)},{protoclass:320}],288:[function(e,t,n){arguments[4][25][0].apply(n,arguments)},{"./collection":286,"./core/eventEmitter":287,"./object":289,"./utils/computed":292,"./utils/options":293}],289:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":287,"./watchProperty":291,protoclass:320}],290:[function(e,t,n){t.exports=e(27)},{toarray:294,underscore:323}],291:[function(e,t,n){t.exports=e(28)},{"../utils/options":293,"./transform":290,underscore:323}],292:[function(e,t,n){t.exports=e(29)},{toarray:294}],293:[function(e,t,n){t.exports=e(30)},{}],294:[function(e,t,n){t.exports=e(33)},{}],295:[function(e,t,n){t.exports=e(171)},{"type-component":322}],296:[function(e,t,n){t.exports=e(172)},{nofactor:302,protoclass:320}],297:[function(e,t,n){t.exports=e(173)},{OpdoqP:61,protoclass:320}],298:[function(e,t,n){t.exports=e(174)},{"./animator":297}],299:[function(e,t,n){t.exports=e(35)},{protoclass:320}],300:[function(e,t,n){t.exports=e(36)},{"./base":299,factories:319}],301:[function(e,t,n){t.exports=e(37)},{"./base":299}],302:[function(e,t,n){t.exports=e(38)},{"./custom":300,"./dom":301,"./string":308}],303:[function(e,t,n){t.exports=e(39)},{"./text":311}],304:[function(e,t,n){t.exports=e(40)},{"./node":309}],305:[function(e,t,n){t.exports=e(41)},{"./container":304,"./style":310}],306:[function(e,t,n){t.exports=e(42)},{}],307:[function(e,t,n){t.exports=e(43)},{"./container":304}],308:[function(e,t,n){t.exports=e(44)},{"../base":299,"./comment":303,"./container":304,"./element":305,"./fragment":307,"./text":311,"./voidElements":312}],309:[function(e,t,n){t.exports=e(45)},{protoclass:320}],310:[function(e,t,n){t.exports=e(46)},{protoclass:320}],311:[function(e,t,n){t.exports=e(47)},{"./ent":306,"./node":309}],312:[function(e,t,n){t.exports=e(48)},{"./element":305}],313:[function(e,t,n){t.exports=e(49)},{"./base":314,"./factory":316}],314:[function(e,t,n){t.exports=e(50)},{}],315:[function(e,t,n){t.exports=e(51)},{"./base":314}],316:[function(e,t,n){t.exports=e(52)},{"./base":314,"./class":315,"./fn":317,"type-component":322}],317:[function(e,t,n){t.exports=e(53)},{}],318:[function(e,t,n){t.exports=e(54)},{"./base":314,"./factory":316}],319:[function(e,t,n){t.exports=e(55)},{"./any":313,"./class":315,"./factory":316,"./fn":317,"./group":318}],320:[function(e,t,n){t.exports=e(31)},{}],321:[function(e,t,n){t.exports=e(196)},{}],322:[function(e,t,n){t.exports=e(56)},{}],323:[function(e,t,n){t.exports=e(34)},{}],324:[function(e,t,n){var r=e("./views"),i=e("./plugins/decor"),o=e("./plugins/defaultComponents"),s=e("mojo-registered-classes");var a=t.exports=function(e){e.views=new s(e);e.use(o);e.use(i)};var u=t.exports.Application=e("mojo-application");t.exports.Base=r.Base;t.exports.List=r.List;t.exports.States=r.States;var c=u.main;c.use(e("mojo-animator"));c.use(a);t.exports.application=function(t){var n=new u(t);n.use(e("mojo-animator"));n.use(a);return n};t.exports.mainApplication=c;r.Base.defaultApplication=c},{"./plugins/decor":326,"./plugins/defaultComponents":328,"./views":330,"mojo-animator":359,"mojo-application":22,"mojo-registered-classes":360}],325:[function(t,n,r){var i=t("protoclass"),o=t("janitorjs"),s=t("underscore");function a(e,t){this.view=e;this.events=t;this.render=s.bind(this.render,this);this.remove=s.bind(this.remove,this);e.once("render",this.render);e.once("dispose",this.remove)}i(a,{render:function(){e=this._events();this._disposeBindings();this._janitor=o();for(var t in e){this._addBinding(t,e[t])}},remove:function(){this._disposeBindings()},_addBinding:function(e,t){var n=e.split(" "),r=n.shift().split(/\//g).join(" "),i=n.join(","),o=this,s;function a(){var e;if(typeof t==="function"){e=t}else{e=o.view.get(t)}e.apply(o.view,arguments)}if(!i.length){s=this.view.$()}else{s=this.view.$(i)}s.bind(lowerActions=r.toLowerCase(),a);r.split(" ").forEach(function(e){o._janitor.add(o.view.on(e,function(){a.apply(o,[$.Event(e)].concat(Array.prototype.slice.call(arguments)))}))});this._janitor.add(function(){s.unbind(lowerActions,a)})},_disposeBindings:function(){if(!this._janitor)return;this._janitor.dispose();this._janitor=undefined},_events:function(){return this.events}});a.priority="display";a.getOptions=function(e){return e.events};a.decorate=function(e,t){return new a(e,t)};n.exports=a},{janitorjs:356,protoclass:377,underscore:382}],326:[function(e,t,n){var r=e("./events"),i=e("./sections"),o=e("bindable-decor-bindings"),s=e("frills");t.exports=function(e){var t=s();t.priority("init",0).priority("load",1).priority("render",2).priority("display",3).use(o("render"),r,i);e.views.decorate=function(e,n){t.decorate(e,n)};e.views.decorator=function(e){return t.use(e)}}},{"./events":325,"./sections":327,"bindable-decor-bindings":334,frills:355}],327:[function(e,t,n){var r=e("type-component"),i=e("protoclass"),o=e("underscore");function s(e,t){this.view=e;this.sectionOptions=t;e.sections={__decorated:true};e.once("render",o.bind(this.init,this))}i(s,{init:function(){for(var e in this.sectionOptions){this._addSection(e,this._fixOptions(this.sectionOptions[e]))}},_addSection:function(e,t){if(!t)return;var n=this._createSectionView(t);n.once("render",function(){n.decorate(t)});this.view.setChild(e,n)},_fixOptions:function(e){if(!e){throw new Error("'sections' is invalid for view '"+this.view.path+"'")}if(!e.type){e={type:e}}return e},_createSectionView:function(e){var t;if((t=r(e.type))==="object"){return e.type}else if(t==="function"){return new e.type(e)}else if(t==="string"){return this.view.application.views.create(e.type,e)}else{throw new Error("cannot create section for type '"+t+"'")}}});s.priority="init";s.getOptions=function(e){if(e.sections&&!e.sections.__decorated){return e.sections}};s.decorate=function(e,t){return new s(e,t)};t.exports=s},{protoclass:377,"type-component":381,underscore:382}],328:[function(e,t,n){var r=e("../views");t.exports=function(e){e.views.register({list:r.List,states:r.States,Base:r.Base})}},{"../views":330}],329:[function(e,t,n){(function(n){var r=e("protoclass"),i=e("loaf"),o=e("subindable").Object,s=e("janitorjs"),a=e("runlater")(1,100),u=e("underscore"),c=e("../../plugins/decor");function f(e,t){o.call(this,this);this._onParent=u.bind(this._onParent,this);this.application=t;this["this"]=this;this.initialize(e)}r(o,f,{_rendered:false,__isView:true,define:["sections","states"],disposable:function(e){if(!this._janitor){this._janitor=s()}this._janitor.add(e)},reset:function(e){if(e){for(var t in e){this[t]=e[t]}}if(this.parent)this._onParent(this.parent)},initialize:function(e){this.on("change:parent",this._onParent);this.reset(e);if(this.application)this._initDecor()},_initDecor:function(){if(!this.application){this.application=f.defaultApplication}this._decorated=true;if(!this.section){this.section=i(this.application.nodeFactory);this.models=this.application.models}this.application.views.decorate(this,this.constructor.prototype)},path:function(){var e=[],t=this;while(t){e.unshift(t.constructor.name);t=t.parent}return e.join(".")},render:function(){if(this._rendered)return this.section.render();this._rendered=true;if(this._cleanupJanitor){this._cleanupJanitor.dispose();this._cleanupJanitor=undefined}if(!this._decorated){this._initDecor()}this.willRender();this.emit("render");var e=this.section.render();this.didRender();return e},willRender:function(){this._render(this.section.show())},didRender:function(){},_render:function(e){},remove:function(){if(this.section&&(!this.parent||this.parent._rendered)){if(this._rendered){this.willRemove();this.emit("remove")}this.section.remove();this.didRemove()}this._rendered=false},willRemove:function(){},didRemove:function(){},$:function(e){if(!this.section)return $();var t=$(this.section.getChildNodes());if(arguments.length){return t.find(e).andSelf().filter(e)}return t},setChild:function(e,t){t.set("parent",this);this.set("sections."+e,t)},decorate:function(e){this.application.views.decorate(this,e);return this},dispose:function(){this.remove();if(this._parentRemoveListener)this._parentRemoveListener.dispose();if(this._parentDisposeListener)this._parentDisposeListener.dispose();this._parentRemoveListener=undefined;this._parentDisposeListener=undefined;if(this.section)this.section.remove();if(this._janitor)this._janitor.dispose();this.set("parent",undefined);o.prototype.dispose.call(this)},bubble:function(){this.emit.apply(this,arguments);if(this.parent)this.parent.bubble.apply(this.parent,arguments)},_onParent:function(e){if(this._parentRemoveListener)this._parentRemoveListener.dispose();if(this._parentDisposeListener)this._parentDisposeListener.dispose();if(!this._initParent){this._initParent=true;this._removeLater=u.bind(this._removeLater,this);this._disposeLater=u.bind(this._disposeLater,this)}this.inherit("application");if(!e)return;this._parentRemoveListener=e.on("remove",this._removeLater);this._parentDisposeListener=e.on("dispose",this._disposeLater)},_removeLater:function(){var e=this;if(!n.browser)return this.remove();this.__cleanupJanitor().add(a(function(){e.remove()}))},_disposeLater:function(){var e=this;if(!n.browser)return this.dispose();this.__cleanupJanitor().add(a(function(){e.dispose()}))},__cleanupJanitor:function(){return this._cleanupJanitor||(this._cleanupJanitor=s())}});t.exports=f}).call(this,e("OpdoqP"))},{"../../plugins/decor":326,OpdoqP:61,janitorjs:356,loaf:357,protoclass:377,runlater:378,subindable:379,underscore:382}],330:[function(e,t,n){t.exports={Base:e("./base"),List:e("./list"),States:e("./states")}},{"./base":329,"./list":331,"./states":332}],331:[function(e,t,n){(function(n){var r=e("protoclass"),i=e("bindable"),o=e("type-component"),s=e("factories"),a=e("janitorjs"),u=e("../base"),c=e("underscore"),f=e("runlater").global,l=e("poolparty");function p(e,t){p.parent.call(this,e,t)}function h(e){var t,n,r=this;return n=function(n){if(t){t.dispose();t=undefined}if(typeof n==="string"){t=r.bind(n,e).now()}else{e(n)}}}r(u,p,{chunk:10,delay:0,__isList:true,define:["filter","sort","map","length","modelViewFactory","modelViewClass","viewClass","source"],initialize:function(e){p.__super__.initialize.call(this,e);this._insertQueue=[];this._views=this.children=new i.Collection;this._views.bind("length",{target:this,to:"length"}).now();var t=this.modelViewFactory||this.modelViewClass||this.viewClass,n=this;if(typeof t==="function"){this._modelViewFactory=s.factory.create(t)}else{this._modelViewFactory=s.factory.create(function(e){return n.application.createView(t,e)})}this._onFilterChange=c.bind(this._onFilterChange,this);this._onSourceChange=c.bind(this._onSourceChange,this);this._onSortChange=c.bind(this._onSortChange,this);this._onInsertModel=c.bind(this._onInsertModel,this);this._onReplaceModels=c.bind(this._onReplaceModels,this);this._onResetModels=c.bind(this._onResetModels,this);this._onRemoveModel=c.bind(this._onRemoveModel,this);this._onMapChange=c.bind(this._onMapChange,this);this._insertNow=c.bind(this._insertNow,this)},_render:function(){p.__super__._render.call(this);if(!n.browser||this.application.fake){this.delay=false}if(this._bindingJanitor){this._bindingJanitor.dispose()}this._bindingJanitor=a();this._bindingJanitor.add(this.bind("sort",h.call(this,this._onSortChange)).now()).add(this.bind("map",h.call(this,this._onMapChange)).now()).add(this.bind("filter",h.call(this,this._onFilterChange)).now()).add(this.bind("source",h.call(this,this._onSourceChange)).now())},_onSourceChange:function(e){var t=Date.now();if(e===this._source)return;if(this._sjanitor)this._sjanitor.dispose();this._insertQueue=[];if(o(e)==="array"){e=new i.Collection(e)}this._source=e;var n=this._sjanitor=a();this._removeAllViews();if(!e)return;if(!e.__isBindableCollection){throw new Error("source must be a bindable Collection for "+this.path())}n.add(e.on("insert",this._onInsertModel)).add(e.on("remove",this._onRemoveModel)).add(e.on("reset",this._onResetModels)).add(e.on("replace",this._onReplaceModels));this._onResetModels(e.source())},_onMapChange:function(e){this._map=e},_removeAllViews:function(){this.section.removeAll();for(var e=this._views.length;e--;){this._views.at(e).dispose()}this._views.source([])},_onResetModels:function(e,t){this._removeAllViews();this._insertModels(e)},_insertModels:function(e){var t=[];for(var n=0,r=e.length;n<r;n++){var i=e[n];if(this._map){i=this._map(i)}if(!i.__isBindable){throw new Error("source must contain bindable objects for "+this.path())}this._sjanitor.add(this._watchModelChanges(i));if(this._filter&&!this._filter(i,this)){continue}t.push(i);var o=this;if(this.delay){this._insertLater(i)}}if(!this.delay){this._insertNow(t,true)}},_removeModels:function(e){var t=this;e.forEach(function(e){t._onRemoveModel(e)})},_onReplaceModels:function(e,t){this._removeModels(t);this._insertModels(e)},_onInsertModel:function(e,t){this._insertModels([e])},_insertLater:function(e){if(~this._insertQueue.indexOf(e)){return}this._insertQueue.push(e);if(this._runLater)return;var t=this;function n(){var e=t._insertQueue.splice(0,t.chunk);if(!e.length||!t._runLater){t._runLater=false;return}t._insertNow(e,false);t._resort();f(function(){t.application.animate({update:n})})}this._runLater=true;this.application.animate({update:n})},remove:function(){p.__super__.remove.call(this);if(this._runLater)this._runLater=false;if(this._sjanitor)this._sjanitor.dispose();this._source=undefined;this._bbound;this._views.source([]);this._insertQueue=[]},_insertNow:function(e,t){var n,r,i=[],o=[];this._inserting=e;for(var s=0,a=e.length;s<a;s++){r=e[s];if(~this._searchViewIndexByModel(r))continue;n=this._modelViewFactory.create({model:r,parent:this,application:this.application});i.push(n);o.push(n.render())}this._inserting=[];if(!o.length){return}this._views.splice.apply(this._views,[this._views.length,0].concat(i));this.section.append(this.application.nodeFactory.createFragment(o));if(t)this._resort()},_searchViewIndexByModel:function(e){var t=this._views.source();for(var n=t.length;n--;){if(t[n].__context.model==e)return n}return-1},_watchModelChanges:function(e){var t=this;if(!e.on)return{dispose:function(){}};return e.on("change",function(){if(!t._inserting||!~t._inserting.indexOf(e))t._refilter([e])})},_onRemoveModel:function(e,t,n){if(!e)return;var r;if(~(r=this._insertQueue.indexOf(e))){this._insertQueue.splice(r,1)}if(n===undefined){n=this._searchViewIndexByModel(e)}if(!~n){return}var i=this._views.at(n);i.dispose();this._views.splice(n,1)},_onSortChange:function(e){this._sort=e;this._resort()},_resort:function(){if(!this._sort)return;var e=this._views.source().sort(this._sort).map(function(e){return e.section.remove()});this.section.append(this.application.nodeFactory.createFragment(e))},_onFilterChange:function(e){this._filter=e;if(this._source&&e){this._refilter(this._source.source())}},_refilter:function(e){if(!this._filter)return;var t,n,r,i;var o=[];for(t=e.length;t--;){n=e[t];r=!!this._filter(n,this);i=this._searchViewIndexByModel(n);if(r===!!~i){continue}if(r){o.push(n)}else{this._onRemoveModel(n,undefined,i)}}if(o.length)this._insertModels(o)}});t.exports=p}).call(this,e("OpdoqP"))},{"../base":329,OpdoqP:61,bindable:338,factories:352,janitorjs:356,poolparty:375,protoclass:377,runlater:378,"type-component":381,underscore:382}],332:[function(e,t,n){var r=e("bindable");State=e("./state"),protoclass=e("protoclass"),BaseView=e("../base"),_=e("underscore"),flatstack=e("flatstack");function i(e,t){BaseView.call(this,e,t)}protoclass(BaseView,i,{transition:function(e,t,n){n()},define:["currentName","index","source","currentView","rotate","ended","views"],ended:false,initialize:function(e){this.source=new r.Collection;BaseView.prototype.initialize.call(this,e);this._q=flatstack();this.next=_.bind(this.next,this);this.prev=_.bind(this.prev,this);this.bind("views",{to:_.bind(this._setViews,this)}).now()},_setViews:function(e){var t=this;this.source.reset(e.map(function(e,n){return new State(t,e,n)}));if(this._rendered){this._createBindings()}},render:function(){var e=BaseView.prototype.render.call(this);this._createBindings();return e},_createBindings:function(){if(this._indexBinding){this._indexBinding.dispose();this._cnameBinding.dispose()}this._indexbinding=this.bind("index",{to:_.bind(this._setIndexWithAnimation,this)}).now();this._cnameBinding=this.bind("currentName",{to:_.bind(this._setName,this)}).now()},select:function(e){if(typeof e==="number"){this.set("index",e)}else{var t=this.source.indexOf(e);if(~t){this.select(t)}}},next:function(){this.move(1)},prev:function(){this.move(-1)},move:function(e){var t=this.index+e;if(t<0){if(this.rotate){t=this.source.length-1}else{t=0;this.set("ended",true)}}else if(t>=this.source.length){if(this.rotate){t=0}else{t=this.source.length-1;this.set("ended",true)}}this.set("index",t)},_setName:function(e){if(!e)return;for(var t=this.source.length;t--;){var n=this.source.at(t);if(n.get("name")===e){this.set("index",t);break}}},_setIndexWithAnimation:function(){this.application.animate(this)},update:function(){if(!this.source.length)return;var e=this;var t=this.currentState,n=t;if(t)t.set("selected",false);var e=this,r=t=this.currentState=this.source.at(Number(this.index||0)),i=!r.hasView(),o=r.getView();if(t===n){return}this.setChild("currentChild",o);t.set("selected",true);if(this._displayListener)this._displayListener.dispose();r.render();if(i){e.section.append(o.section.render())}function s(){if(n&&n!==t)n.removeLater();e.set("currentView",o)}if(!n){this.transition(n?n._view:n,r._view,function(){e.application.animate({update:s})})}else{s()}}});t.exports=i},{"../base":329,"./state":333,bindable:338,flatstack:353,protoclass:377,underscore:382}],333:[function(e,t,n){var r=e("bindable"),i=e("underscore"),o=e("protoclass");function s(e,t,n){this.states=e;this.select=i.bind(this.select,this);var o={};if(!t.viewClass&&!t["class"]){o.viewClass=t}else{o=t}o.index=n;o.selected=false;o._id=t.name;r.Object.call(this,this);this.setProperties(o)}o(r.Object,s,{select:function(){this.states.select(this)},remove:function(){if(!this._view)return;this._view.set("visible",false);this._view.dispose();this._view=undefined},removeLater:function(){if(!this._view)return;this._view.set("visible",false);this._view.section.hide();this._view._disposeLater();this._view=undefined},render:function(){this._view.set("visible",true);return this._view.render()},hasView:function(){return!!this._view},getView:function(){if(this._view)return this._view;var e=this.get("class")||this.get("viewClass");return this._view=new e}});t.exports=s},{bindable:338,protoclass:377,underscore:382}],334:[function(e,t,n){t.exports=e(96)},{disposable:335}],335:[function(e,t,n){t.exports=e(97)},{}],336:[function(e,t,n){t.exports=e(23)},{"../object":339,"../utils/computed":342,sift:344}],337:[function(e,t,n){t.exports=e(24)
},{protoclass:377}],338:[function(e,t,n){t.exports=e(25)},{"./collection":336,"./core/eventEmitter":337,"./object":339,"./utils/computed":342,"./utils/options":343}],339:[function(e,t,n){t.exports=e(26)},{"../core/eventEmitter":337,"./watchProperty":341,protoclass:377}],340:[function(e,t,n){t.exports=e(27)},{toarray:345,underscore:382}],341:[function(e,t,n){t.exports=e(28)},{"../utils/options":343,"./transform":340,underscore:382}],342:[function(e,t,n){t.exports=e(29)},{toarray:345}],343:[function(e,t,n){t.exports=e(30)},{}],344:[function(e,t,n){t.exports=e(32)},{}],345:[function(e,t,n){t.exports=e(33)},{}],346:[function(e,t,n){t.exports=e(49)},{"./base":347,"./factory":349}],347:[function(e,t,n){t.exports=e(50)},{}],348:[function(e,t,n){t.exports=e(51)},{"./base":347}],349:[function(e,t,n){t.exports=e(52)},{"./base":347,"./class":348,"./fn":350,"type-component":381}],350:[function(e,t,n){t.exports=e(53)},{}],351:[function(e,t,n){t.exports=e(54)},{"./base":347,"./factory":349}],352:[function(e,t,n){t.exports=e(55)},{"./any":346,"./class":348,"./factory":349,"./fn":350,"./group":351}],353:[function(e,t,n){var r=0;function i(e){if(!e){e={}}var n=e.context,o=e.parent,s=e.asyncLength||1,a=!!(e.enforceAsync||t.exports.enforceAsync);var u=[],c=function(e){};var f={_parent:o,_pauseCount:0,error:function(e){c=e},child:function(e){return i({context:n,parent:o,asyncLength:s})},pause:function(){var e=f;while(e){e._pauseCount++;e=e._parent}return f},resume:function(e){if(e)c(e);if(!f._pauseCount||f._resuming)return f;f._resuming=true;if(a&&r++==i.asyncLimit){r=0;setTimeout(f._resume,0,arguments)}else{f._resume(arguments)}return f},_resume:function(e){var t=f;f._resuming=false;while(t){t._pauseCount--;t=t._parent}t=f;while(t){if(t._pauseCount)break;t.next(e);t=t._parent}},push:function(){u.push.apply(u,arguments);f._run();return f},unshift:function(){u.unshift.apply(u,arguments);f._run();return f},next:function(){var e=Array.prototype.slice.call(arguments[0]||[],0);var t,r,i;while(u.length){if(f._pauseCount)break;i=u.shift();r=i.context||n;t=i.fn||i;if(t.length===s||t.async){e.unshift(f.pause().resume);t.apply(r,e)}else{t.apply(r,e)}}if(f._complete&&!u.length&&!f._pauseCount){f._complete();f._complete=undefined}},complete:function(e){f._complete=e;if(!u.length)return f.next()},_run:function(){if(f._pauseCount||!u.length)return;f.next()}};return f}i.asyncLimit=10;t.exports=i},{}],354:[function(e,t,n){t.exports=e(109)},{protoclass:377}],355:[function(e,t,n){t.exports=e(110)},{"./decorator":354}],356:[function(e,t,n){t.exports=e(112)},{protoclass:377,"type-component":381}],357:[function(e,t,n){t.exports=e(172)},{nofactor:364,protoclass:377}],358:[function(e,t,n){t.exports=e(173)},{OpdoqP:61,protoclass:377}],359:[function(e,t,n){t.exports=e(174)},{"./animator":358}],360:[function(e,t,n){t.exports=e(116)},{bindable:338}],361:[function(e,t,n){t.exports=e(35)},{protoclass:377}],362:[function(e,t,n){t.exports=e(36)},{"./base":361,factories:352}],363:[function(e,t,n){t.exports=e(37)},{"./base":361}],364:[function(e,t,n){t.exports=e(38)},{"./custom":362,"./dom":363,"./string":370}],365:[function(e,t,n){t.exports=e(39)},{"./text":373}],366:[function(e,t,n){t.exports=e(40)},{"./node":371}],367:[function(e,t,n){t.exports=e(41)},{"./container":366,"./style":372}],368:[function(e,t,n){t.exports=e(42)},{}],369:[function(e,t,n){t.exports=e(43)},{"./container":366}],370:[function(e,t,n){t.exports=e(44)},{"../base":361,"./comment":365,"./container":366,"./element":367,"./fragment":369,"./text":373,"./voidElements":374}],371:[function(e,t,n){t.exports=e(45)},{protoclass:377}],372:[function(e,t,n){t.exports=e(46)},{protoclass:377}],373:[function(e,t,n){t.exports=e(47)},{"./ent":368,"./node":371}],374:[function(e,t,n){t.exports=e(48)},{"./element":367}],375:[function(e,t,n){var r=e("protoclass"),i=e("boojs");function o(e){if(!e){e={}}this.max=e.max||50;this.min=e.min||0;this.staleInterval=e.staleInterval||e.speed||1e3;this.factory=e.factory||e.create;this.warmUpInterval=e.warmUpInterval||e.speed||0;this.warmUpBatch=e.warmUpBatch||e.chunk||1;this.recycle=e.recycle;var t=this;this.tick=e.tick||function(e){setTimeout(function(){i.run(e)},t.warmUpInterval)};this._pool=[];this._size=0;this._warmUp()}r(o,{size:function(){return this._size},drain:function(){for(var e=Math.max(this._size-this.min,0);e--;){this.drip()}},drip:function(){if(!this._size||this._size<=this.min)return;this._size--;this._pool.shift();this._timeoutDrip()},create:function(e){var t;if(this._size){this._size--;t=this._pool.shift();this.recycle(t,e);this._warmUp();return t}t=this.factory(e);return t},add:function(e){if(!~this._pool.indexOf(e)&&this._size<this.max){this._size++;this._pool.push(e);this._timeoutDrip()}return this},_timeoutDrip:function(){if(this._dripTimeout||this._size<=this.min)return;var e=this;this._dripTimeout=setTimeout(function(){e._dripTimeout=undefined;e.drip()},this.staleInterval)},_warmUp:function(){if(this._warmingUp||this._size>=this.min)return;this._warmingUp=true;var e=this;this.tick(function(){e._warmingUp=false;var t=Math.min(e.min-e._size,e.warmUpBatch);for(var n=0;n<t;n++){e.add(e.factory({warm:true}))}e._warmUp()})}});t.exports=function(e){return new o(e)};t.exports.factorize=function(e,t){var n;t.create=function(t){var r=new e(t);r.on("dispose",function(){n.add(r)});return r};t.recycle=function(e,t){e.reset(t)};n=new o(t);e.create=function(e){return n.create(e)};return e}},{boojs:376,protoclass:377}],376:[function(e,t,n){(function(e){(function(){var n=[],r,i=false;function o(e,t){var n,r;function i(){n=setTimeout(function(){s(function(){if(r)return;e();i()})},t)}i();return{dispose:function(){r=true;if(n){clearTimeout(n)}}}}function s(e){n.push(e);if(!i){a()}}function a(){i=false;r=undefined;for(var e=0;e<n.length;e++){n[e]()}n=[]}function u(){i=true;if(r)clearTimeout(r);r=setTimeout(a,f.waitTimeout)}function c(){if(r)clearTimeout(r);a()}var f={interval:o,run:s,wait:u,unwait:c,waitTimeout:1e3};if(typeof e!=="undefined"){t.exports=f}if(typeof window!=="undefined"){window.boo=f;$(document).ready(function(){$("body, html").scroll(f.wait).mousedown(f.wait).mousemove(f.wait).mouseleave(f.unwait)})}})()}).call(this,e("OpdoqP"))},{OpdoqP:61}],377:[function(e,t,n){t.exports=e(31)},{}],378:[function(e,t,n){(function(e){t.exports=function(e,t){if(!e)e=5;if(!t)t=1;var n=[],r;var i=function(e){n.push(e);var t={dispose:function(){clearTimeout(r);r=undefined}};if(r)return t;r=setInterval(function(){var e=n.splice(0,i.batch);if(!e.length){return t.dispose()}for(var r=0,o=e.length;r<o;r++){e[r]()}},i.ms);return t};i.ms=t;i.batch=e;return i};t.exports.global=e.__runlater||(e.__runlater=t.exports())}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],379:[function(e,t,n){var r=e("bindable"),i=e("protoclass"),o=e("type-component"),s=e("underscore");function a(e,t){var n=e.constructor;if(!n.__combined){n.__combined={}}if(n.__combined[t]){return}n.__combined[t]=true;var r=n.prototype,i=[];while(r){i=(r.define||[]).concat(i);r=r.constructor.__super__}n.prototype[t]=e[t]=i}function u(e,t){u.parent.call(this,e||this);if(t)this.set("parent",t);this._defined={};a(this,"define");this._define.apply(this,this.define);var n=this;this.on("watching",function(e){var t=e[0];if(n.__context[t]===undefined)n.inherit(t)})}i(r.Object,u,{define:["parent"],get:function(e){var t=u.__super__.get.call(this,e);if(t!=undefined)return t;var n,r;if(typeof e!=="string"){n=e[0]}else if(~(r=e.indexOf("."))){n=e.slice(0,r)}else{n=e}if(this.__context[n]!=undefined){return}this.inherit(n);return u.__super__.get.call(this,e)},set:function(e,t){var n;if(typeof e==="string"&&~(n=e.indexOf("."))){var r=e.slice(0,n);if(this.__context[r]==undefined)this.inherit(r)}return u.__super__.set.call(this,e,t)},_define:function(){for(var e=arguments.length;e--;){this._defined[arguments[e]]=true}},_inherit:function(e){console.warn("_inherit on subindable is deprecated");this.inherit(e)},inherit:function(e){if(this._defined[e])return;this._defined[e]=true;var t,n,r,i=this;n=this.bind("parent",function(n){if(t)t.dispose();if(!n)return;t=n.bind(e,function(t){if(typeof t==="function"&&!t.__bound){var r;t=s.bind(r=t,n);t.__bound=true;t.__original=r}i.set(e,t)}).now()}).now();r=this.bind(e,function(o){if(i.__context.parent&&i.__context.parent.__context[e]===o){return}if(o&&o.__bound&&o.__original==i.__context.parent.__context[e]){return}r.dispose();if(t)t.dispose();if(n)n.dispose()})}});t.exports={Object:u}},{bindable:338,protoclass:377,"type-component":381,underscore:380}],380:[function(e,t,n){(function(){var e=this;var r=e._;var i={};var o=Array.prototype,s=Object.prototype,a=Function.prototype;var u=o.push,c=o.slice,f=o.concat,l=s.toString,p=s.hasOwnProperty;var h=o.forEach,d=o.map,v=o.reduce,m=o.reduceRight,g=o.filter,y=o.every,_=o.some,b=o.indexOf,w=o.lastIndexOf,x=Array.isArray,k=Object.keys,E=a.bind;var O=function(e){if(e instanceof O)return e;if(!(this instanceof O))return new O(e);this._wrapped=e};if(typeof n!=="undefined"){if(typeof t!=="undefined"&&t.exports){n=t.exports=O}n._=O}else{e._=O}O.VERSION="1.5.2";var j=O.each=O.forEach=function(e,t,n){if(e==null)return;if(h&&e.forEach===h){e.forEach(t,n)}else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++){if(t.call(n,e[r],r,e)===i)return}}else{var s=O.keys(e);for(var r=0,o=s.length;r<o;r++){if(t.call(n,e[s[r]],s[r],e)===i)return}}};O.map=O.collect=function(e,t,n){var r=[];if(e==null)return r;if(d&&e.map===d)return e.map(t,n);j(e,function(e,i,o){r.push(t.call(n,e,i,o))});return r};var S="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(v&&e.reduce===v){if(r)t=O.bind(t,r);return i?e.reduce(t,n):e.reduce(t)}j(e,function(e,o,s){if(!i){n=e;i=true}else{n=t.call(r,n,e,o,s)}});if(!i)throw new TypeError(S);return n};O.reduceRight=O.foldr=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(m&&e.reduceRight===m){if(r)t=O.bind(t,r);return i?e.reduceRight(t,n):e.reduceRight(t)}var o=e.length;if(o!==+o){var s=O.keys(e);o=s.length}j(e,function(a,u,c){u=s?s[--o]:--o;if(!i){n=e[u];i=true}else{n=t.call(r,n,e[u],u,c)}});if(!i)throw new TypeError(S);return n};O.find=O.detect=function(e,t,n){var r;A(e,function(e,i,o){if(t.call(n,e,i,o)){r=e;return true}});return r};O.filter=O.select=function(e,t,n){var r=[];if(e==null)return r;if(g&&e.filter===g)return e.filter(t,n);j(e,function(e,i,o){if(t.call(n,e,i,o))r.push(e)});return r};O.reject=function(e,t,n){return O.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)};O.every=O.all=function(e,t,n){t||(t=O.identity);var r=true;if(e==null)return r;if(y&&e.every===y)return e.every(t,n);j(e,function(e,o,s){if(!(r=r&&t.call(n,e,o,s)))return i});return!!r};var A=O.some=O.any=function(e,t,n){t||(t=O.identity);var r=false;if(e==null)return r;if(_&&e.some===_)return e.some(t,n);j(e,function(e,o,s){if(r||(r=t.call(n,e,o,s)))return i});return!!r};O.contains=O.include=function(e,t){if(e==null)return false;if(b&&e.indexOf===b)return e.indexOf(t)!=-1;return A(e,function(e){return e===t})};O.invoke=function(e,t){var n=c.call(arguments,2);var r=O.isFunction(t);return O.map(e,function(e){return(r?t:e[t]).apply(e,n)})};O.pluck=function(e,t){return O.map(e,function(e){return e[t]})};O.where=function(e,t,n){if(O.isEmpty(t))return n?void 0:[];return O[n?"find":"filter"](e,function(e){for(var n in t){if(t[n]!==e[n])return false}return true})};O.findWhere=function(e,t){return O.where(e,t,true)};O.max=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&O.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};j(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s>r.computed&&(r={value:e,computed:s})});return r.value};O.min=function(e,t,n){if(!t&&O.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&O.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};j(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s<r.computed&&(r={value:e,computed:s})});return r.value};O.shuffle=function(e){var t;var n=0;var r=[];j(e,function(e){t=O.random(n++);r[n-1]=r[t];r[t]=e});return r};O.sample=function(e,t,n){if(arguments.length<2||n){return e[O.random(e.length-1)]}return O.shuffle(e).slice(0,Math.max(0,t))};var C=function(e){return O.isFunction(e)?e:function(t){return t[e]}};O.sortBy=function(e,t,n){var r=C(t);return O.pluck(O.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria;var r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,r){var i={};var o=n==null?O.identity:C(n);j(t,function(n,s){var a=o.call(r,n,s,t);e(i,a,n)});return i}};O.groupBy=T(function(e,t,n){(O.has(e,t)?e[t]:e[t]=[]).push(n)});O.indexBy=T(function(e,t,n){e[t]=n});O.countBy=T(function(e,t){O.has(e,t)?e[t]++:e[t]=1});O.sortedIndex=function(e,t,n,r){n=n==null?O.identity:C(n);var i=n.call(r,t);var o=0,s=e.length;while(o<s){var a=o+s>>>1;n.call(r,e[a])<i?o=a+1:s=a}return o};O.toArray=function(e){if(!e)return[];if(O.isArray(e))return c.call(e);if(e.length===+e.length)return O.map(e,O.identity);return O.values(e)};O.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:O.keys(e).length};O.first=O.head=O.take=function(e,t,n){if(e==null)return void 0;return t==null||n?e[0]:c.call(e,0,t)};O.initial=function(e,t,n){return c.call(e,0,e.length-(t==null||n?1:t))};O.last=function(e,t,n){if(e==null)return void 0;if(t==null||n){return e[e.length-1]}else{return c.call(e,Math.max(e.length-t,0))}};O.rest=O.tail=O.drop=function(e,t,n){return c.call(e,t==null||n?1:t)};O.compact=function(e){return O.filter(e,O.identity)};var N=function(e,t,n){if(t&&O.every(e,O.isArray)){return f.apply(n,e)}j(e,function(e){if(O.isArray(e)||O.isArguments(e)){t?u.apply(n,e):N(e,t,n)}else{n.push(e)}});return n};O.flatten=function(e,t){return N(e,t,[])};O.without=function(e){return O.difference(e,c.call(arguments,1))};O.uniq=O.unique=function(e,t,n,r){if(O.isFunction(t)){r=n;n=t;t=false}var i=n?O.map(e,n,r):e;var o=[];var s=[];j(i,function(n,r){if(t?!r||s[s.length-1]!==n:!O.contains(s,n)){s.push(n);o.push(e[r])}});return o};O.union=function(){return O.uniq(O.flatten(arguments,true))};O.intersection=function(e){var t=c.call(arguments,1);return O.filter(O.uniq(e),function(e){return O.every(t,function(t){return O.indexOf(t,e)>=0})})};O.difference=function(e){var t=f.apply(o,c.call(arguments,1));return O.filter(e,function(e){return!O.contains(t,e)})};O.zip=function(){var e=O.max(O.pluck(arguments,"length").concat(0));var t=new Array(e);for(var n=0;n<e;n++){t[n]=O.pluck(arguments,""+n)}return t};O.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++){if(t){n[e[r]]=t[r]}else{n[e[r][0]]=e[r][1]}}return n};O.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n=="number"){r=n<0?Math.max(0,i+n):n}else{r=O.sortedIndex(e,t);return e[r]===t?r:-1}}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1};O.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w){return r?e.lastIndexOf(t,n):e.lastIndexOf(t)}var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1};O.range=function(e,t,n){if(arguments.length<=1){t=e||0;e=0}n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0);var i=0;var o=new Array(r);while(i<r){o[i++]=e;e+=n}return o};var q=function(){};O.bind=function(e,t){var n,r;if(E&&e.bind===E)return E.apply(e,c.call(arguments,1));if(!O.isFunction(e))throw new TypeError;n=c.call(arguments,2);return r=function(){if(!(this instanceof r))return e.apply(t,n.concat(c.call(arguments)));q.prototype=e.prototype;var i=new q;q.prototype=null;var o=e.apply(i,n.concat(c.call(arguments)));if(Object(o)===o)return o;return i}};O.partial=function(e){var t=c.call(arguments,1);return function(){return e.apply(this,t.concat(c.call(arguments)))}};O.bindAll=function(e){var t=c.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");j(t,function(t){e[t]=O.bind(e[t],e)});return e};O.memoize=function(e,t){var n={};t||(t=O.identity);return function(){var r=t.apply(this,arguments);return O.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}};O.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)};O.defer=function(e){return O.delay.apply(O,[e,1].concat(c.call(arguments,1)))};O.throttle=function(e,t,n){var r,i,o;var s=null;var a=0;n||(n={});var u=function(){a=n.leading===false?0:new Date;s=null;o=e.apply(r,i)};return function(){var c=new Date;if(!a&&n.leading===false)a=c;var f=t-(c-a);r=this;i=arguments;if(f<=0){clearTimeout(s);s=null;a=c;o=e.apply(r,i)}else if(!s&&n.trailing!==false){s=setTimeout(u,f)}return o}};O.debounce=function(e,t,n){var r,i,o,s,a;return function(){o=this;i=arguments;s=new Date;var u=function(){var c=new Date-s;if(c<t){r=setTimeout(u,t-c)}else{r=null;if(!n)a=e.apply(o,i)}};var c=n&&!r;if(!r){r=setTimeout(u,t)}if(c)a=e.apply(o,i);return a}};O.once=function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}};O.wrap=function(e,t){return function(){var n=[e];u.apply(n,arguments);return t.apply(this,n)}};O.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--){t=[e[n].apply(this,t)]}return t[0]}};O.after=function(e,t){return function(){if(--e<1){return t.apply(this,arguments)}}};O.keys=k||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)if(O.has(e,n))t.push(n);return t};O.values=function(e){var t=O.keys(e);var n=t.length;var r=new Array(n);for(var i=0;i<n;i++){r[i]=e[t[i]]}return r};O.pairs=function(e){var t=O.keys(e);var n=t.length;var r=new Array(n);for(var i=0;i<n;i++){r[i]=[t[i],e[t[i]]]}return r};O.invert=function(e){var t={};var n=O.keys(e);for(var r=0,i=n.length;r<i;r++){t[e[n[r]]]=n[r]}return t};O.functions=O.methods=function(e){var t=[];for(var n in e){if(O.isFunction(e[n]))t.push(n)}return t.sort()};O.extend=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){e[n]=t[n]}}});return e};O.pick=function(e){var t={};var n=f.apply(o,c.call(arguments,1));j(n,function(n){if(n in e)t[n]=e[n]});return t};O.omit=function(e){var t={};var n=f.apply(o,c.call(arguments,1));for(var r in e){if(!O.contains(n,r))t[r]=e[r]}return t};O.defaults=function(e){j(c.call(arguments,1),function(t){if(t){for(var n in t){if(e[n]===void 0)e[n]=t[n]}}});return e};O.clone=function(e){if(!O.isObject(e))return e;return O.isArray(e)?e.slice():O.extend({},e)};O.tap=function(e,t){t(e);return e};var I=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof O)e=e._wrapped;if(t instanceof O)t=t._wrapped;var i=l.call(e);if(i!=l.call(t))return false;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var o=n.length;while(o--){if(n[o]==e)return r[o]==t}var s=e.constructor,a=t.constructor;if(s!==a&&!(O.isFunction(s)&&s instanceof s&&O.isFunction(a)&&a instanceof a)){return false}n.push(e);r.push(t);var u=0,c=true;if(i=="[object Array]"){u=e.length;c=u==t.length;if(c){while(u--){if(!(c=I(e[u],t[u],n,r)))break}}}else{for(var f in e){if(O.has(e,f)){u++;if(!(c=O.has(t,f)&&I(e[f],t[f],n,r)))break}}if(c){for(f in t){if(O.has(t,f)&&!u--)break}c=!u}}n.pop();r.pop();return c};O.isEqual=function(e,t){return I(e,t,[],[])};O.isEmpty=function(e){if(e==null)return true;if(O.isArray(e)||O.isString(e))return e.length===0;for(var t in e)if(O.has(e,t))return false;return true};O.isElement=function(e){return!!(e&&e.nodeType===1)};O.isArray=x||function(e){return l.call(e)=="[object Array]"};O.isObject=function(e){return e===Object(e)};j(["Arguments","Function","String","Number","Date","RegExp"],function(e){O["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}});if(!O.isArguments(arguments)){O.isArguments=function(e){return!!(e&&O.has(e,"callee"))}}if(typeof/./!=="function"){O.isFunction=function(e){return typeof e==="function"}}O.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};O.isNaN=function(e){return O.isNumber(e)&&e!=+e};O.isBoolean=function(e){return e===true||e===false||l.call(e)=="[object Boolean]"};O.isNull=function(e){return e===null};O.isUndefined=function(e){return e===void 0};O.has=function(e,t){return p.call(e,t)};O.noConflict=function(){e._=r;return this};O.identity=function(e){return e};O.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r};O.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=O.invert(R.escape);var B={escape:new RegExp("["+O.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(R.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(e){O[e]=function(t){if(t==null)return"";return(""+t).replace(B[e],function(t){return R[e][t]})}});O.result=function(e,t){if(e==null)return void 0;var n=e[t];return O.isFunction(n)?n.call(e):n};O.mixin=function(e){j(O.functions(e),function(t){var n=O[t]=e[t];O.prototype[t]=function(){var e=[this._wrapped];u.apply(e,arguments);return M.call(this,n.apply(O,e))}})};var L=0;O.uniqueId=function(e){var t=++L+"";return e?e+t:t};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/;var F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var P=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(e,t,n){var r;n=O.defaults({},n,O.templateSettings);var i=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g");var o=0;var s="__p+='";e.replace(i,function(t,n,r,i,a){s+=e.slice(o,a).replace(P,function(e){return"\\"+F[e]});if(n){s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"}if(r){s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}if(i){s+="';\n"+i+"\n__p+='"}o=a+t.length;return t});s+="';\n";if(!n.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(n.variable||"obj","_",s)}catch(a){a.source=s;throw a}if(t)return r(t,O);var u=function(e){return r.call(this,e,O)};u.source="function("+(n.variable||"obj")+"){\n"+s+"}";return u};O.chain=function(e){return O(e).chain()};var M=function(e){return this._chain?O(e).chain():e};O.mixin(O);j(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];O.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);if((e=="shift"||e=="splice")&&n.length===0)delete n[0];return M.call(this,n)}});j(["concat","join","slice"],function(e){var t=o[e];O.prototype[e]=function(){return M.call(this,t.apply(this._wrapped,arguments))}});O.extend(O.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}],381:[function(e,t,n){t.exports=e(56)},{}],382:[function(e,t,n){t.exports=e(34)},{}],383:[function(e,t,n){"use strict";var r=e("./utils");var i=e("./merge");var o=e("./deps/errors");var s=e("events").EventEmitter;var a=e("./deps/upsert");var u=e("./changes");var c=r.Promise;function f(e,t){for(var n=0;n<e.length;n++){if(t(e[n],n)===true){return e[n]}}return false}function l(e){return function(t,n){if(t||n[0].error){e(t||n[0])}else{e(null,n[0])}}}function p(e){var t={};var n=[];i.traverseRevTree(e,function(e,r,i,o){var s=r+"-"+i;if(e){t[s]=0}if(o!==undefined){n.push({from:o,to:s})}return s});n.reverse();n.forEach(function(e){if(t[e.from]===undefined){t[e.from]=1+t[e.to]}else{t[e.from]=Math.min(t[e.from],1+t[e.to])}});return t}function h(e,t,n){var i="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending){i.reverse()}if(!i.length){return e._allDocs({limit:0},n)}var o={offset:t.skip};return c.all(i.map(function(n,i){var s=r.extend(true,{key:n,deleted:"ok"},t);["limit","skip","keys"].forEach(function(e){delete s[e]});return new c(function(t,r){e._allDocs(s,function(e,i){if(e){return r(e)}o.total_rows=i.total_rows;t(i.rows[0]||{key:n,error:"not_found"})})})})).then(function(e){o.rows=e;return o})}r.inherits(d,s);t.exports=d;function d(){var e=this;s.call(this);e.autoCompact=function(t){if(!e.auto_compaction){return t}return function(n,r){if(n){t(n)}else{var i=r.length;var o=function(){i--;if(!i){t(null,r)}};r.forEach(function(t){if(t.ok){e.compactDocument(t.id,1,o)}else{o()}})}}};var t=0,n;var r=["change","delete","create","update"];this.on("newListener",function(i){if(~r.indexOf(i)){if(t){t++;return}else{t++}}else{return}var o=0;n=this.changes({conflicts:true,include_docs:true,continuous:true,since:"now",onChange:function(t){if(t.seq<=o){return}o=t.seq;e.emit("change",t);if(t.doc._deleted){e.emit("delete",t)}else if(t.doc._rev.split("-")[0]==="1"){e.emit("create",t)}else{e.emit("update",t)}}})});this.on("removeListener",function(e){if(~r.indexOf(e)){t--;if(t){return}}else{return}n.cancel()})}d.prototype.post=r.adapterFun("post",function(e,t,n){if(typeof t==="function"){n=t;t={}}if(typeof e!=="object"||Array.isArray(e)){return n(o.NOT_AN_OBJECT)}this.bulkDocs({docs:[e]},t,this.autoCompact(l(n)))});d.prototype.put=r.adapterFun("put",r.getArguments(function(e){var t,n,i,s;var a=e.shift();var u="_id"in a;if(typeof a!=="object"||Array.isArray(a)){s=e.pop();return s(o.NOT_AN_OBJECT)}a=r.clone(a);while(true){t=e.shift();n=typeof t;if(n==="string"&&!u){a._id=t;u=true}else if(n==="string"&&u&&!("_rev"in a)){a._rev=t}else if(n==="object"){i=t}else if(n==="function"){s=t}if(!e.length){break}}i=i||{};var c=r.invalidIdError(a._id);if(c){return s(c)}this.bulkDocs({docs:[a]},i,this.autoCompact(l(s)))}));d.prototype.putAttachment=r.adapterFun("putAttachment",function(e,t,n,r,i,s){var a=this;if(typeof i==="function"){s=i;i=r;r=n;n=null}if(typeof i==="undefined"){i=r;r=n;n=null}function u(e){e._attachments=e._attachments||{};e._attachments[t]={content_type:i,data:r};return a.put(e)}return a.get(e).then(function(e){if(e._rev!==n){throw o.REV_CONFLICT}return u(e)},function(t){if(t.error===o.MISSING_DOC.error){return u({_id:e})}else{throw t}})});d.prototype.removeAttachment=r.adapterFun("removeAttachment",function(e,t,n,r){var i=this;i.get(e,function(e,s){if(e){r(e);return}if(s._rev!==n){r(o.REV_CONFLICT);return}if(!s._attachments){return r()}delete s._attachments[t];if(Object.keys(s._attachments).length===0){delete s._attachments}i.put(s,r)})});d.prototype.remove=r.adapterFun("remove",function(e,t,n){if(typeof t==="function"){n=t;t={}}else if(typeof t==="string"){e={_id:e,_rev:t}}else if(t===undefined){t={}}t=r.clone(t);t.was_delete=true;var i={_id:e._id,_rev:e._rev};i._deleted=true;this.bulkDocs({docs:[i]},t,l(n))});d.prototype.revsDiff=r.adapterFun("revsDiff",function(e,t,n){if(typeof t==="function"){n=t;t={}}t=r.clone(t);var o=Object.keys(e);var s=0;var a={};function u(e,t){if(!a[e]){a[e]={missing:[]}}a[e].missing.push(t)}function c(t,n){var r=e[t].slice(0);i.traverseRevTree(n,function(e,n,i,o,s){var a=n+"-"+i;var c=r.indexOf(a);if(c===-1){return}r.splice(c,1);if(s.status!=="available"){u(t,a)}});r.forEach(function(e){u(t,e)})}o.map(function(t){this._getRevisionTree(t,function(r,i){if(r&&r.name==="not_found"&&r.message==="missing"){a[t]={missing:e[t]}}else if(r){return n(r)}else{c(t,i)}if(++s===o.length){return n(null,a)}})},this)});d.prototype.compactDocument=function(e,t,n){var r=this;this._getRevisionTree(e,function(o,s){if(o){return n(o)}var a=p(s);var u=[];var c=[];Object.keys(a).forEach(function(e){if(a[e]>t){u.push(e)}});i.traverseRevTree(s,function(e,t,n,r,i){var o=t+"-"+n;if(i.status==="available"&&u.indexOf(o)!==-1){i.status="missing";c.push(o)}});r._doCompaction(e,s,c,n)})};d.prototype.compact=r.adapterFun("compact",function(e,t){if(typeof e==="function"){t=e;e={}}var n=this;this.changes({complete:function(e,r){if(e){t();return}var i=r.results.length;if(!i){t();return}r.results.forEach(function(e){n.compactDocument(e.id,0,function(){i--;if(!i){t()}})})}})});d.prototype.get=r.adapterFun("get",function(e,t,n){if(typeof t==="function"){n=t;t={}}if(typeof e!=="string"){return n(o.INVALID_ID)}var s=[],a=this;function u(){var r=[];var i=s.length;if(!i){return n(null,r)}s.forEach(function(o){a.get(e,{rev:o,revs:t.revs,attachments:t.attachments},function(e,t){if(!e){r.push({ok:t})}else{r.push({missing:o})}i--;if(!i){n(null,r)}})})}if(t.open_revs){if(t.open_revs==="all"){this._getRevisionTree(e,function(e,t){if(e){t=[]}s=i.collectLeaves(t).map(function(e){return e.rev});u()})}else{if(Array.isArray(t.open_revs)){s=t.open_revs;for(var c=0;c<s.length;c++){var l=s[c];if(!(typeof l==="string"&&/^\d+-/.test(l))){return n(o.error(o.BAD_REQUEST,"Invalid rev format"))}}u()}else{return n(o.error(o.UNKNOWN_ERROR,"function_clause"))}}return}return this._get(e,t,function(e,o){t=r.clone(t);if(e){return n(e)}var s=o.doc;if(!s){return n(new Error("no doc!"))}var u=o.metadata;var c=o.ctx;if(t.conflicts){var l=i.collectConflicts(u);if(l.length){s._conflicts=l}}if(t.revs||t.revs_info){var p=i.rootToLeaf(u.rev_tree);var h=f(p,function(e){return e.ids.map(function(e){return e.id}).indexOf(s._rev.split("-")[1])!==-1});var d=h.ids.map(function(e){return e.id}).indexOf(s._rev.split("-")[1])+1;var v=h.ids.length-d;h.ids.splice(d,v);h.ids.reverse();if(t.revs){s._revisions={start:h.pos+h.ids.length-1,ids:h.ids.map(function(e){return e.id})}}if(t.revs_info){var m=h.pos+h.ids.length;s._revs_info=h.ids.map(function(e){m--;return{rev:m+"-"+e.id,status:e.opts.status}})}}if(t.local_seq){s._local_seq=o.metadata.seq}if(t.attachments&&s._attachments){var g=s._attachments;var y=Object.keys(g).length;if(y===0){return n(null,s)}Object.keys(g).forEach(function(e){this._getAttachment(g[e],{encode:true,ctx:c},function(t,r){s._attachments[e].data=r;if(!--y){n(null,s)}})},a)}else{if(s._attachments){for(var _ in s._attachments){if(s._attachments.hasOwnProperty(_)){s._attachments[_].stub=true}}}n(null,s)}})});d.prototype.getAttachment=r.adapterFun("getAttachment",function(e,t,n,i){var s=this;if(n instanceof Function){i=n;n={}}n=r.clone(n);this._get(e,n,function(e,r){if(e){return i(e)}if(r.doc._attachments&&r.doc._attachments[t]){n.ctx=r.ctx;s._getAttachment(r.doc._attachments[t],n,i)}else{return i(o.MISSING_DOC)}})});d.prototype.allDocs=r.adapterFun("allDocs",function(e,t){if(typeof e==="function"){t=e;e={}}e=r.clone(e);e.skip=typeof e.skip!=="undefined"?e.skip:0;if("keys"in e){if(!Array.isArray(e.keys)){return t(new TypeError("options.keys must be an array"))}var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n){t(o.error(o.QUERY_PARSE_ERROR,"Query parameter `"+n+"` is not compatible with multi-get"));return}if(this.type()!=="http"){return h(this,e,t)}}return this._allDocs(e,t)});d.prototype.changes=function(e,t){if(typeof e==="function"){t=e;e={}}return new u(this,e,t)};d.prototype.close=r.adapterFun("close",function(e){this._closed=true;return this._close(e)});d.prototype.info=r.adapterFun("info",function(e){var t=this;this._info(function(n,r){if(n){return e(n)}var i=t.prefix.length;if(r.db_name.length>i&&r.db_name.slice(0,i)===t.prefix){r.db_name=r.db_name.slice(i)}e(null,r)})});d.prototype.id=r.adapterFun("id",function(e){return this._id(e)});d.prototype.type=function(){return typeof this._type==="function"?this._type():this.adapter};d.prototype.bulkDocs=r.adapterFun("bulkDocs",function(e,t,n){if(typeof t==="function"){n=t;t={}}t=r.clone(t);if(Array.isArray(e)){e={docs:e}}if(!e||!e.docs||!Array.isArray(e.docs)){return n(o.MISSING_BULK_DOCS)}for(var i=0;i<e.docs.length;++i){if(typeof e.docs[i]!=="object"||Array.isArray(e.docs[i])){return n(o.NOT_AN_OBJECT)
}}e=r.clone(e);if(!("new_edits"in t)){if("new_edits"in e){t.new_edits=e.new_edits}else{t.new_edits=true}}return this._bulkDocs(e,t,this.autoCompact(n))});d.prototype.registerDependentDatabase=r.adapterFun("registerDependentDatabase",function(e,t){var n=new this.constructor(e,{adapter:this._adapter});function r(t){t.dependentDbs=t.dependentDbs||{};if(t.dependentDbs[e]){return false}t.dependentDbs[e]=true;return t}a(this,"_local/_pouch_dependentDbs",r,function(e){if(e){return t(e)}return t(null,{db:n})})})},{"./changes":388,"./deps/errors":392,"./deps/upsert":393,"./merge":398,"./utils":403,events:60}],384:[function(e,t,n){"use strict";var r=e("../utils");var i=e("../deps/errors");function o(e){var t=o.options;var n=t.parser[t.strictMode?"strict":"loose"].exec(e);var r={};var i=14;while(i--){r[t.key[i]]=n[i]||""}r[t.q.name]={};r[t.key[12]].replace(t.q.parser,function(e,n,i){if(n){r[t.q.name][n]=i}});return r}function s(e){if(/^_(design|local)/.test(e)){return e}return encodeURIComponent(e)}o.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function a(e,t){if(/http(s?):/.test(e)){var n=o(e);n.remote=true;if(n.user||n.password){n.auth={username:n.user,password:n.password}}var i=n.path.replace(/(^\/|\/$)/g,"").split("/");n.db=i.pop();n.path=i.join("/");t=t||{};t=r.clone(t);n.headers=t.headers||{};if(t.auth||n.auth){var s=t.auth||n.auth;var a=r.btoa(s.username+":"+s.password);n.headers.Authorization="Basic "+a}if(t.headers){n.headers=t.headers}return n}return{host:"",path:"/",db:e,auth:false}}function u(e,t){return c(e,e.db+"/"+t)}function c(e,t){if(e.remote){var n=!e.path?"":"/";return e.protocol+"://"+e.host+":"+e.port+"/"+e.path+n+t}return"/"+t}function f(e,t){var n=this;n.getHost=e.getHost?e.getHost:a;var o=n.getHost(e.name,e);var f=u(o,"");n.getUrl=function(){return f};var l=e.ajax||{};e=r.clone(e);function p(e,t){return r.ajax(r.extend({},l,e),t)}var h=function(){p({headers:o.headers,method:"PUT",url:f},function(e,r){if(e&&e.status===401){p({headers:o.headers,method:"HEAD",url:f},function(e,r){if(e){t(e)}else{t(null,n)}})}else if(!e||e.status===412){t(null,n)}else{t(e)}})};if(!e.skipSetup){p({headers:o.headers,method:"GET",url:f},function(e,r){if(e){if(e.status===404){h()}else{t(e)}}else{t(null,n)}})}n.type=function(){return"http"};n.id=r.adapterFun("id",function(e){p({headers:o.headers,method:"GET",url:c(o,"")},function(t,n){var r=n&&n.uuid?n.uuid+o.db:u(o,"");e(null,r)})});n.request=r.adapterFun("request",function(e,t){e.headers=o.headers;e.url=u(o,e.url);p(e,t)});n.compact=r.adapterFun("compact",function(e,t){if(typeof e==="function"){t=e;e={}}e=r.clone(e);p({headers:o.headers,url:u(o,"_compact"),method:"POST"},function(){function r(){n.info(function(n,i){if(!i.compact_running){t()}else{setTimeout(r,e.interval||200)}})}if(typeof t==="function"){r()}})});n._info=function(e){p({headers:o.headers,method:"GET",url:u(o,"")},function(t,n){if(t){e(t)}else{n.host=u(o,"");e(null,n)}})};n.get=r.adapterFun("get",function(e,t,n){if(typeof t==="function"){n=t;t={}}t=r.clone(t);if(t.auto_encode===undefined){t.auto_encode=true}var i=[];if(t.revs){i.push("revs=true")}if(t.revs_info){i.push("revs_info=true")}if(t.local_seq){i.push("local_seq=true")}if(t.open_revs){if(t.open_revs!=="all"){t.open_revs=JSON.stringify(t.open_revs)}i.push("open_revs="+t.open_revs)}if(t.attachments){i.push("attachments=true")}if(t.rev){i.push("rev="+t.rev)}if(t.conflicts){i.push("conflicts="+t.conflicts)}i=i.join("&");i=i===""?"":"?"+i;if(t.auto_encode){e=s(e)}var a={headers:o.headers,method:"GET",url:u(o,e+i)};var c=e.split("/");if(c.length>1&&c[0]!=="_design"&&c[0]!=="_local"||c.length>2&&c[0]==="_design"&&c[0]!=="_local"){a.binary=true}p(a,function(e,t,r){if(e){return n(e)}n(null,t,r)})});n.remove=r.adapterFun("remove",function(e,t,n){if(typeof t==="function"){n=t;t={}}else if(typeof t==="string"){e={_id:e,_rev:t}}else if(t===undefined){t={}}p({headers:o.headers,method:"DELETE",url:u(o,s(e._id))+"?rev="+e._rev},n)});n.getAttachment=r.adapterFun("getAttachment",function(e,t,i,o){if(typeof i==="function"){o=i;i={}}i=r.clone(i);if(i.auto_encode===undefined){i.auto_encode=true}if(i.auto_encode){e=s(e)}i.auto_encode=false;n.get(e+"/"+t,i,o)});n.removeAttachment=r.adapterFun("removeAttachment",function(e,t,n,r){p({headers:o.headers,method:"DELETE",url:u(o,s(e)+"/"+t)+"?rev="+n},r)});n.putAttachment=r.adapterFun("putAttachment",function(e,t,n,r,i,a){if(typeof i==="function"){a=i;i=r;r=n;n=null}if(typeof i==="undefined"){i=r;r=n;n=null}var c=s(e)+"/"+t;var f=u(o,c);if(n){f+="?rev="+n}var l={headers:o.headers,method:"PUT",url:f,processData:false,body:r,timeout:6e4};l.headers["Content-Type"]=i;p(l,a)});n.put=r.adapterFun("put",r.getArguments(function(e){var t,n,a,c;var f=e.shift();var l="_id"in f;if(typeof f!=="object"||Array.isArray(f)){c=e.pop();return c(i.NOT_AN_OBJECT)}f=r.clone(f);while(true){t=e.shift();n=typeof t;if(n==="string"&&!l){f._id=t;l=true}else if(n==="string"&&l&&!("_rev"in f)){f._rev=t}else if(n==="object"){a=r.clone(t)}else if(n==="function"){c=t}if(!e.length){break}}a=a||{};var h=r.invalidIdError(f._id);if(h){return c(h)}var d=[];if(a&&typeof a.new_edits!=="undefined"){d.push("new_edits="+a.new_edits)}d=d.join("&");if(d!==""){d="?"+d}p({headers:o.headers,method:"PUT",url:u(o,s(f._id))+d,body:f},c)}));n.post=r.adapterFun("post",function(e,t,o){if(typeof t==="function"){o=t;t={}}t=r.clone(t);if(typeof e!=="object"){return o(i.NOT_AN_OBJECT)}if(!("_id"in e)){e._id=r.uuid()}n.put(e,t,o)});n._bulkDocs=function(e,t,n){if(typeof t.new_edits!=="undefined"){e.new_edits=t.new_edits}p({headers:o.headers,method:"POST",url:u(o,"_bulk_docs"),body:e},n)};n.allDocs=r.adapterFun("allDocs",function(e,t){if(typeof e==="function"){t=e;e={}}e=r.clone(e);var n=[];var i;var s="GET";if(e.conflicts){n.push("conflicts=true")}if(e.descending){n.push("descending=true")}if(e.include_docs){n.push("include_docs=true")}if(e.key){n.push("key="+encodeURIComponent(JSON.stringify(e.key)))}if(e.startkey){n.push("startkey="+encodeURIComponent(JSON.stringify(e.startkey)))}if(e.endkey){n.push("endkey="+encodeURIComponent(JSON.stringify(e.endkey)))}if(typeof e.inclusive_end!=="undefined"){n.push("inclusive_end="+!!e.inclusive_end)}if(typeof e.limit!=="undefined"){n.push("limit="+e.limit)}if(typeof e.skip!=="undefined"){n.push("skip="+e.skip)}n=n.join("&");if(n!==""){n="?"+n}if(typeof e.keys!=="undefined"){var a=2e3;var c="keys="+encodeURIComponent(JSON.stringify(e.keys));if(c.length+n.length+1<=a){n+=(n.indexOf("?")!==-1?"&":"?")+c}else{s="POST";i=JSON.stringify({keys:e.keys})}}p({headers:o.headers,method:s,url:u(o,"_all_docs"+n),body:i},t)});n._changes=function(e){var t=25;e=r.clone(e);e.timeout=e.timeout||30*1e3;var n={timeout:e.timeout-5*1e3};var s=typeof e.limit!=="undefined"?e.limit:false;if(s===0){s=1}var a;if("returnDocs"in e){a=e.returnDocs}else{a=true}var c=s;if(e.style){n.style=e.style}if(e.include_docs||e.filter&&typeof e.filter==="function"){n.include_docs=true}if(e.continuous){n.feed="longpoll"}if(e.conflicts){n.conflicts=true}if(e.descending){n.descending=true}if(e.filter&&typeof e.filter==="string"){n.filter=e.filter;if(e.filter==="_view"&&e.view&&typeof e.view==="string"){n.view=e.view}}if(e.query_params&&typeof e.query_params==="object"){for(var f in e.query_params){if(e.query_params.hasOwnProperty(f)){n[f]=e.query_params[f]}}}var l;var h;var d=function(r,i){if(e.aborted){return}n.since=r;if(e.descending){if(s){n.limit=c}}else{n.limit=!s||c>t?t:c}var a="?"+Object.keys(n).map(function(e){return e+"="+n[e]}).join("&");var f={headers:o.headers,method:"GET",url:u(o,"_changes"+a),timeout:e.timeout};h=r;if(e.aborted){return}l=p(f,i)};var v=10;var m=0;var g={results:[]};var y=function(n,o){if(e.aborted){return}var u=0;if(o&&o.results){u=o.results.length;g.last_seq=o.last_seq;var f={};f.query=e.query_params;o.results=o.results.filter(function(t){c--;var n=r.filterChange(e)(t);if(n){if(a){g.results.push(t)}r.call(e.onChange,t)}return n})}else if(n){e.aborted=true;r.call(e.complete,n);return}if(o&&o.last_seq){h=o.last_seq}var l=s&&c<=0||o&&u<t||e.descending;if(e.continuous&&!(s&&c<=0)||!l){if(n){m+=1}else{m=0}var p=1<<m;var _=v*p;var b=e.maximumWait||3e4;if(_>b){r.call(e.complete,n||i.UNKNOWN_ERROR);return}setTimeout(function(){d(h,y)},_)}else{r.call(e.complete,null,g)}};d(e.since||0,y);return{cancel:function(){e.aborted=true;if(l){l.abort()}}}};n.revsDiff=r.adapterFun("revsDif",function(e,t,n){if(typeof t==="function"){n=t;t={}}p({headers:o.headers,method:"POST",url:u(o,"_revs_diff"),body:e},function(e,t){n(e,t)})});n._close=function(e){e()};function d(e,i,s,a){i=r.clone(i);var u=n.getHost(a);var f={source:o.db,target:u.protocol===o.protocol&&u.authority===o.authority?u.db:u.source};if(i.continuous){f.continuous=true}if(i.create_target){f.create_target=true}if(i.doc_ids){f.doc_ids=i.doc_ids}if(i.filter&&typeof i.filter==="string"){f.filter=i.filter}if(i.query_params){f.query_params=i.query_params}var l={};var h={headers:o.headers,method:"POST",url:c(o,"_replicate"),body:f};var d;s.cancel=function(){this.cancelled=true;if(d&&!l.ok){d.abort()}if(l._local_id){h.body={replication_id:l._local_id}}h.body.cancel=true;p(h,function(e,n,o){if(e){return t(e)}r.call(i.complete,null,l,o)})};if(s.cancelled){return}d=p(h,function(e,n,o){if(e){return t(e)}l.ok=true;if(n._local_id){l._local_id=n._local_id}r.call(i.complete,null,n,o)})}n.replicateOnServer=function(e,t,r){if(!n.taskqueue.isReady){n.taskqueue.addTask("replicateOnServer",[e,t,r]);return r}e.info(function(n,i){d(e,t,r,i.host)})};n.destroy=r.adapterFun("destroy",function(e){p({url:u(o,""),method:"DELETE",headers:o.headers},function(t,r){if(t){n.emit("error",t);e(t)}else{n.emit("destroyed");e(null,r)}})})}f.destroy=r.toPromise(function(e,t,n){var i=a(e,t);t=t||{};if(typeof t==="function"){n=t;t={}}t=r.clone(t);t.headers=i.headers;t.method="DELETE";t.url=u(i,"");var o=t.ajax||{};t=r.extend({},t,o);r.ajax(t,n)});f.valid=function(){return true};t.exports=f},{"../deps/errors":392,"../utils":403}],385:[function(e,t,n){(function(n,r){"use strict";var i=e("../utils");var o=e("../merge");var s=e("../deps/errors");var a={};var u={running:false,queue:[]};function c(e,t,n){try{e.apply(t,n)}catch(r){if(window.PouchDB){window.PouchDB.emit("error",r)}}}function f(){if(u.running||!u.queue.length){return}u.running=true;var e=u.queue.shift();e.action(function(t,r){c(e.callback,this,[t,r]);u.running=false;n.nextTick(f)})}function l(e){return function(t){var n=t.target&&t.target.error&&t.target.error.name||t.target;e(s.error(s.IDB_ERROR,n,t.type))}}function p(){var e="_pouch__checkModernIdb_"+(r.navigator&&r.navigator.appVersion);var t=i.hasLocalStorage()&&r.localStorage[e];if(t){return JSON.parse(t)}var n="_pouch__checkModernIdb";var o=r.indexedDB.open(n,1).onupgradeneeded===null;if(r.indexedDB.deleteDatabase){r.indexedDB.deleteDatabase(n)}if(i.hasLocalStorage()){r.localStorage[e]=JSON.stringify(o)}return o}function h(e,t){var n=this;u.queue.push({action:function(t){d(n,e,t)},callback:t});f()}function d(e,t,u){var c=2;var f="document-store";var p="by-sequence";var d="attach-store";var v="meta-store";var m="detect-blob-support";var g=t.name;var y=null;var _=null;var b=false;var w=null;var x=-1;function k(e){e.createObjectStore(f,{keyPath:"id"}).createIndex("seq","seq",{unique:true});e.createObjectStore(p,{autoIncrement:true}).createIndex("_doc_id_rev","_doc_id_rev",{unique:true});e.createObjectStore(d,{keyPath:"digest"});e.createObjectStore(v,{keyPath:"id",autoIncrement:false});e.createObjectStore(m)}function E(e){var t=e.currentTarget.transaction.objectStore(f);t.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var r=n.value;var o=i.isDeleted(r);var s=i.isLocalId(r.id);r.deletedOrLocal=o||s?"1":"0";t.put(r);n["continue"]()}else{t.createIndex("deletedOrLocal","deletedOrLocal",{unique:false})}}}e.type=function(){return"idb"};e._id=i.toPromise(function(e){e(null,_)});e._bulkDocs=function T(e,t,n){var r=t.new_edits;var a=e.docs;var u=a.map(function(e,t){var n=i.parseDoc(e,r);n._bulk_seq=t;return n});var c=u.filter(function(e){return e.error});if(c.length){return n(c[0])}var m=[];var _={};var b=0;function k(e){var t=e.target.result;t.updateSeq=(t.updateSeq||0)+b;R.objectStore(v).put(t)}function E(){if(!u.length){R.objectStore(v).get(v).onsuccess=k;return}var e=u.shift();var t=e.metadata.id;if(t in _){return T(_[t],e)}var n=R.objectStore(f).get(t);n.onsuccess=function r(t){var n=t.target.result;if(!n){N(e)}else{T(n,e)}}}function j(e){var t=[];m.sort(O);m.forEach(function(e){delete e._bulk_seq;if(e.error){t.push(e);return}var n=e.metadata;var r=o.winningRev(n);t.push({ok:true,id:n.id,rev:r});if(i.isLocalId(n.id)){return}});h.Changes.notify(g);x=-1;n(null,t)}function S(e,t){if(e.stub){return t()}if(typeof e.data==="string"){var r;try{r=atob(e.data)}catch(o){var a=s.error(s.BAD_ARG,"Attachments need to be base64 encoded");return n(a)}e.digest="md5-"+i.MD5(r);if(y){var u=e.content_type;r=i.fixBinary(r);e.data=i.createBlob([r],{type:u})}return t()}var c=new FileReader;c.onloadend=function(n){var r=i.arrayBufferToBinaryString(this.result);e.digest="md5-"+i.MD5(r);if(!y){e.data=btoa(r)}t()};c.readAsArrayBuffer(e.data)}function A(e){if(!u.length){return e()}var t=0;u.forEach(function(e){var t=e.data&&e.data._attachments?Object.keys(e.data._attachments):[];if(!t.length){return n()}var r=0;function i(){r++;if(r===t.length){n()}}for(var o in e.data._attachments){if(e.data._attachments.hasOwnProperty(o)){S(e.data._attachments[o],i)}}});function n(){t++;if(u.length===t){e()}}}function C(e,t,n,r){var o=null;var s=0;e.data._id=e.metadata.id;e.data._rev=e.metadata.rev;b++;if(n){e.data._deleted=true}var a=e.data._attachments?Object.keys(e.data._attachments):[];function u(e){if(!o){if(e){o=e;r(o)}else if(s===a.length){v()}}}function c(e){s++;u(e)}for(var l in e.data._attachments){if(!e.data._attachments[l].stub){var h=e.data._attachments[l].data;delete e.data._attachments[l].data;var d=e.data._attachments[l].digest;I(e,d,h,c)}else{s++;u()}}function v(){e.data._doc_id_rev=e.data._id+"::"+e.data._rev;var o=R.objectStore(p).index("_doc_id_rev");o.getKey(e.data._doc_id_rev).onsuccess=function(o){var s=o.target.result?R.objectStore(p).put(e.data,o.target.result):R.objectStore(p).put(e.data);s.onsuccess=function(o){var s=e.metadata;s.seq=o.target.result;delete s.rev;var a=i.isLocalId(s.id);s.deletedOrLocal=n||a?"1":"0";s.winningRev=t;var u=R.objectStore(f).put(s);u.onsuccess=function(){delete s.deletedOrLocal;delete s.winningRev;m.push(e);_[e.metadata.id]=e.metadata;i.call(r)}}}}if(!a.length){v()}}function T(e,t){var n=o.merge(e.rev_tree,t.metadata.rev_tree[0],1e3);var a=i.isDeleted(e);var u=i.isDeleted(t.metadata);var c=a&&u&&r||!a&&r&&n.conflicts!=="new_leaf";if(c){m.push(q(s.REV_CONFLICT,t._bulk_seq));return E()}t.metadata.rev_tree=n.tree;var f=o.winningRev(t.metadata);u=i.isDeleted(t.metadata,f);C(t,f,u,E)}function N(e){var n=o.winningRev(e.metadata);var r=i.isDeleted(e.metadata,n);if("was_delete"in t&&r){m.push(s.MISSING_DOC);return E()}C(e,n,r,E)}function q(e,t){e._bulk_seq=t;return e}function I(e,t,n,r){var o=R.objectStore(d);o.get(t).onsuccess=function(s){var a=s.target.result&&s.target.result.refs||{};var u=[e.metadata.id,e.metadata.rev].join("@");var c={digest:t,body:n,refs:a};c.refs[u]=true;o.put(c).onsuccess=function(e){i.call(r)}}}var R;A(function(){R=w.transaction([f,p,d,v],"readwrite");R.onerror=l(n);R.ontimeout=l(n);R.oncomplete=j;E()})};function O(e,t){return e._bulk_seq-t._bulk_seq}e._get=function N(e,t,n){var r;var a;var u;var c;t=i.clone(t);if(t.ctx){c=t.ctx}else{c=w.transaction([f,p,d],"readonly")}function l(){n(u,{doc:r,metadata:a,ctx:c})}c.objectStore(f).get(e).onsuccess=function(e){a=e.target.result;if(!a){u=s.MISSING_DOC;return l()}if(i.isDeleted(a)&&!t.rev){u=s.error(s.MISSING_DOC,"deleted");return l()}var n=c.objectStore(p);var f=t.rev||a.winningRev||o.winningRev(a);var h=a.id+"::"+f;n.index("_doc_id_rev").get(h).onsuccess=function(e){r=e.target.result;if(r&&r._doc_id_rev){delete r._doc_id_rev}if(!r){u=s.MISSING_DOC;return l()}l()}}};e._getAttachment=function(e,t,n){var r;var o;t=i.clone(t);if(t.ctx){o=t.ctx}else{o=w.transaction([f,p,d],"readonly")}var s=e.digest;var a=e.content_type;o.objectStore(d).get(s).onsuccess=function(e){var o=e.target.result.body;if(t.encode){if(y){var s=new FileReader;s.onloadend=function(e){var t=i.arrayBufferToBinaryString(this.result);r=btoa(t);n(null,r)};s.readAsArrayBuffer(o)}else{r=o;n(null,r)}}else{if(y){r=o}else{o=i.fixBinary(atob(o));r=i.createBlob([o],{type:a})}n(null,r)}}};function j(e,t,n){var a="startkey"in t?t.startkey:false;var u="endkey"in t?t.endkey:false;var c="key"in t?t.key:false;var l=t.skip||0;var h=typeof t.limit==="number"?t.limit:-1;var d=t.inclusive_end!==false;var v="descending"in t&&t.descending?"prev":null;var m=false;if(v&&a&&u){m=u;u=false}var g=null;try{if(a&&u){g=r.IDBKeyRange.bound(a,u,false,!d)}else if(a){if(v){g=r.IDBKeyRange.upperBound(a)}else{g=r.IDBKeyRange.lowerBound(a)}}else if(u){if(v){g=r.IDBKeyRange.lowerBound(u,!d)}else{g=r.IDBKeyRange.upperBound(u,!d)}}else if(c){g=r.IDBKeyRange.only(c)}}catch(y){if(y.name==="DataError"&&y.code===0){return n(null,{total_rows:e,offset:t.skip,rows:[]})}else{return n(s.error(s.IDB_ERROR,y.name,y.message))}}var _=w.transaction([f,p],"readonly");_.oncomplete=function(){n(null,{total_rows:e,offset:t.skip,rows:k})};var b=_.objectStore(f);var x=v?b.openCursor(g,v):b.openCursor(g);var k=[];x.onsuccess=function(e){if(!e.target.result){return}var n=e.target.result;var r=n.value;var s=r.winningRev||o.winningRev(r);function a(e,r){if(i.isLocalId(e.id)){return n["continue"]()}var a={id:e.id,key:e.id,value:{rev:s}};if(t.include_docs){a.doc=r;a.doc._rev=s;if(a.doc._doc_id_rev){delete a.doc._doc_id_rev}if(t.conflicts){a.doc._conflicts=o.collectConflicts(e)}for(var u in a.doc._attachments){if(a.doc._attachments.hasOwnProperty(u)){a.doc._attachments[u].stub=true}}}var c=i.isDeleted(e,s);if(t.deleted==="ok"){if(c){a.value.deleted=true;a.doc=null}k.push(a)}else if(!c&&l--<=0){if(m){if(d&&a.key<m){return}else if(!d&&a.key<=m){return}}k.push(a);if(--h===0){return}}n["continue"]()}if(!t.include_docs){a(r)}else{var u=_.objectStore(p).index("_doc_id_rev");var c=r.id+"::"+s;u.get(c).onsuccess=function(e){a(n.value,e.target.result)}}}}function S(e){if(x!==-1){return e(null,x)}var t;var n=w.transaction([f],"readonly");var i=n.objectStore(f).index("deletedOrLocal");i.count(r.IDBKeyRange.only("0")).onsuccess=function(e){t=e.target.result};n.onerror=l(e);n.oncomplete=function(){x=t;e(null,x)}}e._allDocs=function q(e,t){S(function(n,r){if(n){return t(n)}if(e.limit===0){return t(null,{total_rows:r,offset:e.skip,rows:[]})}j(r,e,t)})};e._info=function I(e){S(function(t,n){if(t){return e(t)}if(w===null){var r=new Error("db isn't open");r.id="idbNull";return e(r)}var i=0;var o=w.transaction([v],"readonly");o.objectStore(v).get(v).onsuccess=function(e){i=e.target.result&&e.target.result.updateSeq||0};o.oncomplete=function(){e(null,{db_name:g,doc_count:n,update_seq:i})}})};e._changes=function(t){t=i.clone(t);if(t.continuous){var n=g+":"+i.uuid();h.Changes.addListener(g,n,e,t);h.Changes.notify(g);return{cancel:function(){h.Changes.removeListener(g,n)}}}var s=t.descending?"prev":null;var a=0;t.since=t.since&&!s?t.since:0;var u="limit"in t?t.limit:-1;if(u===0){u=1}var c;if("returnDocs"in t){c=t.returnDocs}else{c=true}var l=[];var d=0;var v=i.filterChange(t);var m;function y(){m=w.transaction([f,p]);m.oncomplete=b;var e;if(s){e=m.objectStore(p).openCursor(r.IDBKeyRange.lowerBound(t.since,true),s)}else{e=m.objectStore(p).openCursor(r.IDBKeyRange.lowerBound(t.since,true))}e.onsuccess=_;e.onerror=onerror}y();function _(e){var n=e.target.result;if(!n){return}var r=n.value;if(i.isLocalId(r._id)||t.doc_ids&&t.doc_ids.indexOf(r._id)===-1){return n["continue"]()}var s=m.objectStore(f);s.get(r._id).onsuccess=function(e){var i=e.target.result;if(a<i.seq){a=i.seq}var s=i.winningRev||o.winningRev(i);if(r._rev!==s){return n["continue"]()}delete r["_doc_id_rev"];var f=t.processChange(r,i,t);f.seq=n.key;if(v(f)){d++;if(c){l.push(f)}t.onChange(f)}if(d!==u){n["continue"]()}}}function b(){if(!t.continuous){t.complete(null,{results:l,last_seq:a})}}};e._close=function(e){if(w===null){return e(s.NOT_OPEN)}w.close();delete a[g];w=null;e()};e._getRevisionTree=function(e,t){var n=w.transaction([f],"readonly");var r=n.objectStore(f).get(e);r.onsuccess=function(e){var n=e.target.result;if(!n){t(s.MISSING_DOC)}else{t(null,n.rev_tree)}}};e._doCompaction=function(e,t,n,r){var o=w.transaction([f,p],"readwrite");var s=o.objectStore(f);s.get(e).onsuccess=function(r){var i=r.target.result;i.rev_tree=t;var s=n.length;n.forEach(function(t){var n=o.objectStore(p).index("_doc_id_rev");var r=e+"::"+t;n.getKey(r).onsuccess=function(e){var t=e.target.result;if(!t){return}o.objectStore(p)["delete"](t);s--;if(!s){o.objectStore(f).put(i)}}})};o.oncomplete=function(){i.call(r)}};var A=a[g];if(A){w=A.idb;y=A.blobSupport;_=A.instanceId;b=A.idStored;n.nextTick(function(){u(null,e)});return}var C=r.indexedDB.open(g,c);if(!("openReqList"in h)){h.openReqList={}}h.openReqList[g]=C;C.onupgradeneeded=function(e){var t=e.target.result;if(e.oldVersion<1){k(t)}if(e.oldVersion<2){E(e)}};C.onsuccess=function(t){w=t.target.result;w.onversionchange=function(){w.close();delete a[g]};w.onabort=function(){w.close();delete a[g]};var n=w.transaction([v,m],"readwrite");var r=n.objectStore(v).get(v);r.onsuccess=function(t){var r=function(){if(y===null||!b){return}else{a[g]={idb:w,blobSupport:y,instanceId:_,idStored:b,loaded:true};u(null,e)}};var o=t.target.result||{id:v};if(g+"_id"in o){_=o[g+"_id"];b=true;r()}else{_=i.uuid();o[g+"_id"]=_;n.objectStore(v).put(o).onsuccess=function(){b=true;r()}}try{n.objectStore(m).put(i.createBlob(),"key");y=true}catch(s){y=false}finally{r()}}};C.onerror=l(u)}h.valid=function(){return r.indexedDB&&p()};function v(e,t,n){if(!("openReqList"in h)){h.openReqList={}}h.Changes.removeAllListeners(e);if(h.openReqList[e]&&h.openReqList[e].result){h.openReqList[e].result.close()}var o=r.indexedDB.deleteDatabase(e);o.onsuccess=function(){if(h.openReqList[e]){h.openReqList[e]=null}if(i.hasLocalStorage()){delete r.localStorage[e]}delete a[e];n(null,{ok:true})};o.onerror=l(n)}h.destroy=i.toPromise(function(e,t,n){u.queue.push({action:function(n){v(e,t,n)},callback:n});f()});h.Changes=new i.Changes;t.exports=h}).call(this,e("OpdoqP"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../deps/errors":392,"../merge":398,"../utils":403,OpdoqP:61}],386:[function(e,t,n){t.exports=["idb","websql"]},{}],387:[function(e,t,n){(function(n){"use strict";var r=e("../utils");var i=e("../merge");var o=e("../deps/errors");function s(e){return"'"+e+"'"}var a={};var u=r.getArguments(function(e){if(typeof n!=="undefined"){if(n.navigator&&n.navigator.sqlitePlugin&&n.navigator.sqlitePlugin.openDatabase){return navigator.sqlitePlugin.openDatabase.apply(navigator.sqlitePlugin,e)}else if(n.sqlitePlugin&&n.sqlitePlugin.openDatabase){return n.sqlitePlugin.openDatabase.apply(n.sqlitePlugin,e)}else{var t=a[e[0]];if(!t){t=a[e[0]]=n.openDatabase.apply(n,e)}return t}}});var c=1;var f=0;var l=2;var p=s("document-store");var h=s("by-sequence");var d=s("attach-store");var v=s("metadata-store");var m="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+h+" (seq, deleted)";var g="CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+p+" (local, id)";var y="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+p+" (winningseq)";var _=h+".seq = "+p+".winningseq";var b=h+".seq AS seq, "+h+".deleted AS deleted, "+h+".json AS data, "+p+".json AS metadata";function w(e,t,n,r,i){return"SELECT "+e+" FROM "+(typeof t==="string"?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+(typeof r==="string"?r:r.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function x(e){return function(t){var n=t&&t.constructor.toString().match(/function ([^\(]+)/);var r=n&&n[1]||t.type;var i=t.target||t.message;e(o.error(o.WSQ_ERROR,i,r))}}function k(e){return decodeURIComponent(window.escape(e))}function E(e,t){var n="";var r=t==="UTF-8"?2:4;for(var i=0,o=e.length;i<o;i+=r){var s=e.substring(i,i+r);if(r===4){s=s.substring(2,4)+s.substring(0,2)}n+=String.fromCharCode(parseInt(s,16))}n=t==="UTF-8"?k(n):n;return n}function O(e,t){var s=this;var a=null;var k=e.name;var j=[];var S=-1;var A;var C=u(k,c,k,f);if(!C){return t(o.UNKNOWN_ERROR)}else if(typeof C.readTransaction!=="function"){C.readTransaction=C.transaction}function T(){if(r.hasLocalStorage()){n.localStorage["_pouch__websqldb_"+k]=true}t(null,s)}function N(e){e.executeSql(y);e.executeSql("ALTER TABLE "+h+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(m);e.executeSql("ALTER TABLE "+p+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql(g);var t="SELECT "+p+".winningseq AS seq, "+p+".json AS metadata FROM "+h+" JOIN "+p+" ON "+h+".seq = "+p+".winningseq";e.executeSql(t,[],function(e,t){var n=[];var i=[];for(var o=0;o<t.rows.length;o++){var s=t.rows.item(o);var a=s.seq;var u=JSON.parse(s.metadata);if(r.isDeleted(u)){n.push(a)}if(r.isLocalId(u.id)){i.push(u.id)}}e.executeSql("UPDATE "+p+"SET local = 1 WHERE id IN ("+i.map(function(){return"?"}).join(",")+")",i);e.executeSql("UPDATE "+h+" SET deleted = 1 WHERE seq IN ("+n.map(function(){return"?"}).join(",")+")",n)})})})}function q(e){while(j.length>0){var t=j.pop();t(null,a)}I(e)}function I(e){e.executeSql("SELECT dbid, hex(dbid) AS hexId FROM "+v,[],function(e,t){var n=t.rows.item(0).dbid;var r=t.rows.item(0).hexId;A=r.length===n.length*2?"UTF-8":"UTF-16"})}function R(e,t){if(t===0){var n="CREATE TABLE IF NOT EXISTS "+v+" (update_seq, dbid, db_version INTEGER)";var i="CREATE TABLE IF NOT EXISTS "+d+" (digest, json, body BLOB)";var o="CREATE TABLE IF NOT EXISTS "+p+" (id unique, json, winningseq, local TINYINT(1))";var s="CREATE TABLE IF NOT EXISTS "+h+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, "+"doc_id_rev UNIQUE, json, deleted TINYINT(1))";e.executeSql(i);e.executeSql(o,[],function(){e.executeSql(y);e.executeSql(g)});e.executeSql(s,[],function(){e.executeSql(m)});e.executeSql(n,[],function(){var t="INSERT INTO "+v+" (update_seq, db_version, dbid) VALUES (?, ?, ?)";a=r.uuid();e.executeSql(t,[0,l,a]);q(e)})}else{if(t===1){N(e);e.executeSql("UPDATE "+v+" SET db_version = "+l)}e.executeSql("SELECT dbid FROM "+v,[],function(e,t){a=t.rows.item(0).dbid;q(e)})}}function B(){C.transaction(function(e){e.executeSql("SELECT sql FROM sqlite_master WHERE tbl_name = "+v,[],function(e,t){if(!t.rows.length){R(e,0)}else if(!/db_version/.test(t.rows.item(0).sql)){e.executeSql("ALTER TABLE "+v+" ADD COLUMN db_version INTEGER",[],function(){R(e,1)})}else{e.executeSql("SELECT db_version FROM "+v,[],function(e,t){var n=t.rows.item(0).db_version;R(e,n)})}})},x(t),T)}if(r.isCordova()&&typeof n!=="undefined"){n.addEventListener(k+"_pouch",function D(){n.removeEventListener(k+"_pouch",D,false);B()},false)}else{B()}s.type=function(){return"websql"};s._id=r.toPromise(function(e){e(null,a)});s._info=function(e){C.readTransaction(function(t){L(t,function(n){var r="SELECT update_seq FROM "+v;t.executeSql(r,[],function(t,r){var i=r.rows.item(0).update_seq;e(null,{db_name:k,doc_count:n,update_seq:i})})})},x(e))};s._bulkDocs=function(e,t,n){var s=t.new_edits;var a=e.docs;var u=0;var c=a.map(function(e,t){var n=r.parseDoc(e,s);n._bulk_seq=t;return n});var f=c.filter(function(e){return e.error});if(f.length){return n(f[0])}var l;var m=[];var g={};function y(e,t){return e._bulk_seq-t._bulk_seq}function _(e){var t=[];m.sort(y);m.forEach(function(e){delete e._bulk_seq;if(e.error){t.push(e);return}var n=e.metadata;var o=i.winningRev(n);t.push({ok:true,id:n.id,rev:o});if(r.isLocalId(n.id)){return}u++});O.Changes.notify(k);var o="SELECT update_seq FROM "+v;l.executeSql(o,[],function(e,r){var i=r.rows.item(0).update_seq+u;var o="UPDATE "+v+" SET update_seq=?";e.executeSql(o,[i],function(){n(null,t)})})}function b(e,t){if(e.stub){return t()}if(typeof e.data==="string"){try{e.data=atob(e.data)}catch(i){var s=o.error(o.BAD_ARG,"Attachments need to be base64 encoded");return n(s)}var a=r.fixBinary(e.data);e.data=r.createBlob([a],{type:e.content_type})}var u=new FileReader;u.onloadend=function(n){var i=r.arrayBufferToBinaryString(this.result);e.data=i;e.digest="md5-"+r.MD5(i);t()};u.readAsArrayBuffer(e.data)}function E(e){if(!c.length){return e()}var t=0;c.forEach(function(e){var t=e.data&&e.data._attachments?Object.keys(e.data._attachments):[];var r=0;if(!t.length){return n()}function i(){r++;if(r===t.length){n()}}for(var o in e.data._attachments){if(e.data._attachments.hasOwnProperty(o)){b(e.data._attachments[o],i)}}});function n(){t++;if(c.length===t){e()}}}function j(e,t,n,i,o){function s(){var t=e.data;var r=t._id+"::"+t._rev;var i=n?1:0;var o=w("seq",h,null,"doc_id_rev=?");l.executeSql(o,[r],function(e,n){var o,s;if(n.rows.length){o="UPDATE "+h+" SET json=?, deleted=? WHERE doc_id_rev=?;";s=[JSON.stringify(t),i,r];l.executeSql(o,s,function(e){b(e,n.rows.item(0).seq)})}else{o="INSERT INTO "+h+" (doc_id_rev, json, deleted) VALUES (?, ?, ?);";s=[r,JSON.stringify(t),i];l.executeSql(o,s,function(e,t){b(e,t.insertId)})}})}function a(e){if(!u){if(e){u=e;i(u)}else if(c===f.length){s()}}}var u=null;var c=0;e.data._id=e.metadata.id;e.data._rev=e.metadata.rev;if(n){e.data._deleted=true}var f=e.data._attachments?Object.keys(e.data._attachments):[];function d(e){c++;a(e)}for(var v in e.data._attachments){if(!e.data._attachments[v].stub){var y=e.data._attachments[v].data;delete e.data._attachments[v].data;var _=e.data._attachments[v].digest;I(e,_,y,d)}else{c++;a()}}if(!f.length){s()}function b(n,s){e.metadata.seq=s;delete e.metadata.rev;var a=o?"UPDATE "+p+" SET json=?, winningseq=(SELECT seq FROM "+h+" WHERE doc_id_rev=?) WHERE id=?":"INSERT INTO "+p+" (id, winningseq, json, local) VALUES (?, ?, ?, ?);";var u=JSON.stringify(e.metadata);var c=e.metadata.id+"::"+t;var f=r.isLocalId(e.metadata.id)?1:0;var l=o?[u,c,e.metadata.id]:[e.metadata.id,s,u,f];n.executeSql(a,l,function(){m.push(e);g[e.metadata.id]=e.metadata;i()})}}function A(e,t){var n=i.merge(e.rev_tree,t.metadata.rev_tree[0],1e3);var a=r.isDeleted(t.metadata);var u=r.isDeleted(e);var c=u&&a&&s||!u&&s&&n.conflicts!=="new_leaf";if(c){m.push(q(o.REV_CONFLICT,t._bulk_seq));return N()}t.metadata.rev_tree=n.tree;var f=i.winningRev(t.metadata);a=r.isDeleted(t.metadata,f);j(t,f,a,N,true)}function T(e){var n=i.winningRev(e.metadata);var s=r.isDeleted(e.metadata,n);if("was_delete"in t&&s){m.push(o.MISSING_DOC);return N()}j(e,n,s,N,false)}function N(){if(!c.length){return _()}var e=c.shift();var t=e.metadata.id;if(t in g){return A(g[t],e)}l.executeSql("SELECT json FROM "+p+" WHERE id = ?",[t],function(t,n){if(n.rows.length){var r=JSON.parse(n.rows.item(0).json);A(r,e)}else{T(e)}})}function q(e,t){e._bulk_seq=t;return e}function I(e,t,n,r){var i=[e.metadata.id,e.metadata.rev].join("@");var o={digest:t};var s="SELECT digest, json FROM "+d+" WHERE digest=?";l.executeSql(s,[t],function(e,a){if(!a.rows.length){o.refs={};o.refs[i]=true;s="INSERT INTO "+d+"(digest, json, body) VALUES (?, ?, ?)";e.executeSql(s,[t,JSON.stringify(o),n],function(){r()})}else{o.refs=JSON.parse(a.rows.item(0).json).refs;s="UPDATE "+d+" SET json=?, body=? WHERE digest=?";e.executeSql(s,[JSON.stringify(o),n,t],function(){r()})}})}E(function(){C.transaction(function(e){l=e;N()},x(n),function(){S=-1})})};s._get=function(e,t,n){t=r.clone(t);var i;var a;var u;if(!t.ctx){C.readTransaction(function(r){t.ctx=r;s._get(e,t,n)
});return}var c=t.ctx;function f(){n(u,{doc:i,metadata:a,ctx:c})}var l;var d;if(t.rev){l=w(b,[p,h],null,[h+".doc_id_rev=?",p+".id=?"]);d=[e+"::"+t.rev,e]}else{l=w(b,[p,h],_,p+".id=?");d=[e]}c.executeSql(l,d,function(e,n){if(!n.rows.length){u=o.MISSING_DOC;return f()}var r=n.rows.item(0);a=JSON.parse(r.metadata);if(r.deleted&&!t.rev){u=o.error(o.MISSING_DOC,"deleted");return f()}i=JSON.parse(r.data);f()})};function L(e,t){if(S!==-1){return t(S)}var n=w("COUNT("+p+".id) AS 'num'",[p,h],_,[h+".deleted=0",p+".local=0"]);e.executeSql(n,[],function(e,n){S=n.rows.item(0).num;t(S)})}s._allDocs=function(e,t){var n=[];var r;var o="startkey"in e?e.startkey:false;var s="endkey"in e?e.endkey:false;var a="key"in e?e.key:false;var u="descending"in e?e.descending:false;var c="limit"in e?e.limit:-1;var f="skip"in e?e.skip:0;var l=e.inclusive_end!==false;var d=[];var v=[p+".local = 0"];if(a!==false){v.push(p+".id = ?");d.push(a)}else if(o!==false||s!==false){if(o!==false){v.push(p+".id "+(u?"<=":">=")+" ?");d.push(o)}if(s!==false){var m=u?">":"<";if(l){m+="="}v.push(p+".id "+m+" ?");d.push(s)}if(a!==false){v.push(p+".id = ?");d.push(a)}}if(e.deleted!=="ok"){v.push(h+".deleted = 0")}C.readTransaction(function(t){L(t,function(o){r=o;if(c===0){return}var s=w(b,[p,h],_,v,p+".id "+(u?"DESC":"ASC"));s+=" LIMIT "+c+" OFFSET "+f;t.executeSql(s,d,function(t,r){for(var o=0,s=r.rows.length;o<s;o++){var a=r.rows.item(o);var u=JSON.parse(a.metadata);var c=JSON.parse(a.data);var f=c._rev;var l={id:u.id,key:u.id,value:{rev:f}};if(e.include_docs){l.doc=c;l.doc._rev=f;if(e.conflicts){l.doc._conflicts=i.collectConflicts(u)}for(var p in l.doc._attachments){if(l.doc._attachments.hasOwnProperty(p)){l.doc._attachments[p].stub=true}}}if(a.deleted){if(e.deleted==="ok"){l.value.deleted=true;l.doc=null}else{continue}}n.push(l)}})})},x(t),function(){t(null,{total_rows:r,offset:e.skip,rows:n})})};s._changes=function(e){e=r.clone(e);if(e.continuous){var t=k+":"+r.uuid();O.Changes.addListener(k,t,s,e);O.Changes.notify(k);return{cancel:function(){O.Changes.removeListener(k,t)}}}var n=e.descending;e.since=e.since&&!n?e.since:0;var i="limit"in e?e.limit:-1;if(i===0){i=1}var o;if("returnDocs"in e){o=e.returnDocs}else{o=true}var a=[];var u=0;function c(){var t=[p+".winningseq > "+e.since,p+".local = 0"];var s=[];if(e.doc_ids){t.push(p+".id IN ("+e.doc_ids.map(function(){return"?"}).join(",")+")");s=e.doc_ids}var c=w(b,[p,h],_,t,p+".winningseq "+(n?"DESC":"ASC"));var f=r.filterChange(e);if(!e.view&&!e.filter){c+=" LIMIT "+i}C.readTransaction(function(t){t.executeSql(c,s,function(t,n){var r=0;for(var s=0,c=n.rows.length;s<c;s++){var l=n.rows.item(s);var p=JSON.parse(l.metadata);if(r<l.seq){r=l.seq}var h=JSON.parse(l.data);var d=e.processChange(h,p,e);d.seq=l.seq;if(f(d)){u++;if(o){a.push(d)}e.onChange(d)}if(u===i){break}}if(!e.continuous){e.complete(null,{results:a,last_seq:r})}})})}c()};s._close=function(e){e()};s._getAttachment=function(e,t,n){var i;var o=t.ctx;var s=e.digest;var a=e.content_type;var u="SELECT hex(body) as body FROM "+d+" WHERE digest=?";o.executeSql(u,[s],function(e,o){var s=E(o.rows.item(0).body,A);if(t.encode){i=btoa(s)}else{s=r.fixBinary(s);i=r.createBlob([s],{type:a})}n(null,i)})};s._getRevisionTree=function(e,t){C.readTransaction(function(n){var r="SELECT json AS metadata FROM "+p+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(!n.rows.length){t(o.MISSING_DOC)}else{var r=JSON.parse(n.rows.item(0).metadata);t(null,r.rev_tree)}})})};s._doCompaction=function(e,t,n,i){if(!n.length){return i()}C.transaction(function(o){var s="SELECT json AS metadata FROM "+p+" WHERE id = ?";o.executeSql(s,[e],function(o,s){if(!s.rows.length){return r.call(i)}var a=JSON.parse(s.rows.item(0).metadata);a.rev_tree=t;var u=0;n.forEach(function(t){var r=e+"::"+t;var s="DELETE FROM "+h+" WHERE doc_id_rev = ?";o.executeSql(s,[r],function(t){if(++u===n.length){var r="UPDATE "+p+" SET json = ? WHERE id = ?";t.executeSql(r,[JSON.stringify(a),e],function(){i()})}})})})})}}O.valid=function(){if(typeof n!=="undefined"){if(n.navigator&&n.navigator.sqlitePlugin&&n.navigator.sqlitePlugin.openDatabase){return true}else if(n.sqlitePlugin&&n.sqlitePlugin.openDatabase){return true}else if(n.openDatabase){return true}}return false};O.destroy=r.toPromise(function(e,t,i){O.Changes.removeAllListeners(e);var o=u(e,c,e,f);o.transaction(function(e){var t=[p,h,d,v];t.forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},x(i),function(){if(r.hasLocalStorage()){delete n.localStorage["_pouch__websqldb_"+e];delete n.localStorage[e]}i(null,{ok:true})})});O.Changes=new r.Changes;t.exports=O}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../deps/errors":392,"../merge":398,"../utils":403}],388:[function(e,t,n){"use strict";var r=e("./utils");var i=e("./merge");var o=e("./deps/errors");var s=e("events").EventEmitter;var a=e("./evalFilter");var u=e("./evalView");t.exports=c;r.inherits(c,s);function c(e,t,n){s.call(this);var i=this;this.db=e;t=t?r.clone(t):{};var o=n||t.complete||function(){};var a=t.complete=r.once(function(t,n){if(t){i.emit("error",t)}else{i.emit("complete",n)}i.removeAllListeners();e.removeListener("destroyed",c)});if(o){i.on("complete",function(e){o(null,e)});i.on("error",function(e){o(e)})}var u=t.onChange;if(u){i.on("change",u)}function c(){i.cancel()}e.once("destroyed",c);t.onChange=function(e){if(t.isCancelled){return}i.emit("change",e);if(i.startSeq&&i.startSeq<=e.seq){i.emit("uptodate");i.startSeq=false}if(e.deleted){i.emit("delete",e)}else if(e.changes.length===1&&e.changes[0].rev.slice(0,2)==="1-"){i.emit("create",e)}else{i.emit("update",e)}};var f=new r.Promise(function(e,n){t.complete=function(t,r){if(t){n(t)}else{e(r)}}});i.once("cancel",function(){if(u){i.removeListener("change",u)}t.complete(null,{status:"cancelled"})});this.then=f.then.bind(f);this["catch"]=f["catch"].bind(f);this.then(function(e){a(null,e)},a);if(!e.taskqueue.isReady){e.taskqueue.addTask(function(){if(i.isCancelled){i.emit("cancel")}else{i.doChanges(t)}})}else{i.doChanges(t)}}c.prototype.cancel=function(){this.isCancelled=true;if(this.db.taskqueue.isReady){this.emit("cancel")}};function f(e,t,n){var o=[{rev:e._rev}];if(n.style==="all_docs"){o=i.collectLeaves(t.rev_tree).map(function(e){return{rev:e.rev}})}var s={id:t.id,changes:o,doc:e};if(r.isDeleted(t,e._rev)){s.deleted=true}if(n.conflicts){s.doc._conflicts=i.collectConflicts(t);if(!s.doc._conflicts.length){delete s.doc._conflicts}}return s}c.prototype.doChanges=function(e){var t=this;var n=e.complete;e=r.clone(e);if("live"in e&&!("continuous"in e)){e.continuous=e.live}e.processChange=f;if(e.since==="latest"){e.since="now"}if(!e.since){e.since=0}if(e.since==="now"){this.db.info().then(function(r){if(t.isCancelled){n(null,{status:"cancelled"});return}e.since=r.update_seq-1;t.doChanges(e)},n);return}if(e.continuous&&e.since!=="now"){this.db.info().then(function(e){t.startSeq=e.update_seq-1},function(e){if(e.id==="idbNull"){return}throw e})}if(this.db.type()!=="http"&&e.filter&&typeof e.filter==="string"){return this.filterChanges(e)}if(!("descending"in e)){e.descending=false}e.limit=e.limit===0?1:e.limit;e.complete=n;var i=this.db._changes(e);if(i&&typeof i.cancel==="function"){var o=t.cancel;t.cancel=r.getArguments(function(e){i.cancel();o.apply(this,e)})}};c.prototype.filterChanges=function(e){var t=this;var n=e.complete;if(e.filter==="_view"){if(!e.view||typeof e.view!=="string"){var r=new Error("`view` filter parameter is not provided.");r.status=o.BAD_REQUEST.status;r.name=o.BAD_REQUEST.name;r.error=true;n(r);return}var i=e.view.split("/");this.db.get("_design/"+i[0],function(r,s){if(t.isCancelled){n(null,{status:"cancelled"});return}if(r){n(r);return}if(s&&s.views&&s.views[i[1]]){var a=u(s.views[i[1]].map);e.filter=a;t.doChanges(e);return}var c=s.views?"missing json key: "+i[1]:"missing json key: views";if(!r){r=new Error(c);r.status=o.MISSING_DOC.status;r.name=o.MISSING_DOC.name;r.error=true}n(r);return})}else{var s=e.filter.split("/");this.db.get("_design/"+s[0],function(r,i){if(t.isCancelled){n(null,{status:"cancelled"});return}if(r){n(r);return}if(i&&i.filters&&i.filters[s[1]]){var u=a(i.filters[s[1]]);e.filter=u;t.doChanges(e);return}else{var c=i&&i.filters?"missing json key: "+s[1]:"missing json key: filters";if(!r){r=new Error(c);r.status=o.MISSING_DOC.status;r.name=o.MISSING_DOC.name;r.error=true}n(r);return}})}}},{"./deps/errors":392,"./evalFilter":395,"./evalView":396,"./merge":398,"./utils":403,events:60}],389:[function(e,t,n){(function(n){"use strict";var r=e("./adapter");var i=e("./utils");var o=e("./taskqueue");var s=i.Promise;function a(e){if(e&&n.debug){console.error(e)}}i.inherits(u,r);function u(e,t,n){if(!(this instanceof u)){return new u(e,t,n)}var c=this;if(typeof t==="function"||typeof t==="undefined"){n=t;t={}}if(typeof e==="object"){t=e;e=undefined}if(typeof n==="undefined"){n=a}t=t||{};var f=n;c.auto_compaction=t.auto_compaction;c.prefix=u.prefix;r.call(c);c.taskqueue=new o;var l=new s(function(r,o){n=function(e,t){if(e){return o(e)}delete t.then;r(t)};t=i.clone(t);var s=t.name||e;var a,f;(function(){try{if(typeof s!=="string"){f=new Error("Missing/invalid DB name");f.code=400;throw f}a=u.parseAdapter(s,t);t.originalName=s;t.name=a.name;t.adapter=t.adapter||a.adapter;c._adapter=t.adapter;if(!u.adapters[t.adapter]){f=new Error("Adapter is missing");f.code=404;throw f}if(!u.adapters[t.adapter].valid()){f=new Error("Invalid Adapter");f.code=404;throw f}}catch(e){c.taskqueue.fail(e);c.changes=i.toPromise(function(t){if(t.complete){t.complete(e)}})}})();if(f){return o(f)}c.adapter=t.adapter;c.replicate={};c.replicate.from=function(e,t,n){return u.replicate(e,c,t,n)};c.replicate.to=function(e,t,n){return u.replicate(c,e,t,n)};c.sync=function(e,t,n){return u.sync(c,e,t,n)};c.replicate.sync=c.sync;c.destroy=i.adapterFun("destroy",function(e){var t=this;t.info(function(t,n){if(t){return e(t)}u.destroy(n.db_name,e)})});u.adapters[t.adapter].call(c,t,function(e,r){if(e){if(n){c.taskqueue.fail(e);n(e)}return}function i(e){if(e==="destroyed"){c.emit("destroyed");u.removeListener(t.name,i)}}u.on(t.name,i);c.emit("created",c);u.emit("created",t.originalName);c.taskqueue.ready(c);n(null,c)});if(t.skipSetup){c.taskqueue.ready(c)}if(i.isCordova()){cordova.fireWindowEvent(t.name+"_pouch",{})}});l.then(function(e){f(null,e)},f);c.then=l.then.bind(l);c["catch"]=l["catch"].bind(l)}t.exports=u}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./adapter":383,"./taskqueue":402,"./utils":403}],390:[function(e,t,n){"use strict";var r=e("./blob.js");var i=e("./errors");var o=e("../utils");var s;function a(e,t){var n=false;var a=o.getArguments(function(e){if(n){return}t.apply(this,e);n=true});if(typeof e==="function"){a=e;e={}}e=o.clone(e);var u={method:"GET",headers:{},json:true,processData:true,timeout:1e4,cache:false};e=o.extend(true,u,e);if(e.method==="GET"&&!e.cache){var c=e.url.indexOf("?")!==-1;e.url+=(c?"&":"?")+"_nonce="+o.uuid(16)}function f(t,n,r){if(!e.binary&&!e.json&&e.processData&&typeof t!=="string"){t=JSON.stringify(t)}else if(!e.binary&&e.json&&typeof t==="string"){try{t=JSON.parse(t)}catch(o){return r(o)}}if(Array.isArray(t)){t=t.map(function(e){var t;if(e.ok){return e}else if(e.error&&e.error==="conflict"){t=i.REV_CONFLICT;t.id=e.id;return t}else if(e.error&&e.error==="forbidden"){t=i.FORBIDDEN;t.id=e.id;t.reason=e.reason;return t}else if(e.missing){t=i.MISSING_DOC;t.missing=e.missing;return t}else{return e}})}r(null,t,n)}function l(e,t){var n,r,o,s;try{n=JSON.parse(e.responseText);for(s in i){if(i.hasOwnProperty(s)&&i[s].name===n.error){o=i[s];break}}if(!o){o=i.UNKNOWN_ERROR;if(e.status){o.status=e.status}if(e.statusText){e.name=e.statusText}}r=i.error(o,n.reason)}catch(a){for(var s in i){if(i.hasOwnProperty(s)&&i[s].status===e.status){o=i[s];break}}if(!o){o=i.UNKNOWN_ERROR;if(e.status){o.status=e.status}if(e.statusText){e.name=e.statusText}}r=i.error(o)}t(r)}var p;var h;if(e.xhr){h=new e.xhr}else{h=new XMLHttpRequest}h.open(e.method,e.url);h.withCredentials=true;if(e.json){e.headers.Accept="application/json";e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json";if(e.body&&e.processData&&typeof e.body!=="string"){e.body=JSON.stringify(e.body)}}if(e.binary){h.responseType="arraybuffer"}var d=function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);r="; expires="+i.toGMTString()}document.cookie=e+"="+t+r+"; path=/"};for(var v in e.headers){if(v==="Cookie"){var m=e.headers[v].split("=");d(m[0],m[1],10)}else{h.setRequestHeader(v,e.headers[v])}}if(!("body"in e)){e.body=null}var g=function(){if(n){return}h.abort();l(h,a)};h.onreadystatechange=function(){if(h.readyState!==4||n){return}clearTimeout(p);if(h.status>=200&&h.status<300){var t;if(e.binary){t=r([h.response||""],{type:h.getResponseHeader("Content-Type")})}else{t=h.responseText}f(t,h,a)}else{l(h,a)}};if(e.timeout>0){p=setTimeout(g,e.timeout);h.onprogress=function(){clearTimeout(p);p=setTimeout(g,e.timeout)};if(typeof s==="undefined"){s=Object.keys(h).indexOf("upload")!==-1}if(s){h.upload.onprogress=h.onprogress}}if(e.body&&e.body instanceof Blob){var y=new FileReader;y.onloadend=function(e){var t="";var n=new Uint8Array(this.result);var r=n.byteLength;for(var i=0;i<r;i++){t+=String.fromCharCode(n[i])}t=o.fixBinary(t);h.send(t)};y.readAsArrayBuffer(e.body)}else{h.send(e.body)}return{abort:g}}t.exports=a},{"../utils":403,"./blob.js":391,"./errors":392}],391:[function(e,t,n){(function(e){"use strict";function n(t,n){t=t||[];n=n||{};try{return new Blob(t,n)}catch(r){if(r.name!=="TypeError"){throw r}var i=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder;var o=new i;for(var s=0;s<t.length;s+=1){o.append(t[s])}return o.getBlob(n.type)}}t.exports=n}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],392:[function(e,t,n){"use strict";function r(e){this.status=e.status;this.name=e.error;this.message=e.reason;this.error=true}r.prototype__proto__=Error.prototype;r.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})};n.UNAUTHORIZED=new r({status:401,error:"unauthorized",reason:"Name or password is incorrect."});n.MISSING_BULK_DOCS=new r({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"});n.MISSING_DOC=new r({status:404,error:"not_found",reason:"missing"});n.REV_CONFLICT=new r({status:409,error:"conflict",reason:"Document update conflict"});n.INVALID_ID=new r({status:400,error:"invalid_id",reason:"_id field must contain a string"});n.MISSING_ID=new r({status:412,error:"missing_id",reason:"_id is required for puts"});n.RESERVED_ID=new r({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."});n.NOT_OPEN=new r({status:412,error:"precondition_failed",reason:"Database not open"});n.UNKNOWN_ERROR=new r({status:500,error:"unknown_error",reason:"Database encountered an unknown error"});n.BAD_ARG=new r({status:500,error:"badarg",reason:"Some query argument is invalid"});n.INVALID_REQUEST=new r({status:400,error:"invalid_request",reason:"Request was invalid"});n.QUERY_PARSE_ERROR=new r({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"});n.DOC_VALIDATION=new r({status:500,error:"doc_validation",reason:"Bad special document member"});n.BAD_REQUEST=new r({status:400,error:"bad_request",reason:"Something wrong with the request"});n.NOT_AN_OBJECT=new r({status:400,error:"bad_request",reason:"Document must be a JSON object"});n.DB_MISSING=new r({status:404,error:"not_found",reason:"Database not found"});n.IDB_ERROR=new r({status:500,error:"indexed_db_went_bad",reason:"unknown"});n.WSQ_ERROR=new r({status:500,error:"web_sql_went_bad",reason:"unknown"});n.LDB_ERROR=new r({status:500,error:"levelDB_went_went_bad",reason:"unknown"});n.FORBIDDEN=new r({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"});n.error=function(e,t,n){function r(e){this.message=t;if(n){this.name=n}}r.prototype=e;return new r(t)}},{}],393:[function(e,t,n){"use strict";var r=e("../utils").Promise;function i(e,t,n){return new r(function(r,i){if(t&&typeof t==="object"){t=t._id}if(typeof t!=="string"){return i(new Error("doc id is required"))}e.get(t,function(s,a){if(s){if(s.name!=="not_found"){return i(s)}return r(o(e,n({_id:t}),n))}var u=n(a);if(!u){return r(a)}r(o(e,u,n))})})}function o(e,t,n){return e.put(t)["catch"](function(r){if(r.name!=="conflict"){throw r}return i(e,t,n)})}t.exports=function(e,t,n,r){if(typeof r==="function"){i(e,t,n).then(function(e){r(null,e)},r)}else{return i(e,t,n)}}},{"../utils":403}],394:[function(e,t,n){"use strict";var r=("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz").split("");function i(e){return 0|Math.random()*e}function o(e,t){t=t||r.length;var n="";var o=-1;if(e){while(++o<e){n+=r[i(t)]}return n}while(++o<36){switch(o){case 8:case 13:case 18:case 23:n+="-";break;case 19:n+=r[i(16)&3|8];break;default:n+=r[i(16)]}}return n}t.exports=o},{}],395:[function(require,module,exports){"use strict";module.exports=evalFilter;function evalFilter(input){return eval(["(function () { return ",input," })()"].join(""))}},{}],396:[function(require,module,exports){"use strict";module.exports=evalView;function evalView(input){return eval(["(function () {","  return function (doc) {","    var emitted = false;","    var emit = function (a, b) {","      emitted = true;","    };","    var view = "+input+";","    view(doc);","    if (emitted) {","      return true;","    }","  }","})()"].join("\n"))}},{}],397:[function(e,t,n){(function(n){"use strict";var r=e("./setup");t.exports=r;r.ajax=e("./deps/ajax");r.extend=e("pouchdb-extend");r.utils=e("./utils");r.Errors=e("./deps/errors");r.replicate=e("./replicate").replicate;r.sync=e("./sync");r.version=e("./version");var i=e("./adapters/http");r.adapter("http",i);r.adapter("https",i);r.adapter("idb",e("./adapters/idb"));r.adapter("websql",e("./adapters/websql"));r.plugin(e("pouchdb-mapreduce"));if(!n.browser){var o=e("./adapters/leveldb");r.adapter("ldb",o);r.adapter("leveldb",o)}}).call(this,e("OpdoqP"))},{"./adapters/http":384,"./adapters/idb":385,"./adapters/leveldb":59,"./adapters/websql":387,"./deps/ajax":390,"./deps/errors":392,"./replicate":399,"./setup":400,"./sync":401,"./utils":403,"./version":404,OpdoqP:61,"pouchdb-extend":425,"pouchdb-mapreduce":428}],398:[function(e,t,n){"use strict";var r=e("pouchdb-extend");function i(e){var t=e.shift();var n=[t.id,t.opts,[]];var r=n;var i;while(e.length){t=e.shift();i=[t.id,t.opts,[]];r[2].push(i);r=i}return n}function o(e,t){var n=[{tree1:e,tree2:t}];var r=false;while(n.length>0){var i=n.pop();var o=i.tree1;var s=i.tree2;if(o[1].status||s[1].status){o[1].status=o[1].status==="available"||s[1].status==="available"?"available":"missing"}for(var a=0;a<s[2].length;a++){if(!o[2][0]){r="new_leaf";o[2][0]=s[2][a];continue}var u=false;for(var c=0;c<o[2].length;c++){if(o[2][c][0]===s[2][a][0]){n.push({tree1:o[2][c],tree2:s[2][a]});u=true}}if(!u){r="new_branch";o[2].push(s[2][a]);o[2].sort()}}}return{conflicts:r,tree:e}}function s(e,t,n){var r=[];var i=false;var s=false;var a;if(!e.length){return{tree:[t],conflicts:"new_leaf"}}e.forEach(function(e){if(e.pos===t.pos&&e.ids[0]===t.ids[0]){a=o(e.ids,t.ids);r.push({pos:e.pos,ids:a.tree});i=i||a.conflicts;s=true}else if(n!==true){var u=e.pos<t.pos?e:t;var c=e.pos<t.pos?t:e;var f=c.pos-u.pos;var l=[];var p=[];p.push({ids:u.ids,diff:f,parent:null,parentIdx:null});while(p.length>0){var h=p.pop();if(h.diff===0){if(h.ids[0]===c.ids[0]){l.push(h)}continue}if(!h.ids){continue}h.ids[2].forEach(function(e,t){p.push({ids:e,diff:h.diff-1,parent:h.ids,parentIdx:t})})}var d=l[0];if(!d){r.push(e)}else{a=o(d.ids,c.ids);d.parent[2][d.parentIdx]=a.tree;r.push({pos:u.pos,ids:u.ids});i=i||a.conflicts;s=true}}else{r.push(e)}});if(!s){r.push(t)}r.sort(function(e,t){return e.pos-t.pos});return{tree:r,conflicts:i||"internal_node"}}function a(e,t){var n=u.rootToLeaf(e).map(function(e){var n=e.ids.slice(-t);return{pos:e.pos+(e.ids.length-n.length),ids:i(n)}});return n.reduce(function(e,t,n,r){return s(e,t,true).tree},[n.shift()])}var u={};u.merge=function(e,t,n){e=r(true,[],e);t=r(true,{},t);var i=s(e,t);return{tree:a(i.tree,n),conflicts:i.conflicts}};u.winningRev=function(e){var t=[];u.traverseRevTree(e.rev_tree,function(e,n,r,i,o){if(e){t.push({pos:n,id:r,deleted:!!o.deleted})}});t.sort(function(e,t){if(e.deleted!==t.deleted){return e.deleted>t.deleted?1:-1}if(e.pos!==t.pos){return t.pos-e.pos}return e.id<t.id?1:-1});return t[0].pos+"-"+t[0].id};u.traverseRevTree=function(e,t){var n=e.slice();var r;while(r=n.pop()){var i=r.pos;var o=r.ids;var s=o[2];var a=t(s.length===0,i,o[0],r.ctx,o[1]);for(var u=0,c=s.length;u<c;u++){n.push({pos:i+1,ids:s[u],ctx:a})}}};u.collectLeaves=function(e){var t=[];u.traverseRevTree(e,function(e,n,r,i,o){if(e){t.unshift({rev:n+"-"+r,pos:n,opts:o})}});t.sort(function(e,t){return t.pos-e.pos});t.map(function(e){delete e.pos});return t};u.collectConflicts=function(e){var t=u.winningRev(e);var n=u.collectLeaves(e.rev_tree);var r=[];n.forEach(function(e){if(e.rev!==t&&!e.opts.deleted){r.push(e.rev)}});return r};u.rootToLeaf=function(e){var t=[];u.traverseRevTree(e,function(e,n,r,i,o){i=i?i.slice(0):[];i.push({id:r,opts:o});if(e){var s=n+1-i.length;t.unshift({pos:s,ids:i})}return i});return t};t.exports=u},{"pouchdb-extend":425}],399:[function(e,t,n){"use strict";var r=e("./utils");var i=e("./index");var o=e("events").EventEmitter;r.inherits(s,o);function s(e){o.call(this);this.cancelled=false;var t=this;var n=new r.Promise(function(e,n){t.once("complete",e);t.once("error",n)});t.then=function(e,t){return n.then(e,t)};t["catch"]=function(e){return n["catch"](e)};t["catch"](function(e){})}s.prototype.cancel=function(){this.cancelled=true;this.emit("cancel")};s.prototype.ready=function(e,t){var n=this;function r(){n.cancel()}e.once("destroyed",r);t.once("destroyed",r);function i(){n.removeAllListeners();e.removeListener("destroyed",r);t.removeListener("destroyed",r)}this.then(i,i)};function a(e,t,n){var i=n.filter?n.filter.toString():"";return e.id().then(function(e){return t.id().then(function(t){var o=e+t+i+JSON.stringify(n.query_params)+n.doc_ids;return"_local/"+r.MD5(o)})})}function u(e,t,n){return e.get(t)["catch"](function(e){if(e.status===404){return{_id:t}}throw e}).then(function(t){t.last_seq=n;return e.put(t)})}function c(e,t,n){this.src=e;this.target=t;this.id=n}c.prototype.writeCheckpoint=function(e){var t=this;return this.updateTarget(e).then(function(){return t.updateSource(e)})};c.prototype.updateTarget=function(e){return u(this.target,this.id,e)};c.prototype.updateSource=function(e){var t=this;if(this.readOnlySource){return r.Promise.resolve(true)}return u(this.src,this.id,e)["catch"](function(e){if(e.status===401){t.readOnlySource=true;return true}throw e})};c.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.src.get(e.id).then(function(e){if(t.last_seq===e.last_seq){return e.last_seq}return 0},function(n){if(n.status===404&&t.last_seq){return e.src.put({_id:e.id,last_seq:0}).then(function(){return 0},function(n){if(n.status===401){e.readOnlySource=true;return t.last_seq}return 0})}throw n})})["catch"](function(e){if(e.status!==404){throw e}return 0})};function f(e,t,n,i,o){var s=[];var a;var u={seq:0,changes:[],docs:[]};var f=false;var l=false;var p=false;var h=0;var d=i.continuous||i.live||false;var v=i.batch_size||100;var m=i.batches_limit||10;var g=false;var y=0;var _=i.doc_ids;var b=new c(t,n,e);var w={ok:true,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var x={};o.ready(t,n);function k(){if(a.docs.length===0){return}var e=a.docs;return n.bulkDocs({docs:e},{new_edits:false}).then(function(e){if(o.cancelled){I();throw new Error("cancelled")}var t=[];e.forEach(function(e){if(!e.ok){w.doc_write_failures++;t.push(new Error(e.reason||e.message||"Unknown reason"))}});if(t.length>0){var n=new Error("bulkDocs error");n.other_errors=t;q("target.bulkDocs failed to write docs",n);throw new Error("bulkWrite partial failure")}},function(t){w.doc_write_failures+=e.length;throw t})}function E(){var e=a.diffs;var n=Object.keys(e)[0];var r=e[n].missing;return t.get(n,{revs:true,open_revs:r,attachments:true}).then(function(t){t.forEach(function(t){if(o.cancelled){return I()}if(t.ok){w.docs_read++;a.pendingRevs++;a.docs.push(t.ok);delete e[t.ok._id]}})})}function O(){if(Object.keys(a.diffs).length>0){return E().then(O)}else{return r.Promise.resolve()}}function j(){var e=Object.keys(a.diffs).filter(function(e){var t=a.diffs[e].missing;return t.length===1&&t[0].slice(0,2)==="1-"});return t.allDocs({keys:e,include_docs:true}).then(function(e){if(o.cancelled){I();throw new Error("cancelled")}e.rows.forEach(function(e,t){if(e.doc&&!e.deleted&&e.value.rev.slice(0,2)==="1-"&&(!e.doc._attachments||Object.keys(e.doc._attachments).length===0)){w.docs_read++;a.pendingRevs++;a.docs.push(e.doc);delete a.diffs[e.id]}})})}function S(){if(t.type()==="http"){return j().then(O)}else{return O()}}function A(){f=true;return b.writeCheckpoint(a.seq).then(function(e){f=false;if(o.cancelled){I();throw new Error("cancelled")}w.last_seq=h=a.seq;w.docs_written+=a.docs.length;o.emit("change",r.clone(w));a=undefined;D()})["catch"](function(e){f=false;q("writeCheckpoint completed with error",e);throw e})}function C(){var e={};a.changes.forEach(function(t){e[t.id]=t.changes.map(function(e){return e.rev})});return n.revsDiff(e).then(function(e){if(o.cancelled){I();throw new Error("cancelled")}a.diffs=e;a.pendingRevs=0})}function T(){if(o.cancelled||a){return}if(s.length===0){N(true);return}a=s.shift();C().then(S).then(k).then(A).then(T)["catch"](function(e){q("batch processing terminated with error",e)})}function N(e){if(u.changes.length===0){if(s.length===0&&!a){if(d&&x.live||l){o.emit("uptodate",r.clone(w))}if(l){I()}}return}if(e||l||u.changes.length>=v){s.push(u);u={seq:0,changes:[],docs:[]};T()}}function q(e,t){if(p){return}w.ok=false;w.status="aborted";t.message=e;w.errors.push(t);s=[];u={seq:0,changes:[],docs:[]};I()}function I(){if(p){return}if(o.cancelled){w.status="cancelled";if(f){return}}w.status=w.status||"complete";w.end_time=new Date;w.last_seq=h;p=o.cancelled=true;if(w.errors.length>0){var e=w.errors.pop();if(w.errors.length>0){e.other_errors=w.errors}e.result=w;o.emit("error",e)}else{o.emit("complete",w)}}function R(e){if(o.cancelled){return I()}y++;if(u.changes.length===0&&s.length===0&&!a){o.emit("outofdate",r.clone(w))}u.seq=e.seq;u.changes.push(e);N(s.length===0)}function B(e){g=false;if(o.cancelled){return I()}if(y>0){x.since=e.last_seq;D()}else{if(d){x.live=true;D()}else{l=true}}N(true)}function L(e){g=false;if(o.cancelled){return I()}q("changes rejected",e)}function D(){if(!g&&!l&&s.length<m){g=true;y=0;t.changes(x).on("change",R).then(B)["catch"](L)}}function F(){b.getCheckpoint().then(function(e){h=e;x={since:h,limit:v,style:"all_docs",doc_ids:_,returnDocs:false};if(i.filter){x.filter=i.filter}if(i.query_params){x.query_params=i.query_params}D()})["catch"](function(e){q("getCheckpoint rejected with ",e)})}o.once("cancel",I);if(typeof i.onChange==="function"){o.on("change",i.onChange)}if(typeof i.complete==="function"){o.once("error",i.complete);o.once("complete",function(e){i.complete(null,e)})}if(typeof i.since==="undefined"){F()}else{f=true;b.writeCheckpoint(i.since).then(function(e){f=false;if(o.cancelled){I();return}h=i.since;F()})["catch"](function(e){f=false;q("writeCheckpoint completed with error",e);throw e})}}function l(e){if(typeof e==="string"){return new i(e)}else if(e.then){return e}else{return r.Promise.resolve(e)}}function p(e,t,n,i){if(typeof n==="function"){i=n;n={}}if(typeof n==="undefined"){n={}}if(!n.complete){n.complete=i||function(){}}n=r.clone(n);n.continuous=n.continuous||n.live;var o=new s(n);l(e).then(function(e){return l(t).then(function(t){if(n.server){if(typeof e.replicateOnServer!=="function"){throw new TypeError("Server replication not supported for "+e.type()+" adapter")}if(e.type()!==t.type()){throw new TypeError("Server replication"+" for different adapter types ("+e.type()+" and "+t.type()+") is not supported")}e.replicateOnServer(t,n,o)}else{return a(e,t,n).then(function(r){o.emit("id",r);f(r,e,t,n,o)})}})})["catch"](function(e){o.emit("error",e);n.complete(e)});return o}n.replicate=p},{"./index":397,"./utils":403,events:60}],400:[function(e,t,n){(function(n){"use strict";var r=e("./constructor");var i=e("./utils");var o=i.Promise;var s=e("events").EventEmitter;r.adapters={};r.preferredAdapters=e("./adapters/preferredAdapters.js");r.prefix="_pouch_";var a=new s;var u=["on","addListener","emit","listeners","once","removeAllListeners","removeListener","setMaxListeners"];u.forEach(function(e){r[e]=a[e].bind(a)});r.setMaxListeners(0);r.parseAdapter=function(e,t){var o=e.match(/([a-z\-]*):\/\/(.*)/);var s,a;if(o){e=/http(s?)/.test(o[1])?o[1]+"://"+o[2]:o[2];s=o[1];if(!r.adapters[s].valid()){throw"Invalid adapter"}return{name:e,adapter:o[1]}}var u="idb"in r.adapters&&"websql"in r.adapters&&i.hasLocalStorage()&&n.localStorage["_pouch__websqldb_"+r.prefix+e];if(typeof t!=="undefined"&&t.db){a="leveldb"}else{for(var c=0;c<r.preferredAdapters.length;++c){a=r.preferredAdapters[c];if(a in r.adapters){if(u&&a==="idb"){continue}break}}}s=r.adapters[a];if(a&&s){var f="use_prefix"in s?s.use_prefix:true;return{name:f?r.prefix+e:e,adapter:a}}throw"No valid adapter found"};r.destroy=i.toPromise(function(e,t,n){if(typeof t==="function"||typeof t==="undefined"){n=t;t={}}if(typeof e==="object"){t=e;e=undefined}var i=r.parseAdapter(t.name||e,t);var s=i.name;var a=r.adapters[i.adapter];function u(){a.destroy(s,t,function(e,t){if(e){n(e)}else{r.emit("destroyed",s);r.emit(s,"destroyed");n(null,t||{ok:true})}})}var c="use_prefix"in a?a.use_prefix:true;var f=c?s.replace(new RegExp("^"+r.prefix),""):s;new r(f,{adapter:i.adapter},function(e,t){if(e){return n(e)}t.get("_local/_pouch_dependentDbs",function(e,t){if(e){if(e.name!=="not_found"){return n(e)}else{return u()}}var s=t.dependentDbs;var a=Object.keys(s).map(function(e){var t=c?e.replace(new RegExp("^"+r.prefix),""):e;return r.destroy(t,{adapter:i.adapter})});o.all(a).then(u,function(e){n(e)})})})});r.allDbs=i.toPromise(function(e){var t=new Error("allDbs method removed");t.stats="400";e(t)});r.adapter=function(e,t){if(t.valid()){r.adapters[e]=t}};r.plugin=function(e){Object.keys(e).forEach(function(t){r.prototype[t]=e[t]})};t.exports=r}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./adapters/preferredAdapters.js":386,"./constructor":389,"./utils":403,events:60}],401:[function(e,t,n){"use strict";var r=e("./utils");var i=e("./replicate").replicate;var o=e("events").EventEmitter;t.exports=s;r.inherits(s,o);function s(e,t,n,o){if(!(this instanceof s)){return new s(e,t,n,o)}var a=this;if(typeof n==="function"){o=n;n={}}if(typeof n==="undefined"){n={}}this.canceled=false;n=r.clone(n);var u,c;if("onChange"in n){u=n.onChange;delete n.onChange}if(typeof o==="function"&&!n.complete){c=o}else if("complete"in n){c=n.complete;delete n.complete}this.push=i(e,t,n);this.pull=i(t,e,n);var f=false;function l(e){if(!f){f=true;a.emit("cancel",e)}}function p(e){a.emit("change",{direction:"pull",change:e})}function h(e){a.emit("change",{direction:"push",change:e})}var d={};function v(e,t){if(e==="change"&&(t===p||t===h)){a.removeAllListeners("change")}else if(e==="cancel"&&t===l){a.removeAllListeners("cancel")}else if(e in d&&t===d[e]){a.removeAllListeners(e)}}this.on("newListener",function(e){if(e==="change"){a.pull.on("change",p);a.push.on("change",h)}else if(e==="cancel"){a.pull.on("cancel",l);a.push.on("cancel",l)}else if(e!=="error"&&e!=="complete"&&!(e in d)){d[e]=function(t){a.emit(e,t)};a.pull.on(e,d[e]);a.push.on(e,d[e])}});this.on("removeListener",function(e){if(e==="change"){a.pull.removeListener("change",p);
a.push.removeListener("change",h)}else if(e==="cancel"){a.pull.removeListener("cancel",l);a.push.removeListener("cancel",l)}else if(e in d){if(typeof d[e]==="function"){a.pull.removeListener(e,d[e]);a.push.removeListener(e,d[e]);delete d[e]}}});this.pull.on("removeListener",v);this.push.on("removeListener",v);var m=r.Promise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};a.emit("complete",t);if(c){c(null,t)}a.removeAllListeners();return t},function(e){a.cancel();a.emit("error",e);if(c){c(e)}a.removeAllListeners();throw e});this.then=function(e,t){return m.then(e,t)};this["catch"]=function(e){return m["catch"](e)}}s.prototype.cancel=function(){if(!this.canceled){this.canceled=true;this.push.cancel();this.pull.cancel()}}},{"./replicate":399,"./utils":403,events:60}],402:[function(e,t,n){"use strict";t.exports=r;function r(){this.isReady=false;this.failed=false;this.queue=[]}r.prototype.execute=function(){var e,t;if(this.failed){while(e=this.queue.shift()){if(typeof e==="function"){e(this.failed);continue}t=e.parameters[e.parameters.length-1];if(typeof t==="function"){t(this.failed)}else if(e.name==="changes"&&typeof t.complete==="function"){t.complete(this.failed)}}}else if(this.isReady){while(e=this.queue.shift()){if(typeof e==="function"){e()}else{e.task=this.db[e.name].apply(this.db,e.parameters)}}}};r.prototype.fail=function(e){this.failed=e;this.execute()};r.prototype.ready=function(e){if(this.failed){return false}else if(arguments.length===0){return this.isReady}this.isReady=e?true:false;this.db=e;this.execute()};r.prototype.addTask=function(e,t){if(typeof e==="function"){this.queue.push(e);if(this.failed){this.execute()}}else{var n={name:e,parameters:t};this.queue.push(n);if(this.failed){this.execute()}return n}}},{}],403:[function(e,t,n){(function(t,r){var i=e("crypto");var o=e("md5-jkmyers");var s=e("./merge");n.extend=e("pouchdb-extend");n.ajax=e("./deps/ajax");n.createBlob=e("./deps/blob");n.uuid=e("./deps/uuid");n.getArguments=e("argsarray");var a=e("./deps/buffer");var u=e("./deps/errors");var c=e("events").EventEmitter;if(typeof r.Promise==="function"){n.Promise=r.Promise}else{n.Promise=e("bluebird")}var f=n.Promise;function l(e){var t={};e.forEach(function(e){t[e]=true});return t}var p=l(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree"]);n.clone=function(e){return n.extend(true,{},e)};n.inherits=e("inherits");n.invalidIdError=function(e){if(!e){return u.MISSING_ID}else if(typeof e!=="string"){return u.INVALID_ID}else if(/^_/.test(e)&&!/^_(design|local)/.test(e)){return u.RESERVED_ID}};function h(){return typeof chrome!=="undefined"&&typeof chrome.storage!=="undefined"&&typeof chrome.storage.local!=="undefined"}n.call=n.getArguments(function(e){if(!e.length){return}var t=e.shift();if(typeof t==="function"){t.apply(this,e)}});n.isLocalId=function(e){return/^_local/.test(e)};n.isDeleted=function(e,t){if(!t){t=s.winningRev(e)}var n=t.indexOf("-");if(n!==-1){t=t.substring(n+1)}var r=false;s.traverseRevTree(e.rev_tree,function(e,n,i,o,s){if(i===t){r=!!s.deleted}});return r};n.filterChange=function(e){return function(t){var n={};var r=e.filter&&typeof e.filter==="function";n.query=e.query_params;if(e.filter&&r&&!e.filter.call(this,t.doc,n)){return false}if(e.doc_ids&&e.doc_ids.indexOf(t.id)===-1){return false}if(!e.include_docs){delete t.doc}else{for(var i in t.doc._attachments){if(t.doc._attachments.hasOwnProperty(i)){t.doc._attachments[i].stub=true}}}return true}};n.parseDoc=function(e,t){var r;var i;var o;var s={status:"available"};if(e._deleted){s.deleted=true}if(t){if(!e._id){e._id=n.uuid()}i=n.uuid(32,16).toLowerCase();if(e._rev){o=/^(\d+)-(.+)$/.exec(e._rev);if(!o){throw"invalid value for property '_rev'"}e._rev_tree=[{pos:parseInt(o[1],10),ids:[o[2],{status:"missing"},[[i,s,[]]]]}];r=parseInt(o[1],10)+1}else{e._rev_tree=[{pos:1,ids:[i,s,[]]}];r=1}}else{if(e._revisions){e._rev_tree=[{pos:e._revisions.start-e._revisions.ids.length+1,ids:e._revisions.ids.reduce(function(e,t){if(e===null){return[t,s,[]]}else{return[t,{status:"missing"},[e]]}},null)}];r=e._revisions.start;i=e._revisions.ids[0]}if(!e._rev_tree){o=/^(\d+)-(.+)$/.exec(e._rev);if(!o){return u.BAD_ARG}r=parseInt(o[1],10);i=o[2];e._rev_tree=[{pos:parseInt(o[1],10),ids:[o[2],s,[]]}]}}var a=n.invalidIdError(e._id);if(a){return a}e._id=decodeURIComponent(e._id);e._rev=[r,i].join("-");var c={metadata:{},data:{}};for(var f in e){if(e.hasOwnProperty(f)){var l=f[0]==="_";if(l&&!p[f]){a=u.error(u.DOC_VALIDATION);a.reason+=": "+f;return a}else if(l&&f!=="_attachments"){c.metadata[f.slice(1)]=e[f]}else{c.data[f]=e[f]}}}return c};n.isCordova=function(){return typeof cordova!=="undefined"||typeof PhoneGap!=="undefined"||typeof phonegap!=="undefined"};n.hasLocalStorage=function(){if(h()){return false}try{return r.localStorage}catch(e){return false}};n.Changes=d;n.inherits(d,c);function d(){if(!(this instanceof d)){return new d}var e=this;c.call(this);this.isChrome=h();this.listeners={};this.hasLocal=false;if(!this.isChrome){this.hasLocal=n.hasLocalStorage()}if(this.isChrome){chrome.storage.onChanged.addListener(function(t){if(t.db_name!=null){e.emit(t.dbName.newValue)}})}else if(this.hasLocal){if(r.addEventListener){r.addEventListener("storage",function(t){e.emit(t.key)})}else{r.attachEvent("storage",function(t){e.emit(t.key)})}}}d.prototype.addListener=function(e,t,r,i){if(this.listeners[t]){return}function o(){r.changes({include_docs:i.include_docs,conflicts:i.conflicts,continuous:false,descending:false,filter:i.filter,view:i.view,since:i.since,query_params:i.query_params,onChange:function(e){if(e.seq>i.since&&!i.cancelled){i.since=e.seq;n.call(i.onChange,e)}}})}this.listeners[t]=o;this.on(e,o)};d.prototype.removeListener=function(e,t){if(!(t in this.listeners)){return}c.prototype.removeListener.call(this,e,this.listeners[t])};d.prototype.notifyLocalWindows=function(e){if(this.isChrome){chrome.storage.local.set({dbName:e})}else if(this.hasLocal){localStorage[e]=localStorage[e]==="a"?"b":"a"}};d.prototype.notify=function(e){this.emit(e);this.notifyLocalWindows(e)};if(!t.browser||!("atob"in r)){n.atob=function(e){var t=new a(e,"base64");if(t.toString("base64")!==e){throw"Cannot base64 encode full string"}return t.toString("binary")}}else{n.atob=function(e){return atob(e)}}if(!t.browser||!("btoa"in r)){n.btoa=function(e){return new a(e,"binary").toString("base64")}}else{n.btoa=function(e){return btoa(e)}}n.fixBinary=function(e){if(!t.browser){return e}var n=e.length;var r=new ArrayBuffer(n);var i=new Uint8Array(r);for(var o=0;o<n;o++){i[o]=e.charCodeAt(o)}return r};n.once=function(e){var t=false;return n.getArguments(function(n){if(t){if(typeof console.trace==="function"){console.trace()}throw new Error("once called  more than once")}else{t=true;e.apply(this,n)}})};n.toPromise=function(e){return n.getArguments(function(r){var i=this;var o=typeof r[r.length-1]==="function"?r.pop():false;var s;if(o){s=function(e,n){t.nextTick(function(){o(e,n)})}}var a=new f(function(t,o){var s;try{var a=n.once(function(e,n){if(e){o(e)}else{t(n)}});r.push(a);s=e.apply(i,r);if(s&&typeof s.then==="function"){t(s)}}catch(u){o(u)}});if(s){a.then(function(e){s(null,e)},s)}a.cancel=function(){return this};return a})};n.adapterFun=function(e,t){return n.toPromise(n.getArguments(function(r){if(this._closed){return f.reject(new Error("database is closed"))}var i=this;if(!this.taskqueue.isReady){return new n.Promise(function(t,n){i.taskqueue.addTask(function(o){if(o){n(o)}else{t(i[e].apply(i,r))}})})}return t.apply(this,r)}))};n.arrayBufferToBinaryString=function(e){var t="";var n=new Uint8Array(e);var r=n.byteLength;for(var i=0;i<r;i++){t+=String.fromCharCode(n[i])}return t};n.cancellableFun=function(e,t,r){r=r?n.clone(true,{},r):{};var i=new c;var o=r.complete||function(){};var s=r.complete=n.once(function(e,t){if(e){o(e)}else{i.emit("end",t);o(null,t)}i.removeAllListeners()});var a=r.onChange||function(){};var u=0;t.on("destroyed",function(){i.removeAllListeners()});r.onChange=function(e){a(e);if(e.seq<=u){return}u=e.seq;i.emit("change",e);if(e.deleted){i.emit("delete",e)}else if(e.changes.length===1&&e.changes[0].rev.slice(0,1)==="1-"){i.emit("create",e)}else{i.emit("update",e)}};var l=new f(function(e,t){r.complete=function(n,r){if(n){t(n)}else{e(r)}}});l.then(function(e){s(null,e)},s);l.cancel=function(){l.isCancelled=true;if(t.taskqueue.isReady){r.complete(null,{status:"cancelled"})}};if(!t.taskqueue.isReady){t.taskqueue.addTask(function(){if(l.isCancelled){r.complete(null,{status:"cancelled"})}else{e(t,r,l)}})}else{e(t,r,l)}l.on=i.on.bind(i);l.once=i.once.bind(i);l.addListener=i.addListener.bind(i);l.removeListener=i.removeListener.bind(i);l.removeAllListeners=i.removeAllListeners.bind(i);l.setMaxListeners=i.setMaxListeners.bind(i);l.listeners=i.listeners.bind(i);l.emit=i.emit.bind(i);return l};n.Crypto={};n.MD5=n.Crypto.MD5=function(e){if(!t.browser){return i.createHash("md5").update(e).digest("hex")}else{return o(e)}}}).call(this,e("OpdoqP"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./deps/ajax":390,"./deps/blob":391,"./deps/buffer":59,"./deps/errors":392,"./deps/uuid":394,"./merge":398,OpdoqP:61,argsarray:405,bluebird:410,crypto:59,events:60,inherits:406,"md5-jkmyers":424,"pouchdb-extend":425}],404:[function(e,t,n){t.exports="2.2.3"},{}],405:[function(e,t,n){"use strict";t.exports=r;function r(e){return function(){var t=arguments.length;if(t){var n=[];var r=-1;while(++r<t){n[r]=arguments[r]}return e.call(this,n)}else{return e.call(this,[])}}}},{}],406:[function(e,t,n){if(typeof Object.create==="function"){t.exports=function r(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e}}},{}],407:[function(e,t,n){"use strict";t.exports=r;function r(){}},{}],408:[function(e,t,n){"use strict";var r=e("./promise");var i=e("./reject");var o=e("./resolve");var s=e("./INTERNAL");var a=e("./handlers");var u=i(new TypeError("must be an array"));t.exports=function c(e){if(Object.prototype.toString.call(e)!=="[object Array]"){return u}var t=e.length;if(!t){return o([])}var n=new Array(t);var i=0;var c=-1;var f=new r(s);while(++c<t){l(e[c],c)}return f;function l(e,r){o(e).then(s,function(e){a.reject(f,e)});function s(e){n[r]=e;if(++i===t){a.resolve(f,n)}}}}},{"./INTERNAL":407,"./handlers":409,"./promise":411,"./reject":413,"./resolve":414}],409:[function(e,t,n){"use strict";var r=e("./tryCatch");var i=e("./resolveThenable");var o=e("./states");n.resolve=function(e,t){var a=r(s,t);if(a.status==="error"){return n.reject(e,a.value)}var u=a.value;if(u){i.safely(e,u)}else{e.state=o.FULFILLED;e.outcome=t;var c=-1;var f=e.queue.length;while(++c<f){e.queue[c].callFulfilled(t)}}return e};n.reject=function(e,t){e.state=o.REJECTED;e.outcome=t;var n=-1;var r=e.queue.length;while(++n<r){e.queue[n].callRejected(t)}return e};function s(e){var t=e&&e.then;if(e&&typeof e==="object"&&typeof t==="function"){return function n(){t.apply(e,arguments)}}}},{"./resolveThenable":415,"./states":416,"./tryCatch":417}],410:[function(e,t,n){t.exports=n=e("./promise");n.resolve=e("./resolve");n.reject=e("./reject");n.all=e("./all")},{"./all":408,"./promise":411,"./reject":413,"./resolve":414}],411:[function(e,t,n){"use strict";var r=e("./unwrap");var i=e("./INTERNAL");var o=e("./resolveThenable");var s=e("./states");var a=e("./queueItem");t.exports=u;function u(e){if(!(this instanceof u)){return new u(e)}if(typeof e!=="function"){throw new TypeError("reslover must be a function")}this.state=s.PENDING;this.queue=[];this.outcome=void 0;if(e!==i){o.safely(this,e)}}u.prototype["catch"]=function(e){return this.then(null,e)};u.prototype.then=function(e,t){if(typeof e!=="function"&&this.state===s.FULFILLED||typeof t!=="function"&&this.state===s.REJECTED){return this}var n=new u(i);if(this.state!==s.PENDING){var o=this.state===s.FULFILLED?e:t;r(n,o,this.outcome)}else{this.queue.push(new a(n,e,t))}return n}},{"./INTERNAL":407,"./queueItem":412,"./resolveThenable":415,"./states":416,"./unwrap":418}],412:[function(e,t,n){"use strict";var r=e("./handlers");var i=e("./unwrap");t.exports=o;function o(e,t,n){this.promise=e;if(typeof t==="function"){this.onFulfilled=t;this.callFulfilled=this.otherCallFulfilled}if(typeof n==="function"){this.onRejected=n;this.callRejected=this.otherCallRejected}}o.prototype.callFulfilled=function(e){r.resolve(this.promise,e)};o.prototype.otherCallFulfilled=function(e){i(this.promise,this.onFulfilled,e)};o.prototype.callRejected=function(e){r.reject(this.promise,e)};o.prototype.otherCallRejected=function(e){i(this.promise,this.onRejected,e)}},{"./handlers":409,"./unwrap":418}],413:[function(e,t,n){"use strict";var r=e("./promise");var i=e("./INTERNAL");var o=e("./handlers");t.exports=s;function s(e){var t=new r(i);return o.reject(t,e)}},{"./INTERNAL":407,"./handlers":409,"./promise":411}],414:[function(e,t,n){"use strict";var r=e("./promise");var i=e("./INTERNAL");var o=e("./handlers");t.exports=l;var s=o.resolve(new r(i),false);var a=o.resolve(new r(i),null);var u=o.resolve(new r(i),void 0);var c=o.resolve(new r(i),0);var f=o.resolve(new r(i),"");function l(e){if(e){if(e instanceof r){return e}return o.resolve(new r(i),e)}var t=typeof e;switch(t){case"boolean":return s;case"undefined":return u;case"object":return a;case"number":return c;case"string":return f}}},{"./INTERNAL":407,"./handlers":409,"./promise":411}],415:[function(e,t,n){"use strict";var r=e("./handlers");var i=e("./tryCatch");function o(e,t){var n=false;function o(t){if(n){return}n=true;r.reject(e,t)}function s(t){if(n){return}n=true;r.resolve(e,t)}function a(){t(s,o)}var u=i(a);if(u.status==="error"){o(u.value)}}n.safely=o},{"./handlers":409,"./tryCatch":417}],416:[function(e,t,n){n.REJECTED=["REJECTED"];n.FULFILLED=["FULFILLED"];n.PENDING=["PENDING"]},{}],417:[function(e,t,n){"use strict";t.exports=r;function r(e,t){var n={};try{n.value=e(t);n.status="success"}catch(r){n.status="error";n.value=r}return n}},{}],418:[function(e,t,n){"use strict";var r=e("immediate");var i=e("./handlers");t.exports=o;function o(e,t,n){r(function(){var r;try{r=t(n)}catch(o){return i.reject(e,o)}if(r===e){i.reject(e,new TypeError("Cannot resolve promise with itself"))}else{i.resolve(e,r)}})}},{"./handlers":409,immediate:419}],419:[function(e,t,n){"use strict";var r=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")];var i;var o=[];function s(){i=true;var e,t;var n=o.length;while(n){t=o;o=[];e=-1;while(++e<n){t[e]()}n=o.length}i=false}var a;var u=-1;var c=r.length;while(++u<c){if(r[u]&&r[u].test&&r[u].test()){a=r[u].install(s);break}}t.exports=f;function f(e){if(o.push(e)===1&&!i){a()}}},{"./messageChannel":420,"./mutation.js":421,"./nextTick":59,"./stateChange":422,"./timeout":423}],420:[function(e,t,n){(function(e){"use strict";n.test=function(){if(e.setImmediate){return false}return typeof e.MessageChannel!=="undefined"};n.install=function(t){var n=new e.MessageChannel;n.port1.onmessage=t;return function(){n.port2.postMessage(0)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],421:[function(e,t,n){(function(e){"use strict";var t=e.MutationObserver||e.WebKitMutationObserver;n.test=function(){return t};n.install=function(n){var r=0;var i=new t(n);var o=e.document.createTextNode("");i.observe(o,{characterData:true});return function(){o.data=r=++r%2}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],422:[function(e,t,n){(function(e){"use strict";n.test=function(){return"document"in e&&"onreadystatechange"in e.document.createElement("script")};n.install=function(t){return function(){var n=e.document.createElement("script");n.onreadystatechange=function(){t();n.onreadystatechange=null;n.parentNode.removeChild(n);n=null};e.document.documentElement.appendChild(n);return t}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],423:[function(e,t,n){"use strict";n.test=function(){return true};n.install=function(e){return function(){setTimeout(e,0)}}},{}],424:[function(e,t,n){!function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof n?t.exports=r():e.md5=r()}(this,function(){function e(e,t){var s=e[0],a=e[1],u=e[2],c=e[3];s=n(s,a,u,c,t[0],7,-680876936),c=n(c,s,a,u,t[1],12,-389564586),u=n(u,c,s,a,t[2],17,606105819),a=n(a,u,c,s,t[3],22,-1044525330),s=n(s,a,u,c,t[4],7,-176418897),c=n(c,s,a,u,t[5],12,1200080426),u=n(u,c,s,a,t[6],17,-1473231341),a=n(a,u,c,s,t[7],22,-45705983),s=n(s,a,u,c,t[8],7,1770035416),c=n(c,s,a,u,t[9],12,-1958414417),u=n(u,c,s,a,t[10],17,-42063),a=n(a,u,c,s,t[11],22,-1990404162),s=n(s,a,u,c,t[12],7,1804603682),c=n(c,s,a,u,t[13],12,-40341101),u=n(u,c,s,a,t[14],17,-1502002290),a=n(a,u,c,s,t[15],22,1236535329),s=r(s,a,u,c,t[1],5,-165796510),c=r(c,s,a,u,t[6],9,-1069501632),u=r(u,c,s,a,t[11],14,643717713),a=r(a,u,c,s,t[0],20,-373897302),s=r(s,a,u,c,t[5],5,-701558691),c=r(c,s,a,u,t[10],9,38016083),u=r(u,c,s,a,t[15],14,-660478335),a=r(a,u,c,s,t[4],20,-405537848),s=r(s,a,u,c,t[9],5,568446438),c=r(c,s,a,u,t[14],9,-1019803690),u=r(u,c,s,a,t[3],14,-187363961),a=r(a,u,c,s,t[8],20,1163531501),s=r(s,a,u,c,t[13],5,-1444681467),c=r(c,s,a,u,t[2],9,-51403784),u=r(u,c,s,a,t[7],14,1735328473),a=r(a,u,c,s,t[12],20,-1926607734),s=i(s,a,u,c,t[5],4,-378558),c=i(c,s,a,u,t[8],11,-2022574463),u=i(u,c,s,a,t[11],16,1839030562),a=i(a,u,c,s,t[14],23,-35309556),s=i(s,a,u,c,t[1],4,-1530992060),c=i(c,s,a,u,t[4],11,1272893353),u=i(u,c,s,a,t[7],16,-155497632),a=i(a,u,c,s,t[10],23,-1094730640),s=i(s,a,u,c,t[13],4,681279174),c=i(c,s,a,u,t[0],11,-358537222),u=i(u,c,s,a,t[3],16,-722521979),a=i(a,u,c,s,t[6],23,76029189),s=i(s,a,u,c,t[9],4,-640364487),c=i(c,s,a,u,t[12],11,-421815835),u=i(u,c,s,a,t[15],16,530742520),a=i(a,u,c,s,t[2],23,-995338651),s=o(s,a,u,c,t[0],6,-198630844),c=o(c,s,a,u,t[7],10,1126891415),u=o(u,c,s,a,t[14],15,-1416354905),a=o(a,u,c,s,t[5],21,-57434055),s=o(s,a,u,c,t[12],6,1700485571),c=o(c,s,a,u,t[3],10,-1894986606),u=o(u,c,s,a,t[10],15,-1051523),a=o(a,u,c,s,t[1],21,-2054922799),s=o(s,a,u,c,t[8],6,1873313359),c=o(c,s,a,u,t[15],10,-30611744),u=o(u,c,s,a,t[6],15,-1560198380),a=o(a,u,c,s,t[13],21,1309151649),s=o(s,a,u,c,t[4],6,-145523070),c=o(c,s,a,u,t[11],10,-1120210379),u=o(u,c,s,a,t[2],15,718787259),a=o(a,u,c,s,t[9],21,-343485551),e[0]=l(s,e[0]),e[1]=l(a,e[1]),e[2]=l(u,e[2]),e[3]=l(c,e[3])}function t(e,t,n,r,i,o){return t=l(l(t,e),l(r,o)),l(t<<i|t>>>32-i,n)}function n(e,n,r,i,o,s,a){return t(n&r|~n&i,e,n,o,s,a)}function r(e,n,r,i,o,s,a){return t(n&i|r&~i,e,n,o,s,a)}function i(e,n,r,i,o,s,a){return t(n^r^i,e,n,o,s,a)}function o(e,n,r,i,o,s,a){return t(r^(n|~i),e,n,o,s,a)}function s(t){txt="";var n,r=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=t.length;n+=64)e(i,a(t.substring(n-64,n)));t=t.substring(n-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)o[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(e(i,o),n=0;16>n;n++)o[n]=0;return o[14]=8*r,e(i,o),i}function a(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function u(e){for(var t="",n=0;4>n;n++)t+=p[e>>8*n+4&15]+p[e>>8*n&15];return t}function c(e){for(var t=0;t<e.length;t++)e[t]=u(e[t]);return e.join("")}function f(e){return c(s(e))}function l(e,t){return e+t&4294967295}function l(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}var p="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=f("hello"),f})},{}],425:[function(e,t,n){"use strict";var r={};var i=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(var o=0;o<i.length;o++){var s=i[o];r["[object "+s+"]"]=s.toLowerCase()}var a=r.toString;var u=r.hasOwnProperty;function c(e){if(e===null){return String(e)}return typeof e==="object"||typeof e==="function"?r[a.call(e)]||"object":typeof e}function f(e){return e!==null&&e===e.window}function l(e){if(!e||c(e)!=="object"||e.nodeType||f(e)){return false}try{if(e.constructor&&!u.call(e,"constructor")&&!u.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(t){return false}var n;for(n in e){}return n===undefined||u.call(e,n)}function p(e){return c(e)==="function"}var h=Array.isArray||function(e){return c(e)==="array"};function d(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,c=false;if(typeof s==="boolean"){c=s;s=arguments[1]||{};a=2}if(typeof s!=="object"&&!p(s)){s={}}if(u===a){s=this;--a}for(;a<u;a++){if((e=arguments[a])!=null){for(t in e){if(!(t in Object.prototype)){n=s[t];r=e[t];if(s===r){continue}if(c&&r&&(l(r)||(i=h(r)))){if(i){i=false;o=n&&h(n)?n:[]}else{o=n&&l(n)?n:{}}s[t]=d(c,o,r)}else if(r!==undefined){if(!(h(e)&&p(r))){s[t]=r}}}}}}return s}t.exports=d},{}],426:[function(e,t,n){"use strict";var r=e("./upsert");var i=e("./utils");var o=i.Promise;t.exports=function(e){var t=e.db;var n=e.viewName;var s=e.map;var a=e.reduce;var u=e.temporary;var c=s.toString()+(a&&a.toString())+"undefined";if(!u&&t._cachedViews){var f=t._cachedViews[c];if(f){return o.resolve(f)}}return t.info().then(function(e){var o=e.db_name+"-mrview-"+(u?"temp":i.MD5(c));function f(e){e.views=e.views||{};var t=n;if(t.indexOf("/")===-1){t=n+"/"+n}var r=e.views[t]=e.views[t]||{};if(r[o]){return}r[o]=true;return e}return r(t,"_local/mrviews",f).then(function(){return t.registerDependentDatabase(o).then(function(e){var n=e.db;n.auto_compaction=true;var r={name:o,db:n,sourceDB:t,adapter:t.adapter,mapFun:s,reduceFun:a};return r.db.get("_local/lastSeq")["catch"](function(e){if(e.name!=="not_found"){throw e}}).then(function(e){r.seq=e?e.seq:0;if(!u){t._cachedViews=t._cachedViews||{};t._cachedViews[c]=r;r.db.on("destroyed",function(){delete t._cachedViews[c]})}return r})})})})}},{"./upsert":433,"./utils":434}],427:[function(require,module,exports){"use strict";module.exports=function(func,emit,sum,log,isArray,toJSON){return eval("'use strict'; ("+func+");")}},{}],428:[function(e,t,n){"use strict";var r=e("pouchdb-collate");var i=e("./taskqueue");var o=r.collate;var s=r.toIndexableString;var a=r.normalizeKey;var u=e("./create-view");var c=e("./evalfunc");var f;if(typeof console!=="undefined"&&typeof console.log==="function"){f=Function.prototype.bind.call(console.log,console)}else{f=function(){}}var l=e("./utils");var p=l.Promise;var h=new i;var d=new i;var v=50;function m(e){return e.indexOf("/")===-1?[e,e]:e.split("/")}function g(e,t,n){try{return{output:t.apply(null,n)}}catch(r){e.emit("error",r);return{error:r}}}function y(e,t){var n=o(e.key,t.key);return n!==0?n:o(e.value,t.value)}function _(e,t,n){n=n||0;if(typeof t==="number"){return e.slice(n,t+n)}else if(n>0){return e.slice(n)}return e}function b(e){var t=new Error("builtin "+e+" function requires map values to be numbers"+" or number arrays");t.name="invalid_value";t.status=500;return t}function w(e){var t=0;for(var n=0,r=e.length;n<r;n++){var i=e[n];if(typeof i!=="number"){if(Array.isArray(i)){t=typeof t==="number"?[t]:t;for(var o=0,s=i.length;o<s;o++){var a=i[o];if(typeof a!=="number"){throw b("_sum")}else if(typeof t[o]==="undefined"){t.push(a)}else{t[o]+=a}}}else{throw b("_sum")}}else if(typeof t==="number"){t+=i}else{t[0]+=i}}return t}var x={_sum:function(e,t){return w(t)},_count:function(e,t){return t.length},_stats:function(e,t){function n(e){var t=0;for(var n=0,r=e.length;n<r;n++){var i=e[n];t+=i*i}return t}return{sum:w(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:n(t)}}};function k(e,t,n,r){var i=t[e];if(typeof i!=="undefined"){if(r){i=encodeURIComponent(JSON.stringify(i))}n.push(e+"="+i)}}function E(e,t){var n=e.descending?"endkey":"startkey";var r=e.descending?"startkey":"endkey";if(typeof e[n]!=="undefined"&&typeof e[r]!=="undefined"&&o(e[n],e[r])>0){throw new B("No rows can match your key range, reverse your "+"start_key and end_key or set {descending : true}")}else if(t.reduce&&e.reduce!==false){if(e.include_docs){throw new B("{include_docs:true} is invalid for reduce")}else if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level){throw new B("Multi-key fetches for reduce views must use {group: true}")}}if(e.group_level){if(typeof e.group_level!=="number"){throw new B('Invalid value for integer: "'+e.group_level+'"')}if(e.group_level<0){throw new B("Invalid value for positive integer: "+'"'+e.group_level+'"')}}}function O(e,t,n){var r=[];var i;var o="GET";k("reduce",n,r);k("include_docs",n,r);k("limit",n,r);k("descending",n,r);k("group",n,r);k("group_level",n,r);k("skip",n,r);k("startkey",n,r,true);k("endkey",n,r,true);k("inclusive_end",n,r);k("key",n,r,true);r=r.join("&");r=r===""?"":"?"+r;if(typeof n.keys!=="undefined"){var s=2e3;var a="keys="+encodeURIComponent(JSON.stringify(n.keys));if(a.length+r.length+1<=s){r+=(r[0]==="?"?"&":"?")+a}else{o="POST";if(typeof t==="string"){i=JSON.stringify({keys:n.keys})}else{t.keys=n.keys}}}if(typeof t==="string"){var u=m(t);return e.request({method:o,url:"_design/"+u[0]+"/_view/"+u[1]+r,body:i})}i=i||{};Object.keys(t).forEach(function(e){if(Array.isArray(t[e])){i[e]=t[e]}else{i[e]=t[e].toString()}});return e.request({method:"POST",url:"_temp_view"+r,body:i})}function j(e){return function(t){if(t.name==="not_found"){return e}else{throw t}}}function S(e,t,n){var r="_local/doc_"+e;return t.db.get(r)["catch"](j({_id:r,keys:[]})).then(function(r){return t.db.allDocs({keys:r.keys,include_docs:true}).then(function(t){var i=t.rows.map(function(e){return e.doc}).filter(function(e){return e});var o=n[e];var s={};i.forEach(function(e){s[e._id]=true;e._deleted=!o[e._id];if(!e._deleted){e.value=o[e._id]}});var a=Object.keys(o);a.forEach(function(e){if(!s[e]){i.push({_id:e,value:o[e]})}});r.keys=l.uniq(a.concat(r.keys));i.splice(0,0,r);return i})})}function A(e,t,n){var r="_local/lastSeq";return e.db.get(r)["catch"](j({_id:r,seq:0})).then(function(r){var i=Object.keys(t);return p.all(i.map(function(n){return S(n,e,t)})).then(function(t){var i=[];t.forEach(function(e){i=i.concat(e)});r.seq=n;i.push(r);return e.db.bulkDocs({docs:i})})})}var C=l.sequentialize(h,function(e){var t;var n;function r(e,r){t.push({id:n._id,key:a(e),value:a(r)})}var o;if(typeof e.mapFun==="function"&&e.mapFun.length===2){var u=e.mapFun;o=function(e){return u(e,r)}}else{o=c(e.mapFun.toString(),r,w,f,Array.isArray,JSON.parse)}var l=e.seq||0;function h(t,n){return function(){return A(e,t,n)}}var d=new i;return new p(function(r,i){function a(){d.finish().then(function(){e.seq=l;r()})}function u(){e.sourceDB.changes({conflicts:true,include_docs:true,since:l,limit:v}).on("complete",function(r){var i=r.results;if(!i.length){return a()}var c={};for(var f=0,p=i.length;f<p;f++){var m=i[f];if(m.doc._id[0]!=="_"){t=[];n=m.doc;if(!n._deleted){g(e.sourceDB,o,[n])}t.sort(y);var _={};for(var b=0,w=t.length;b<w;b++){var x=t[b];var k=s([x.key,x.id,b]);_[k]=x}c[m.doc._id]=_}l=m.seq}d.add(h(c,l));if(i.length<v){return a()}return u()}).on("error",r);function r(e){i(e)}}u()})});function T(e,t,n){if(n.group_level===0){delete n.group_level}var r=n.group||n.group_level;var i;if(x[e.reduceFun]){i=x[e.reduceFun]}else{i=c(e.reduceFun.toString(),null,w,f,Array.isArray,JSON.parse)}var s=[];var a=n.group_level;t.forEach(function(e){var t=s[s.length-1];var n=r?e.key:null;if(r&&Array.isArray(n)&&typeof a==="number"){n=n.length>a?n.slice(0,a):n}if(t&&o(t.key[0][0],n)===0){t.key.push([n,e.id]);t.value.push(e.value);return}s.push({key:[[n,e.id]],value:[e.value]})});for(var u=0,l=s.length;u<l;u++){var p=s[u];var h=g(e.sourceDB,i,[p.key,p.value,false]);p.value=h.error?null:h.output;p.key=p.key[0][0]}return{rows:_(s,n.limit,n.skip)}}var N=l.sequentialize(h,function(e,t){var n;var r=e.reduceFun&&t.reduce!==false;var i=t.skip||0;if(typeof t.keys!=="undefined"&&!t.keys.length){t.limit=0;delete t.keys}function o(t){t.include_docs=true;return e.db.allDocs(t).then(function(e){n=e.total_rows;return e.rows.map(function(e){return e.doc.value})})}function a(o){var s;if(r){s=T(e,o,t)}else{s={total_rows:n,offset:i,rows:o}}if(t.include_docs){var a=o.map(function(t){var n=t.value;var r=n&&typeof n==="object"&&n._id||t.id;return e.sourceDB.get(r).then(function(e){t.doc=e},function(){})});return p.all(a).then(function(){return s})}else{return s}}var u=function(e){return e.reduce(function(e,t){return e.concat(t)})};if(typeof t.keys!=="undefined"){var c=t.keys;var f=c.map(function(e){var t={startkey:s([e]),endkey:s([e,{}])};return o(t)});return p.all(f).then(u).then(a)}else{var l={descending:t.descending};if(typeof t.startkey!=="undefined"){l.startkey=t.descending?s([t.startkey,{}]):s([t.startkey])}if(typeof t.endkey!=="undefined"){var h=t.inclusive_end!==false;if(t.descending){h=!h}l.endkey=s(h?[t.endkey,{}]:[t.endkey])}if(typeof t.key!=="undefined"){var d=s([t.key]);var v=s([t.key,{}]);if(l.descending){l.endkey=d;l.startkey=v}else{l.startkey=d;l.endkey=v}}if(!r){if(typeof t.limit==="number"){l.limit=t.limit}l.skip=i}return o(l).then(a)}});function q(e){return e.request({method:"POST",url:"_view_cleanup"})}var I=l.sequentialize(h,function(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=m(e);var r="_design/"+t[0];var i=t[1];n[r]=n[r]||{};n[r][i]=true});var r={keys:Object.keys(n),include_docs:true};return e.allDocs(r).then(function(r){var i={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var o=r+"/"+n;if(!t.views[o]){o=n}var s=Object.keys(t.views[o]);var a=e.doc&&e.doc.views&&e.doc.views[n];s.forEach(function(e){i[e]=i[e]||a})})});var o=Object.keys(i).filter(function(e){return!i[e]});var s=o.map(function(t){return e.constructor.destroy(t,{adapter:e.adapter})});return p.all(s).then(function(){return{ok:true}})})},j({ok:true}))});n.viewCleanup=l.callbackify(function(){var e=this;if(e.type()==="http"){return q(e)}return I(e)});function R(e,t,n){if(e.type()==="http"){return O(e,t,n)}if(typeof t!=="string"){E(n,t);var r={db:e,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:true};d.add(function(){return u(r).then(function(e){function t(){return e.db.destroy()}return l.fin(C(e).then(function(){return N(e,n)}),t)})});return d.finish()}else{var i=t;var o=m(i);var s=o[0];var a=o[1];return e.get("_design/"+s).then(function(t){var r=t.views&&t.views[a];if(!r||typeof r.map!=="string"){var o=new Error("ddoc "+s+" has no view named "+a);o.name="not_found";o.status=400;throw o}E(n,r);var c={db:e,viewName:i,map:r.map,reduce:r.reduce};return u(c).then(function(e){if(n.stale==="ok"||n.stale==="update_after"){if(n.stale==="update_after"){C(e)}return N(e,n)}else{return C(e).then(function(){return N(e,n)})}})})}}n.query=function(e,t,n){if(typeof t==="function"){n=t;t={}}t=l.extend({},t);if(typeof e==="function"){e={map:e}}var r=this;var i=p.resolve().then(function(){return R(r,e,t)});l.promisedCallback(i,n);return i};function B(e){this.status=400;this.name="query_parse_error";this.message=e;this.error=true;try{Error.captureStackTrace(this,B)}catch(t){}}l.inherits(B,Error)},{"./create-view":426,"./evalfunc":427,"./taskqueue":432,"./utils":434,"pouchdb-collate":430}],429:[function(e,t,n){var r=Object.prototype.hasOwnProperty;var i=Object.prototype.toString;function o(e){if(!e||i.call(e)!=="[object Object]"||e.nodeType||e.setInterval)return false;var t=r.call(e,"constructor");var n=r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!n)return false;var o;for(o in e){}return o===undefined||r.call(e,o)}t.exports=function s(){var e,t,n,r,i,a,u=arguments[0]||{},c=1,f=arguments.length,l=false;if(typeof u==="boolean"){l=u;u=arguments[1]||{};c=2}if(typeof u!=="object"&&typeof u!=="function"){u={}}for(;c<f;c++){if((e=arguments[c])!=null){for(t in e){n=u[t];r=e[t];if(u===r){continue}if(l&&r&&(o(r)||(i=Array.isArray(r)))){if(i){i=false;
a=n&&Array.isArray(n)?n:[]}else{a=n&&o(n)?n:{}}u[t]=s(l,a,r)}else if(r!==undefined){u[t]=r}}}}return u}},{}],430:[function(e,t,n){"use strict";var r=-324;var i=3;var o="";var s=e("./utils");n.collate=function(e,t){if(e===t){return 0}e=n.normalizeKey(e);t=n.normalizeKey(t);var r=l(e);var i=l(t);if(r-i!==0){return r-i}if(e===null){return 0}switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:e<t?-1:1;case"string":return c(e,t)}return Array.isArray(e)?u(e,t):f(e,t)};n.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":if(e===Infinity||e===-Infinity||isNaN(e)){return null}return e;case"object":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var i=0;i<r;i++){e[i]=n.normalizeKey(t[i])}}else if(e instanceof Date){return e.toJSON()}else if(e!==null){e={};for(var o in t){if(t.hasOwnProperty(o)){var s=t[o];if(typeof s!=="undefined"){e[o]=n.normalizeKey(s)}}}}}return e};function a(e){if(e!==null){switch(typeof e){case"boolean":return e?1:0;case"number":return p(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e);var r=t?e:Object.keys(e);var i=-1;var o=r.length;var s="";if(t){while(++i<o){s+=n.toIndexableString(r[i])}}else{while(++i<o){var a=r[i];s+=n.toIndexableString(a)+n.toIndexableString(e[a])}}return s}}return""}n.toIndexableString=function(e){var t="\x00";e=n.normalizeKey(e);return l(e)+o+a(e)+t};function u(e,t){var r=Math.min(e.length,t.length);for(var i=0;i<r;i++){var o=n.collate(e[i],t[i]);if(o!==0){return o}}return e.length===t.length?0:e.length>t.length?1:-1}function c(e,t){return e===t?0:e>t?1:-1}function f(e,t){var r=Object.keys(e),i=Object.keys(t);var o=Math.min(r.length,i.length);for(var s=0;s<o;s++){var a=n.collate(r[s],i[s]);if(a!==0){return a}a=n.collate(e[r[s]],t[i[s]]);if(a!==0){return a}}return r.length===i.length?0:r.length>i.length?1:-1}function l(e){var t=["boolean","number","string","object"];var n=t.indexOf(typeof e);if(~n){if(e===null){return 1}if(Array.isArray(e)){return 5}return n<3?n+2:n+3}if(Array.isArray(e)){return 5}}function p(e){if(e===0){return"1"}var t=e.toExponential().split(/e\+?/);var n=parseInt(t[1],10);var a=e<0;var u=a?"0":"2";var c=(a?-n:n)-r;var f=s.padLeft(c.toString(),"0",i);u+=o+f;var l=Math.abs(parseFloat(t[0]));if(a){l=10-l}var p=l.toFixed(20);p=p.replace(/\.?0+$/,"");u+=o+p;return u}},{"./utils":431}],431:[function(e,t,n){"use strict";function r(e,t,n){var r="";var i=n-e.length;while(r.length<i){r+=t}return r}n.padLeft=function(e,t,n){var i=r(e,t,n);return i+e};n.padRight=function(e,t,n){var i=r(e,t,n);return e+i};n.stringLexCompare=function(e,t){var n=e.length;var r=t.length;var i;for(i=0;i<n;i++){if(i===r){return 1}var o=e.charAt(i);var s=t.charAt(i);if(o!==s){return o<s?-1:1}}if(n<r){return-1}return 0};n.intToDecimalForm=function(e){var t=e<0;var n="";do{var r=t?-Math.ceil(e%10):Math.floor(e%10);n=r+n;e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);if(t&&n!=="0"){n="-"+n}return n}},{}],432:[function(e,t,n){"use strict";var r=e("./utils").Promise;function i(){this.promise=new r(function(e){e()})}i.prototype.add=function(e){this.promise=this.promise["catch"](function(){}).then(function(){return e()});return this.promise};i.prototype.finish=function(){return this.promise};t.exports=i},{"./utils":434}],433:[function(e,t,n){"use strict";var r=e("./utils").Promise;function i(e,t,n){return new r(function(r,i){if(t&&typeof t==="object"){t=t._id}if(typeof t!=="string"){return i(new Error("doc id is required"))}e.get(t,function(s,a){if(s){if(s.name!=="not_found"){return i(s)}return r(o(e,n({_id:t}),n))}var u=n(a);if(!u){return r(a)}r(o(e,u,n))})})}function o(e,t,n){return e.put(t)["catch"](function(r){if(r.name!=="conflict"){throw r}return i(e,t,n)})}t.exports=i},{"./utils":434}],434:[function(e,t,n){(function(t,r){"use strict";if(typeof r.Promise==="function"){n.Promise=r.Promise}else{n.Promise=e("lie")}n.uniq=function(e){var t={};e.forEach(function(e){t[e]=true});return Object.keys(t)};n.inherits=e("inherits");n.extend=e("extend");var i=e("argsarray");n.promisedCallback=function(e,n){if(n){e.then(function(e){t.nextTick(function(){n(null,e)})},function(e){t.nextTick(function(){n(e)})})}return e};n.callbackify=function(e){return i(function(t){var r=t.pop();var i=e.apply(this,t);if(typeof r==="function"){n.promisedCallback(i,r)}return i})};n.fin=function(e,t){return e.then(function(e){var n=t();if(typeof n.then==="function"){return n.then(function(){return e})}return e},function(e){var n=t();if(typeof n.then==="function"){return n.then(function(){throw e})}throw e})};n.sequentialize=function(e,t){return function(){var n=arguments;var r=this;return e.add(function(){return t.apply(r,n)})}};var o=e("crypto");var s=e("md5-jkmyers");n.MD5=function(e){if(!t.browser){return o.createHash("md5").update(e).digest("hex")}else{return s(e)}}}).call(this,e("OpdoqP"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{OpdoqP:61,argsarray:405,crypto:59,extend:429,inherits:406,lie:410,"md5-jkmyers":424}],435:[function(e,t,n){t.exports=e(32)},{}],436:[function(e,t,n){(function(e){(function(){var n={};var r,i;r=this;if(r!=null){i=r.async}n.noConflict=function(){r.async=i;return n};function o(e){var t=false;return function(){if(t)throw new Error("Callback was already called.");t=true;e.apply(r,arguments)}}var s=function(e,t){if(e.forEach){return e.forEach(t)}for(var n=0;n<e.length;n+=1){t(e[n],n,e)}};var a=function(e,t){if(e.map){return e.map(t)}var n=[];s(e,function(e,r,i){n.push(t(e,r,i))});return n};var u=function(e,t,n){if(e.reduce){return e.reduce(t,n)}s(e,function(e,r,i){n=t(n,e,r,i)});return n};var c=function(e){if(Object.keys){return Object.keys(e)}var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t};if(typeof e==="undefined"||!e.nextTick){if(typeof setImmediate==="function"){n.nextTick=function(e){setImmediate(e)}}else{n.nextTick=function(e){setTimeout(e,0)}}}else{n.nextTick=e.nextTick}n.each=function(e,t,n){n=n||function(){};if(!e.length){return n()}var r=0;s(e,function(i){t(i,o(function(t){if(t){n(t);n=function(){}}else{r+=1;if(r>=e.length){n(null)}}}))})};n.forEach=n.each;n.eachSeries=function(e,t,r){r=r||function(){};if(!e.length){return r()}var i=0;var o=function(){var s=true;t(e[i],function(t){if(t){r(t);r=function(){}}else{i+=1;if(i>=e.length){r(null)}else{if(s){n.nextTick(o)}else{o()}}}});s=false};o()};n.forEachSeries=n.eachSeries;n.eachLimit=function(e,t,n,r){var i=f(t);i.apply(null,[e,n,r])};n.forEachLimit=n.eachLimit;var f=function(e){return function(t,n,r){r=r||function(){};if(!t.length||e<=0){return r()}var i=0;var o=0;var s=0;(function a(){if(i>=t.length){return r()}while(s<e&&o<t.length){o+=1;s+=1;n(t[o-1],function(e){if(e){r(e);r=function(){}}else{i+=1;s-=1;if(i>=t.length){r()}else{a()}}})}})()}};var l=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.each].concat(t))}};var p=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[f(e)].concat(n))}};var h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.eachSeries].concat(t))}};var d=function(e,t,n,r){var i=[];t=a(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r;t(n)})},function(e){r(e,i)})};n.map=l(d);n.mapSeries=h(d);n.mapLimit=function(e,t,n,r){return v(t)(e,n,r)};var v=function(e){return p(e,d)};n.reduce=function(e,t,r,i){n.eachSeries(e,function(e,n){r(t,e,function(e,r){t=r;n(e)})},function(e){i(e,t)})};n.inject=n.reduce;n.foldl=n.reduce;n.reduceRight=function(e,t,r,i){var o=a(e,function(e){return e}).reverse();n.reduce(o,t,r,i)};n.foldr=n.reduceRight;var m=function(e,t,n,r){var i=[];t=a(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n){if(n){i.push(e)}t()})},function(e){r(a(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.filter=l(m);n.filterSeries=h(m);n.select=n.filter;n.selectSeries=n.filterSeries;var g=function(e,t,n,r){var i=[];t=a(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){n(e.value,function(n){if(!n){i.push(e)}t()})},function(e){r(a(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.reject=l(g);n.rejectSeries=h(g);var y=function(e,t,n,r){e(t,function(e,t){n(e,function(n){if(n){r(e);r=function(){}}else{t()}})},function(e){r()})};n.detect=l(y);n.detectSeries=h(y);n.some=function(e,t,r){n.each(e,function(e,n){t(e,function(e){if(e){r(true);r=function(){}}n()})},function(e){r(false)})};n.any=n.some;n.every=function(e,t,r){n.each(e,function(e,n){t(e,function(e){if(!e){r(false);r=function(){}}n()})},function(e){r(true)})};n.all=n.every;n.sortBy=function(e,t,r){n.map(e,function(e,n){t(e,function(t,r){if(t){n(t)}else{n(null,{value:e,criteria:r})}})},function(e,t){if(e){return r(e)}else{var n=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};r(null,a(t.sort(n),function(e){return e.value}))}})};n.auto=function(e,t){t=t||function(){};var r=c(e);if(!r.length){return t(null)}var i={};var o=[];var a=function(e){o.unshift(e)};var f=function(e){for(var t=0;t<o.length;t+=1){if(o[t]===e){o.splice(t,1);return}}};var l=function(){s(o.slice(0),function(e){e()})};a(function(){if(c(i).length===r.length){t(null,i);t=function(){}}});s(r,function(r){var o=e[r]instanceof Function?[e[r]]:e[r];var p=function(e){var o=Array.prototype.slice.call(arguments,1);if(o.length<=1){o=o[0]}if(e){var a={};s(c(i),function(e){a[e]=i[e]});a[r]=o;t(e,a);t=function(){}}else{i[r]=o;n.nextTick(l)}};var h=o.slice(0,Math.abs(o.length-1))||[];var d=function(){return u(h,function(e,t){return e&&i.hasOwnProperty(t)},true)&&!i.hasOwnProperty(r)};if(d()){o[o.length-1](p,i)}else{var v=function(){if(d()){f(v);o[o.length-1](p,i)}};a(v)}})};n.waterfall=function(e,t){t=t||function(){};if(!e.length){return t()}var r=function(e){return function(i){if(i){t.apply(null,arguments);t=function(){}}else{var o=Array.prototype.slice.call(arguments,1);var s=e.next();if(s){o.push(r(s))}else{o.push(t)}n.nextTick(function(){e.apply(null,o)})}}};r(n.iterator(e))()};var _=function(e,t,n){n=n||function(){};if(t.constructor===Array){e.map(t,function(e,t){if(e){e(function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}t.call(null,e,n)})}},n)}else{var r={};e.each(c(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1){i=i[0]}r[e]=i;n(t)})},function(e){n(e,r)})}};n.parallel=function(e,t){_({map:n.map,each:n.each},e,t)};n.parallelLimit=function(e,t,n){_({map:v(t),each:f(t)},e,n)};n.series=function(e,t){t=t||function(){};if(e.constructor===Array){n.mapSeries(e,function(e,t){if(e){e(function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}t.call(null,e,n)})}},t)}else{var r={};n.eachSeries(c(e),function(t,n){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1){i=i[0]}r[t]=i;n(e)})},function(e){t(e,r)})}};n.iterator=function(e){var t=function(n){var r=function(){if(e.length){e[n].apply(null,arguments)}return r.next()};r.next=function(){return n<e.length-1?t(n+1):null};return r};return t(0)};n.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var b=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]);t(e)})},function(e){r(e,i)})};n.concat=l(b);n.concatSeries=h(b);n.whilst=function(e,t,r){if(e()){var i=true;t(function(o){if(o){return r(o)}if(i){n.nextTick(function(){n.whilst(e,t,r)})}else{n.whilst(e,t,r)}});i=false}else{r()}};n.doWhilst=function(e,t,r){var i=true;e(function(o){if(o){return r(o)}if(t()){if(i){n.nextTick(function(){n.doWhilst(e,t,r)})}else{n.doWhilst(e,t,r)}}else{r()}});i=false};n.until=function(e,t,r){if(!e()){var i=true;t(function(o){if(o){return r(o)}if(i){n.nextTick(function(){n.until(e,t,r)})}else{n.until(e,t,r)}});i=false}else{r()}};n.doUntil=function(e,t,r){var i=true;e(function(o){if(o){return r(o)}if(!t()){if(i){n.nextTick(function(){n.doUntil(e,t,r)})}else{n.doUntil(e,t,r)}}else{r()}});i=false};n.queue=function(e,t){if(t===undefined){t=1}function r(e,r,i,o){if(r.constructor!==Array){r=[r]}s(r,function(r){var s={data:r,callback:typeof o==="function"?o:null};if(i){e.tasks.unshift(s)}else{e.tasks.push(s)}if(e.saturated&&e.tasks.length===t){e.saturated()}n.nextTick(e.process)})}var i=0;var a={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,push:function(e,t){r(a,e,false,t)},unshift:function(e,t){r(a,e,true,t)},process:function(){if(i<a.concurrency&&a.tasks.length){var t=a.tasks.shift();if(a.empty&&a.tasks.length===0){a.empty()}i+=1;var r=true;var s=function(){i-=1;if(t.callback){t.callback.apply(t,arguments)}if(a.drain&&a.tasks.length+i===0){a.drain()}a.process()};var u=o(function(){var e=arguments;if(r){n.nextTick(function(){s.apply(null,e)})}else{s.apply(null,arguments)}});e(t.data,u);r=false}},length:function(){return a.tasks.length},running:function(){return i}};return a};n.cargo=function(e,t){var r=false,i=[];var o={tasks:i,payload:t,saturated:null,empty:null,drain:null,push:function(e,r){if(e.constructor!==Array){e=[e]}s(e,function(e){i.push({data:e,callback:typeof r==="function"?r:null});if(o.saturated&&i.length===t){o.saturated()}});n.nextTick(o.process)},process:function u(){if(r)return;if(i.length===0){if(o.drain)o.drain();return}var n=typeof t==="number"?i.splice(0,t):i.splice(0);var c=a(n,function(e){return e.data});if(o.empty)o.empty();r=true;e(c,function(){r=false;var e=arguments;s(n,function(t){if(t.callback){t.callback.apply(null,e)}});u()})},length:function(){return i.length},running:function(){return r}};return o};var w=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(t){if(console.error){console.error(t)}}else if(console[e]){s(n,function(t){console[e](t)})}}}]))}};n.log=w("log");n.dir=w("dir");n.memoize=function(e,t){var n={};var r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments);var o=i.pop();var s=t.apply(null,i);if(s in n){o.apply(null,n[s])}else if(s in r){r[s].push(o)}else{r[s]=[o];e.apply(null,i.concat([function(){n[s]=arguments;var e=r[s];delete r[s];for(var t=0,i=e.length;t<i;t++){e[t].apply(null,arguments)}}]))}};i.memo=n;i.unmemoized=e;return i};n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}};n.times=function(e,t,r){var i=[];for(var o=0;o<e;o++){i.push(o)}return n.map(i,t,r)};n.timesSeries=function(e,t,r){var i=[];for(var o=0;o<e;o++){i.push(o)}return n.mapSeries(i,t,r)};n.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var t=this;var r=Array.prototype.slice.call(arguments);var i=r.pop();n.reduce(e,r,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0];var t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){i.apply(t,[e].concat(n))})}};n.applyEach=function(e){var t=function(){var t=this;var r=Array.prototype.slice.call(arguments);var i=r.pop();return n.each(e,function(e,n){e.apply(t,r.concat([n]))},i)};if(arguments.length>1){var r=Array.prototype.slice.call(arguments,1);return t.apply(this,r)}else{return t}};if(typeof define!=="undefined"&&define.amd){define([],function(){return n})}else if(typeof t!=="undefined"&&t.exports){t.exports=n}else{r.async=n}})()}).call(this,e("OpdoqP"))},{OpdoqP:61}],437:[function(e,t,n){(function(){var n,r,i;n=e("./setters/factory");r=new n;i=e("../core/utils");t.exports=function(){function e(e){this._from=e;this._limit=-1;this._setters=[];this._listen()}e.prototype.transform=function(e){if(!arguments.length){return this._transformer}this._transformer=i.transformer(e);return this};e.prototype.dispose=function(){this._dispose(this._setters);this._setters=void 0;this._dispose(this._listeners);return this._listeners=void 0};e.prototype.copyId=function(e){if(!arguments.length){return this._copyId}this._copyId=e;return this};e.prototype._dispose=function(e){var t,n,r,i;if(e){i=[];for(n=0,r=e.length;n<r;n++){t=e[n];i.push(t.dispose())}return i}};e.prototype.filter=function(e){if(!arguments.length){return this._filter}this._filter=e;return this};e.prototype.to=function(e){var t;t=r.createSetter(this,e);if(t){this._setters.push(t)}return this};e.prototype._listen=function(){var e,t,n,r,i,o=this;this._listeners=[];r=["insert","remove","update"];i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(function(e){return o._listeners.push(o._from.on(e,function(t,n){return o._callSetters(e,t,n)}))}(e))}return i};e.prototype._callSetters=function(e,t){var n,r,i,o,s;o=this._setters;s=[];for(r=0,i=o.length;r<i;r++){n=o[r];s.push(n.change(e,t))}return s};return e}()}).call(this)},{"../core/utils":446,"./setters/factory":441}],438:[function(e,t,n){(function(){var n,r,i,o,s,a,u=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty,f=function(e,t){for(var n in t){if(c.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};o=e("dref");r=e("./binding");i=e("../core/eventEmitter");a=e("type-component");s=e("hoist");n=e("../object");t.exports=function(e){f(t,e);t.prototype.__isCollection=true;function t(e,n){if(e==null){e=[]}if(n==null){n="_id"}this._enforceItemId=u(this._enforceItemId,this);this.reset=u(this.reset,this);this.source=u(this.source,this);t.__super__.constructor.call(this);this._source=[];if(a(e)==="string"){n=e;e=[]}this._length=0;this._id(n);this.__enforceId=true;this.transform().postMap(this._enforceItemId);this.reset(e)}t.prototype.empty=function(){return!this._length};t.prototype.length=function(){return this._length};t.prototype.source=function(e){if(!arguments.length){return this._source}return this.reset(e)};t.prototype.reset=function(e){if(!e){e=[]}this.disposeSourceBinding();this._remove(this._source||[]);if(e.__isCollection){this._source=[];this._id(e._id());this._sourceBinding=e.bind().to(this);return this}this._insert(this._source=this._transform(e));return this};t.prototype.disposeSourceBinding=function(){if(this._sourceBinding){this._sourceBinding.dispose();return this._sourceBinding=void 0}};t.prototype.bind=function(e){if(a(e)==="string"){return t.__super__.bind.apply(this,arguments)}return new r(this).to(e)};t.prototype.set=function(e,n){var r;r=Number(e);if(isNaN(r)){return t.__super__.set.apply(this,arguments)}return this.splice(r,n)};t.prototype.get=function(e){var n;n=Number(e);if(isNaN(n)){return t.__super__.get.call(this,e)}return this.at(n)};t.prototype.at=function(e){return this._source[e]};t.prototype.first=function(){return this._source[0]};t.prototype.last=function(){return this._source[this._length-1]};t.prototype.update=function(e){};t.prototype.remove=function(e){var t;t=this.indexOf(e);if(!~t){return false}this.splice(t,1);return true};t.prototype.filter=function(e){return this._source.filter(e)};t.prototype.splice=function(e,t){var n,r;n=Array.prototype.slice.call(arguments);n.splice(0,2);n=this._transform(n);r=this.slice(e,e+t);this._source.splice.apply(this._source,arguments);this._remove(r,e);return this._insert(n,e)};t.prototype.transform=function(){return this._transformer||(this._transformer=s())};t.prototype.slice=function(e,t){return this._source.slice(e,t)};t.prototype.indexOf=function(e){var t,n,r,i,s;s=this._source;for(t=r=0,i=s.length;r<i;t=++r){n=s[t];if(o.get(n,this.__id)===o.get(e,this.__id)){return t}}return-1};t.prototype._id=function(e){if(!arguments.length){return this.__id}if(this.__id===e){return this}this.__id=e;if(this._source){this._enforceId()}return this};t.prototype.push=function(){var e;e=this._transform(Array.prototype.slice.call(arguments));this._source.push.apply(this._source,e);return this._insert(e,this._length)};t.prototype.unshift=function(){var e;e=this._transform(Array.prototype.slice.call(arguments));this._source.unshift.apply(this._source,e);return this._insert(e)};t.prototype.toJSON=function(){var e,t,n,r,i;t=[];i=this._source;for(n=0,r=i.length;n<r;n++){e=i[n];t.push((typeof e.toJSON==="function"?e.toJSON():void 0)||e)}return t};t.prototype.pop=function(){return this._remove([this._source.pop()],this._length)[0]};t.prototype.shift=function(){return this._remove([this._source.shift()],0)[0]};t.prototype.enforceId=function(e){if(!arguments.length){return this.__enforceId}return this.__enforceId=e};t.prototype._enforceId=function(){var e,t,n,r,i;r=this._source;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(this._enforceItemId(e))}return i};t.prototype._enforceItemId=function(e){var t;if(!this.__enforceId){return e}t=o.get(e,this.__id);if(t===void 0||t===null){throw new Error("item '"+e+"' must have a '"+this.__id+"'")}return e};t.prototype._insert=function(e,t){var n,r,i,o;if(t==null){t=0}if(!e.length){return}this._length+=e.length;this._resetInfo();for(n=i=0,o=e.length;i<o;n=++i){r=e[n];this.emit("insert",r,t+n)}return e};t.prototype._remove=function(e,t){var n,r,i,o;if(t==null){t=0}if(!e.length){return}this._length-=e.length;this._resetInfo();for(n=i=0,o=e.length;i<o;n=++i){r=e[n];this.emit("remove",r,t+n)}return e};t.prototype._resetInfo=function(){this.set("length",this._length);return this.set("empty",!this._length)};t.prototype._transform=function(e,t,n){var r,i,o,s;if(!this._transformer){return e}if(a(e)==="array"){i=[];for(o=0,s=e.length;o<s;o++){r=e[o];i.push(this._transformer(r))}return i}return this._transformer(e)};return t}(n)}).call(this)},{"../core/eventEmitter":445,"../object":451,"./binding":437,dref:459,hoist:460,"type-component":464}],439:[function(e,t,n){(function(){var n;n=e("../../core/utils");t.exports=function(){function e(e,t){this.binding=e;this.target=t;this._transformer=e.transform();this._filter=e.filter();this.init()}e.prototype.init=function(){};e.prototype.dispose=function(){};e.prototype.change=function(e,t){var n=this;if(this._filter){if(!this._filter(t)){return}}return this.__transform("to",t,function(t,r){if(t){throw t}return n._change(e,r)})};e.prototype._change=function(e,t){};e.prototype.bothWays=function(){};e.prototype.__transform=function(e,t,r){return n.tryTransform(this._transformer,e,t,r)};return e}()}).call(this)},{"../../core/utils":446}],440:[function(e,t,n){(function(){var n,r,i={}.hasOwnProperty,o=function(e,t){for(var n in t){if(i.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};n=e("./object");t.exports=function(e){o(t,e);function t(){r=t.__super__.constructor.apply(this,arguments);return r}t.prototype.init=function(){var e,r=this;t.__super__.init.call(this);return this._setter=new n(this.binding,e={insert:function(t){if(r.binding._copyId){r.target._id(r.binding._from._id())}if(~r.target.indexOf(t)){return e.update(t)}else{return r.target.push(t)}},update:function(e,t){return r.target.update(e)},remove:function(e){var t;t=r.target.indexOf(e);if(~t){return r.target.splice(t,1)}}})};t.prototype._change=function(){return this._setter._change.apply(this._setter,arguments)};t.prototype.bothWays=function(){throw new Error("cannot bind both ways yet")};return t}(e("./base"))}).call(this)},{"./base":439,"./object":443}],441:[function(e,t,n){(function(){var n,r,i;r=e("./fn");i=e("./object");n=e("./collection");t.exports=function(){function e(){}e.prototype.createSetter=function(e,t){if(!t){return null}if(typeof t==="function"){return new r(e,t)}else if(t.__isCollection){return new n(e,t)}else if(t.insert||t.update||t.remove||t.replace){return new i(e,t)}return null};return e}()}).call(this)},{"./collection":440,"./fn":442,"./object":443}],442:[function(e,t,n){(function(){var n,r={}.hasOwnProperty,i=function(e,t){for(var n in t){if(r.call(t,n))e[n]=t[n]}function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i;e.__super__=t.prototype;return e};t.exports=function(e){i(t,e);function t(){n=t.__super__.constructor.apply(this,arguments);return n}t.prototype.init=function(){var e,n,r,i,o,s;t.__super__.init.call(this);o=this.binding._from.source();s=[];for(e=r=0,i=o.length;r<i;e=++r){n=o[e];s.push(this.change("insert",n))}return s};t.prototype._change=function(e,t){return this.target(e,t)};return t}(e("./base"))}).call(this)},{"./base":439}],443:[function(e,t,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(e,t){for(var n in t){if(o.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};r=e("underscore");n=e("./fn");t.exports=function(e){s(t,e);function t(){i=t.__super__.constructor.apply(this,arguments);return i}t.prototype.init=function(){var e=this;r.defaults(this.target,{insert:function(e){},remove:function(e){},update:function(e){}});return this._setter=new n(this.binding,function(t,n,r){return e.target[t].call(e.target,n,r)})};t.prototype._change=function(){return this._setter._change.apply(this._setter,arguments)};return t}(e("./base"))}).call(this)},{"./base":439,"./fn":442,underscore:465}],444:[function(e,t,n){(function(){var e,n;n=function(){e.prototype.__isCallChain=true;function e(e,t){this._targetClass=e;this._addMethods(t);this._callChain=[]}e.prototype.createObject=function(){var e,t,n,r,i,o,s,a,u;r=this._targetClass;t=arguments;e=function(){return r.apply(this,t)};e.prototype=r.prototype;i=new e;a=this._callChain;u=[];for(o=0,s=a.length;o<s;o++){n=a[o];u.push(i=i[n.method].apply(i,n.args))}return u};e.prototype.copyId=function(e){if(!arguments.length){return this._copyId}this._copyId=e;return this};e.prototype.callMethod=function(e,t){this._callChain.push({method:e,args:t});return this};e.prototype._addMethods=function(e){var t,n,r;for(n=0,r=e.length;n<r;n++){t=e[n];this._addMethod(t)}return this};e.prototype._addMethod=function(e){return this[e]=function(){return this.callMethod(e,arguments)}};return e}();t.exports=e=function(){function e(e,t){this._class=e;this._attach=t!=null?t:this;this._createMethods()}e.prototype._createMethods=function(){var e,t;this._methods=[];t=[];for(e in this._class.prototype){if(e.substr(0,1)==="_"){continue}t.push(this._addMethod(e))}return t};e.prototype._addMethod=function(e){var t=this;this._methods.push(e);return this._attach[e]=function(){return new n(t._class,t._methods).callMethod(e,arguments)}};return e}()}).call(this)},{}],445:[function(e,t,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(e,t){for(var n in t){if(s.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};i=e("events");r=e("disposable");t.exports=n=function(e){a(t,e);function t(){o=t.__super__.constructor.apply(this,arguments);return o}t.prototype.on=function(e,n){var i,o,s,a,u=this;i=r.create();if(arguments.length===1){a=e;for(o in a){i.add(this.on(o,a[o]))}return i}s=[];if(typeof e==="string"){s=e.split(" ")}else{s=e}s.forEach(function(e){t.__super__.on.call(u,e,n);return i.add(function(){return u.off(e,n)})});return i};t.prototype.once=function(e,t){var n,r;r=t;n=this.on(e,function(){n.dispose();return r.apply(this,arguments)});n.target=this;return n};t.prototype.off=function(e,t){return this.removeListener(e,t)};return t}(i.EventEmitter)}).call(this)},{disposable:458,events:60}],446:[function(e,t,n){(function(){var t;t=e("hoist");n.tryTransform=function(e,t,n,r){if(!e){return r(null,n)}return e[t].call(e,n,r)};n.transformer=function(e){if(typeof e==="function"){e={from:e,to:e}}if(!e.from){e.from=function(e){return e}}if(!e.to){e.to=function(e){return e}}return{from:t.map(e.from),to:t.map(e.to)}}}).call(this)},{hoist:460}],447:[function(e,t,n){(function(){var t;t=e("./object/binding");n.Object=e("./object");n.Collection=e("./collection");n.EventEmitter=e("./core/eventEmitter");t.Collection=n.Collection}).call(this)},{"./collection":438,"./core/eventEmitter":445,"./object":451,"./object/binding":448}],448:[function(e,t,n){(function(){var n,r,i,o,s,a,u,c=function(e,t){return function(){return e.apply(t,arguments)}};n=e("./setters/factory");i=new n;u=e("../core/utils");s=e("hoist");a=e("toarray");o=e("./deepPropertyWatcher");t.exports=r=function(){e.prototype.__isBinding=true;function e(e,t){this._from=e;this._property=t;this._trigger=c(this._trigger,this);this.dispose=c(this.dispose,this);this._limit=-1;this._setters=[];this._triggerCount=0;this._listen()}e.prototype.watch=function(e){if(!arguments.length){return this._watch}this._watch=e;return this};e.prototype.collection=function(){if(this._collectionBinding){return this._collectionBinding}this._collection=new e.Collection;this.to(this._collection.source);return this._collectionBinding=this._collection.bind().copyId(true)};e.prototype.to=function(e,t){var n;n=i.createSetter(this,e,t);if(n){this._setters.push(n)}return this};e.prototype.from=function(e,t){if(arguments.length===1){t=e;e=this._from}return e.bind(t).to(this._from,this._property)};e.prototype.transform=function(e){if(!arguments.length){return this._transform}this._transform=u.transformer(e);return this};e.prototype._transformer=function(){return this._transform||(this._transform=u.transformer(options))};e.prototype.once=function(){return this.limit(0)};e.prototype.limit=function(e){this._limit=e;return this};e.prototype.isBothWays=function(){return!!this._boundBothWays};e.prototype.bothWays=function(){if(this._boundBothWays){return this}this._boundBothWays=true;this._callSetterFns("bothWays");return this};e.prototype.dispose=function(){this._callSetterFns("dispose");this._setters=[];if(this._collectionBinding){this._collectionBinding.dispose()}if(this._listener){this._listener.dispose();this._disposeListener.dispose()}this._listener=void 0;this._disposeListener=void 0;return this};e.prototype._trigger=function(){this._callSetterFns("change",[this._from.get(this._property)]);if(~this._limit&&++this._triggerCount>this._limit){this.dispose()}return this};e.prototype._callSetterFns=function(e,t){var n,r,i,o,s;o=this._setters;s=[];for(r=0,i=o.length;r<i;r++){n=o[r];s.push(n[e].apply(n,t||[]))}return s};e.prototype._listen=function(){this._listener=o.create({target:this._from,property:this._property,callback:this._trigger});return this._disposeListener=this._from.once("dispose",this.dispose)};return e}();r.fromOptions=function(e,t){var n,r,i,o,s,u;n=e.bind(t.property||t.from);i=a(t.to);for(s=0,u=i.length;s<u;s++){r=i[s];o=typeof r==="object"?r.property:{property:r};if(o.transform){bindings.transform(o.transform)}n.to(o.property)}if(t.limit){n.limit(t.limit)}if(t.once){n.once()}if(t.bothWays){n.bothWays()}return n}}).call(this)},{"../core/utils":446,"./deepPropertyWatcher":449,"./setters/factory":455,hoist:460,toarray:463}],449:[function(e,t,n){(function(){var n,r,i,o,s=function(e,t){return function(){return e.apply(t,arguments)}};r=e("dref");i=e("poolparty");n=function(){function e(e){this._changed=s(this._changed,this);this.reset(e)}e.prototype.reset=function(e){if(e.property){e.path=e.property.split(".")}this.index=e.index||0;this._fullPath=e.path;this._path=this._fullPath.slice(0,this.index);this._property=this._path.join(".");this.target=e.target;this.callback=e.callback;return this._watch()};e.prototype._dispose=function(){if(this._listener){this._listener.dispose();this._listener=void 0}if(this._binding){this._binding.dispose();this._binding=void 0}if(this._child){this._child.dispose();return this._child=void 0}};e.prototype.dispose=function(){this._dispose();return o.add(this)};e.prototype._watch=function(){var e;e=this.target.get(this._property);if(this._property.length){this._listener=this.target.on("change:"+this._property,this._changed)}if(e&&e.__isBindable){return this._binding=o.create({target:e,path:this._fullPath.slice(this.index),callback:this._changed})}else if(this._path.length<this._fullPath.length){return this._child=o.create({target:this.target,path:this._fullPath,callback:this.callback,index:this.index+1})
}};e.prototype._changed=function(e){this._dispose();this._watch();return this.callback(e)};return e}();o=t.exports=i({max:100,factory:function(e){return new n(e)},recycle:function(e,t){return e.reset(t)}})}).call(this)},{dref:459,poolparty:462}],450:[function(e,t,n){(function(){n.get=function(e,t,n){var r,i,o,s,a,u;if(n==null){n=true}if(!e){return}s=t?t.split("."):[];r=e;for(i=a=0,u=s.length;a<u;i=++a){o=s[i];if(!r){return}if(r.__isBindable){return r.get(s.slice(i).join("."))}r=r[o]}if(n&&r&&r.__isBindable){return r.get()}return r};n.set=function(e,t,n){var r,i,o,s,a,u,c,f;if(!e||!t){return}s=t.split(".");r=e.data;a=s.length;for(i=c=0,f=s.length;c<f;i=++c){o=s[i];if(r.__isBindable){return r.set(s.slice(i).join("."),n)}else{if(i===a-1){if(r[o]===n){return false}r[o]=n;return true}else{u=r[o];if(!u||typeof u!=="object"){u=r[o]={}}r=u}}}}}).call(this)},{}],451:[function(e,t,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(e,t){for(var n in t){if(a.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};s=e("./dref");e("dref").use(e("../shim/dref"));o=e("../core/eventEmitter");r=e("./binding");i=e("../core/builder");t.exports=n=function(e){u(t,e);t.prototype.__isBindable=true;function t(e){t.__super__.constructor.call(this);this._initData(e);this._bindings=[]}t.prototype._initData=function(e){this.data=e!=null?e:{}};t.prototype.get=function(e,t){var n;if(t==null){t=false}return(n=s.get(this.data,e,t))!=null?n:s.get(this[e.split(".").shift()],e.split(".").slice(1).join("."),t)};t.prototype.getFlatten=function(e){return this.get(e,true)};t.prototype.has=function(e){return!!this.get(e)};t.prototype.set=function(e,t){var n;if(arguments.length===1){for(n in e){this.set(n,e[n])}return}if(t&&t.__isBinding){t.to(this,e);return}return this._set(e,t)};t.prototype._set=function(e,t){if(!s.set(this,e,t)){return this}this.emit("change:"+e,t);this.emit("change",t);return this};t.prototype._ref=function(e,t){if(!t){return e}return s.get(e,t)};t.prototype.bind=function(e,t){if(typeof e==="object"){return r.fromOptions(this,e)}if(t&&t.__isBinding){this.set(e,t);return}return new r(this,e).to(t)};t.prototype.dispose=function(){return this.emit("dispose")};t.prototype.toJSON=function(){return this.data};return t}(o);new i(r,n);t.exports.EventEmitter=o;t.exports.propertyWatcher=e("./deepPropertyWatcher")}).call(this)},{"../core/builder":444,"../core/eventEmitter":445,"../shim/dref":457,"./binding":448,"./deepPropertyWatcher":449,"./dref":450,dref:459}],452:[function(e,t,n){(function(){var n;n=e("../../core/utils");t.exports=function(){function e(e){this.binding=e;this._transformer=this.binding.transform();this.init()}e.prototype.init=function(){var e=this;return this._setValue(this.binding._from.get(this.binding._property),function(t){if(!e.binding.watch()){return e._change(t)}})};e.prototype.change=function(e){var t=this;return this._setValue(e,function(e){return t._change(e)})};e.prototype._setValue=function(e,t){var n=this;if(this.currentValue===e){return false}this.__transform("to",e,function(e,r){if(e){throw e}return t(n.currentValue=r)});return true};e.prototype.bothWays=function(){};e.prototype._change=function(e){};e.prototype.__transform=function(e,t,r){return n.tryTransform(this._transformer,e,t,r)};return e}()}).call(this)},{"../../core/utils":446}],453:[function(e,t,n){(function(){var n,r={}.hasOwnProperty,i=function(e,t){for(var n in t){if(r.call(t,n))e[n]=t[n]}function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i;e.__super__=t.prototype;return e};n=e("./base");t.exports=function(e){i(t,e);function t(e,n,r){this.binding=e;this.to=n;this.property=r;t.__super__.constructor.call(this,this.binding)}t.prototype._change=function(e){return this.to.set(this.property,e)};t.prototype.dispose=function(){if(!this._disposable){return}this._disposable.dispose();return this._disposable=this.binding=this.to=this.property=null};t.prototype.bothWays=function(){var e=this;return this._disposable=this.to.bind(this.property).to(function(t){if(e.currentValue!==t){return e._changeFrom(t)}})};t.prototype._changeFrom=function(e){var t=this;return this.__transform("from",e,function(e,n){if(e){throw e}return t.binding._from.set(t.binding._property,t.currentValue=n)})};return t}(n)}).call(this)},{"./base":452}],454:[function(e,t,n){(function(){var n,r={}.hasOwnProperty,i=function(e,t){for(var n in t){if(r.call(t,n))e[n]=t[n]}function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i;e.__super__=t.prototype;return e};n=e("./base");t.exports=function(e){i(t,e);function t(e,n,r){this.binding=e;this.to=n;this.property=r;t.__super__.constructor.call(this,this.binding)}t.prototype._change=function(e){return this.to.reset(e)};t.prototype.dispose=function(){return this.to.disposeSourceBinding()};return t}(n)}).call(this)},{"./base":452}],455:[function(e,t,n){(function(){var n,r,i;i=e("./fn");n=e("./bindable");r=e("./collection");t.exports=function(){function e(){}e.prototype.createSetter=function(e,t,o){var s,a,u;a=null;u=null;s=null;if(!t&&!o){return null}if(typeof o==="string"){a=t;u=o}else if(typeof t==="string"){a=e._from;u=t}else if(typeof t==="function"){s=t}else if(typeof t==="object"&&t){if(t.__isBinding){throw new Error("Cannot bind to a binding.")}else if(t.__isCollection){return new r(e,t)}}if(s){return new i(e,s)}else if(a&&u){return new n(e,a,u)}return null};return e}()}).call(this)},{"./bindable":453,"./collection":454,"./fn":456}],456:[function(e,t,n){(function(){var n,r={}.hasOwnProperty,i=function(e,t){for(var n in t){if(r.call(t,n))e[n]=t[n]}function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i;e.__super__=t.prototype;return e};n=e("./base");t.exports=function(e){i(t,e);function t(e,n){this.binding=e;this.callback=n;t.__super__.constructor.call(this,this.binding)}t.prototype._change=function(e){return this.callback(e)};t.prototype.dispose=function(){return this.callback=null};return t}(n)}).call(this)},{"./base":452}],457:[function(e,t,n){(function(){t.exports={test:function(e){return e.get&&e.set},get:function(e,t){var n;n=e.data[t];if(n===null||n===void 0){n=e[t]}return n},set:function(e,t,n){return e.set(t,n)}}}).call(this)},{}],458:[function(e,t,n){t.exports=e(97)},{}],459:[function(e,t,n){t.exports=e(171)},{"type-component":464}],460:[function(e,t,n){(function(){var n,r,i,o,s,a,u=this;r=e("./transformer");t.exports=r;a=["cast","map","preCast","preMap","postCast","postMap"];i=function(e){return t.exports[e]=function(){var t;t=r();return t[e].apply(t,arguments)}};for(o=0,s=a.length;o<s;o++){n=a[o];i(n)}}).call(this)},{"./transformer":461}],461:[function(e,t,n){(function(){var n,r,i,o,s,a;a=e("type-component");n=e("async");r=function(){return function(e){if(a(e)==="array"){return e}return[e]}};o=function(e){return function(t){return e(t)}};i=function(e){return function(t){if(t&&t.constructor===e){return t}return new e(t)}};s=function(e){if(e===Array){return r()}if(e===String||e===Number){return o(e)}return i(e)};t.exports=function(e){var t,r,i,o,u,c,f;if(e==null){e={}}f=[];c=[];u=[];o=[];i=function(e,t){if(arguments.length>1&&a(arguments[arguments.length-1])==="function"){return i.async(e,t)}else{return i.sync.apply(null,arguments)}};i.async=function(e,t){return n.eachSeries(f,function(t,n){if(t.async){return t.transform(e,function(t,r){if(t){return n(t)}return n(null,e=r)})}else{e=t.transform(e);return n()}},function(n,r){if(n){return t(n)}return t(null,e)})};i.sync=function(){var e,t,n;for(t=0,n=f.length;t<n;t++){e=f[t];arguments[0]=e.transform.apply(null,arguments)}return arguments[0]};i.preCast=function(e){return i._push(t(e),c)};i.cast=function(e){return i._push(t(e),o)};i.postCast=function(e){return i._push(t(e),u)};t=function(e){return{transform:s(e)}};i.preMap=function(e){return i._push(r(e),c)};i.map=function(e){return i._push(r(e),o)};i.postMap=function(e){return i._push(r(e),u)};r=function(e){return{async:e.length>1,transform:e}};i._push=function(e,t){t.push(e);f=c.concat(o).concat(u);return this};return i}}).call(this)},{async:436,"type-component":464}],462:[function(e,t,n){(function(){var e,n=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){if(e==null){e={}}this.drip=n(this.drip,this);this.max=e.max||50;this.min=e.min||0;this.staleTimeout=e.staleTimeout||1e3;this.factory=e.factory||e.create;this.recycle=e.recycle;this._pool=[];this._size=0}e.prototype.size=function(){return this._size};e.prototype.drain=function(){var e,t,n,r;r=[];for(e=t=0,n=this._size-this.min;0<=n?t<n:t>n;e=0<=n?++t:--t){r.push(this.drip())}return r};e.prototype.drip=function(){this._dripping=false;if(!this._size){return}this._size--;this._pool.shift();return this._timeoutDrip()};e.prototype.create=function(e){var t;if(this._size){this._size--;t=this._pool.shift();this.recycle(t,e);return t}t=this.factory(e);t.__pool=this;return t};e.prototype.add=function(e){if(e.__pool!==this){return this}if(!~this._pool.indexOf(e)&&this._size<this.max){this._size++;this._pool.push(e);this._timeoutDrip()}return this};e.prototype._timeoutDrip=function(){if(this._dripping){return}this._dripping=true;return setTimeout(this.drip,this.staleTimeout)};return e}();t.exports=function(t){return new e(t)}}).call(this)},{}],463:[function(e,t,n){t.exports=e(33)},{}],464:[function(e,t,n){t.exports=e(56)},{}],465:[function(e,t,n){t.exports=e(34)},{}]},{},[2]);